Objective: Encryption ON, CL test under Quick Chip Mode. (Discover/ VISA MSD/ VISA qVSDC (EMV)/ MasterCard (MSD)/ MChip (EMV)/ INTERAC)

--------------------
>>> Load DUKPT data key & enable MSR/ MSD & EMV data encryption
1. Erase All Key (83-00)
CMD: 83 00
EXR: 83 00

2. Load Plaintext Key - command 1 (80-00)
CMD: 80 00 30 45 43 36 30 46 33 35 31 34 37 45 43 41 30 30 38 38 4B 30 54 44 30 30 4E 30 30 30 30 30 30 38 30 39 43 30 37 41 39 39 31 44 43 38 30 33 34 45 43 31 32 45 31 36 39 43 30 44 35 34 35 35 44 45 41 32 39 34 35 31 34 32 34 37 38 30 38 30 35 36 38 32 33 34 39 38 37 31 32 30 32 33 34 30 30 30 30 30 30 30 30
EXR: 80 00

3. Load Plaintext Key - command 2  (80-00)
CMD: 80 00 31 34 43 45 32 35 35 35 31 34 37 45 43 41 30 30 38 38 4B 30 54 44 30 30 4E 30 30 30 30 30 30 38 30 46 35 30 36 46 36 41 33 44 34 30 38 39 39 45 30 35 35 42 42 35 42 39 45 33 41 44 44 36 30 30 42 38 38 35 33 32 37 37 39 32 32 34 36 30 39 32 36 32 33 41 39 39 37 31 32 36 32 33 34 30 30 30 30 30 30 30 30
EXR: 80 00

4. Load Encrypted KPK (80-01)
CMD: 80 01 41 30 30 38 38 4B 30 54 44 30 30 4E 30 30 30 30 43 44 32 46 43 43 36 44 37 39 32 44 33 42 32 34 46 30 38 33 37 42 30 33 32 44 30 38 36 38 46 45 43 39 46 44 44 43 39 43 32 36 33 31 31 35 46 30 44 43 43 34 42 44 42 35 37 43 36 30 33 43 34 32 46 34 41 35 30 34 34 39
EXR: 80 00

5. Enter DUKPT Key (81-00)
CMD: 81 00 05 41 30 31 31 32 44 30 54 45 30 30 4E 30 31 30 30 4B 53 31 38 36 32 39 39 34 39 30 31 32 43 30 30 30 34 36 30 30 30 30 31 39 34 34 38 36 43 33 31 36 38 43 41 31 46 42 34 41 38 30 39 45 36 33 39 46 46 39 43 33 42 37 32 36 45 32 34 37 43 35 39 30 42 32 32 38 43 35 44 32 32 36 35 30 46 36 36 39 37 45 38 34 37 41 32 46 38 41 32 37 33 39 33
EXR: 81 00

6. C7-36 -- 03
CMD: C7 36 03
EXR: C7 00 00 00

========================================
>>> Set encryption type as TDES
CMD: C7 32 00
EXR: C7 00 00 00
MESSAGE: Now encryption type = TDES

--------------------
>>> Quick Chip mode = 04
CMD: 01 01 04
EXR: 01 00 00 00

--------------------
>>> CL transaction
SWIPEKB: click OK, then tap Discover card (PAN = 6510000000000125). (Press button "Quick Chip" to Decryption first then Press button "OK")
EXR: DF EE 12 0A 62 99 49 01 2C 00 04 60 00
EXR: DFEF5F41
EXR: FFEE13
EXR: DFEF6025
EXR: FFEE14
EXR: DFEF5C41
EXR: 56
EXR: DFEF5D13
EXR: 57
EXR: 9F390191
EXR: FFEE01
EXR: DF300100 
EXR: DFEE2601D1
EXR: DFEF4C06002700000000
EXR: DFEF4D28
EXR: 3B363531303030303030303030303132353D31373132323031313030303039353030303030303F
EXR: DFEC180E3830313439313233205265762e41
EXR: DFEF57
MESSAGECK: NO strange data at the end of output

--------------------
>>> CL transaction
SWIPEKB: click OK, then tap VISA MSD card. (Press button "Quick Chip" to Decryption first then Press button "OK")
EXR: DF EE 12 0A 62 99 49 01 2C 00 04 60 00
EXR: DFEF5F4C2A343736312A2A2A2A2A2A2A2A303031305E46554C4C2F46554E4354494F4E414C5E323031323132302A2A2A2A2A2A2A2A2A2A2A2A2A2A2A2A2A2A2A2A2A2A2A2A2A2A2A2A2A2A2A2A2A2A2A
EXR: FFEE13
EXR: DFEF6025343736312A2A2A2A2A2A2A2A303031303D323031323132302A2A2A2A2A2A2A2A2A2A2A2A2A
EXR: FFEE14
EXR: DFEF5D134761CCCCCCCC0010D2012120CCCCCCCCCCCCCC
EXR: 57
EXR: 9F390191
EXR: FFEE01
EXR: DF300100 
EXR: DFEE2601D1
EXR: DFEF4C06002700000000
EXR: DFEF4D28
EXR: 3B343736313733393030313031303031303D32303132313230303031323333393930303033313F
EXR: DFEC181456697361205643505320322e312e332076312e30
EXR: DFEF57
MESSAGECK: NO strange data at the end of output

--------------------
>>> Quick Chip mode = 02
CMD: 01 01 02
EXR: 01 00 00 00

--------------------
>>> CL transaction
SWIPEKB: click OK, then tap MasterCard (paypass) card. (Press button "Quick Chip" to Decryption first then Press button "OK")
EXR: DF EE 12 0A 62 99 49 01 2C 00 04 60 00
EXR: DFEF5C3E
EXR: 56
EXR: DFEF5E13
EXR: 9F 6B
EXR: DF 81 2A
EXR: DF 81 2B
EXR: 9F390191
EXR: FFEE01
EXR: DF300100 
EXR: DFEE2601D1
EXR: DFEF4C06002700000000
EXR: DFEF4D28
EXR: DFEC18 17 4d6173746572436172642076332e312e322076312e3034
EXR: DFEF57
MESSAGECK: NO strange data at the end of output

--------------------
>>> CL transaction
SWIPEKB: click OK, then tap INTERAC card. (Press button "Quick Chip" to Decryption first then Press button "OK")
EXR: DF EE 12 0A 62 99 49 01 2C 00 04 60 00
EXR: E1
EXR: DFEF5B085413CCCCCCCC1513
EXR: 5A
EXR: DFEF5D115413CCCCCCCC1513D0512220CCCCCCCCCC
EXR: 57
EXR: 9F390107
EXR: FFEE01
EXR: DF300100 
EXR: DFEE2601C1
EXR: DFEF4C06002400000000
EXR: DFEF4D28
EXR: 3B353431333333393030303030313531333D30353132323230303132333435363738393F
EXR: DFEC18 12 496e746572616320312e372c2076312e3030
EXR: DFEF57
MESSAGECK: NO strange data at the end of output

--------------------
>>> Set 9F66 (TTQ) = 20 00 40 00
CMD: 04 00 9F 66 04 20 00 40 00
EXR: 04 00

>>> CL transaction
SWIPEKB: click OK, then tap VISA qVSDC card. (Move tag E1+length to the end of output --> Press button "Quick Chip" to Decryption first then Press button "OK")
EXR: DF EE 12 0A 62 99 49 01 2C 00 04 60 00
EXR: E1 81
EXR: DFEF5B084761CCCCCCCC0010
EXR: 5A
EXR: DFEF5D134761CCCCCCCC0010D3012120CCCCCCCCCCCCCC
EXR: 57
EXR: 9F390107
EXR: FFEE01
EXR: DF300100 
EXR: DFEE2601C1
EXR: DFEF4C06002700000000
EXR: DFEF4D28
EXR: 3B343736313733393030313031303031303D33303132313230303031323333393930303033313F
EXR: DFEC181456697361205643505320322e312e332076312e30
EXR: DFEF57
MESSAGECK: NO strange data at the end of output

>>> Set 9F66 (TTQ) = 80 00 40 00
CMD: 04 00 9F 66 04 80 00 40 00
EXR: 04 00
--------------------
>>> Set FFFC = 02
CMD: 04 03 FF E4 01 01 9F 03 06 00 00 00 00 00 00 9F 53 01 00 9F 6D 02 00 01 9A 03 FF FF FF 9F 21 03 FF FF FF 9C 01 00 5F 2A 02 08 40 5F 36 01 02 9F 09 02 00 02 9F 15 02 11 11 9F 1A 02 08 40 9F 1B 04 00 00 17 70 9F 1C 08 00 00 00 00 00 00 00 00 9F 33 03 00 08 E8 9F 35 01 25 9F 40 05 60 00 00 10 01 9F 7C 14 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 9F 7E 01 00 DF 28 03 00 08 E8 DF 29 03 00 68 E8 FF F1 06 00 00 00 01 00 00 FF F5 06 00 00 00 00 80 00 FF FC 01 02 FF FD 05 F8 50 AC F8 00 FF FE 05 F8 50 AC A0 00 FF FF 05 00 00 00 00 00 DF 81 1A 03 9F 6A 04 DF 81 1E 01 10 DF 81 24 06 00 00 00 03 00 00 DF 81 25 06 00 00 00 03 00 00 DF 81 2C 01 00 9F 39 01 91
EXR: 04 00 00 00

>>> CL transaction
SWIPEKB: click OK, then tap MChip card. (Move tag FF8105+length to the end of output --> Press button "Quick Chip" to Decryption first then Press button "OK")
EXR: DF EE 12 0A 62 99 49 01 2C 00 04 60 00
EXR: DFEF5B
EXR: 5A
EXR: DFEF5D
EXR: 57
EXR: 9F390107
EXR: FFEE01
EXR: DF300100 
EXR: DFEE2601C1
EXR: DFEF4C
EXR: DFEF4D
EXR: DFEC18 17 4d6173746572436172642076332e312e322076312e3034
EXR: DFEF57 18 56503333303020555342204E454F2076312E
MESSAGECK: NO strange data at the end of output

>>> Set FFFC = 01
CMD: 04 03 FF E4 01 01 9F 03 06 00 00 00 00 00 00 9F 53 01 00 9F 6D 02 00 01 9A 03 FF FF FF 9F 21 03 FF FF FF 9C 01 00 5F 2A 02 08 40 5F 36 01 02 9F 09 02 00 02 9F 15 02 11 11 9F 1A 02 08 40 9F 1B 04 00 00 17 70 9F 1C 08 00 00 00 00 00 00 00 00 9F 33 03 00 08 E8 9F 35 01 22 9F 40 05 60 00 00 10 01 9F 7C 14 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 9F 7E 01 00 DF 28 03 00 08 E8 DF 29 03 00 68 E8 FF F1 06 00 00 00 01 00 00 FF F5 06 00 00 00 00 80 00 FF FC 01 01 FF FD 05 F8 50 AC F8 00 FF FE 05 F8 50 AC A0 00 FF FF 05 00 00 00 00 00 DF 81 1A 03 9F 6A 04 DF 81 1E 01 10 DF 81 24 06 00 00 00 03 00 00 DF 81 25 06 00 00 00 03 00 00 DF 81 2C 01 00 9F 39 01 91
EXR: 04 00 00 00