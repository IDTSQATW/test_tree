#ID:
# Head #########################################
#LABLE:
#POURPOSE:
#INPUT:
#OUTPUT: 
#################################################

#!/usr/bin/env python

# Import #######################################
import Utility_Lib.Pro_PreFile

from  Utility_Lib.Pro_PreFile import *
#################################################

# Variable #####################################
Robot = DL.isRobot
# true - robot, false - manual
InitPKI = True
# true - MasterReset + Activate + Key Injection, false skip
DeviceType = -1
# 0 - Vivo K3,K4, > 0 - Neoii
DL.warnings = 0 
# Ready for DVT Warning Count
DL.fails = 0
 # Test Part Issue Count
Index = 0
# Child Cases Index


C2C01 = []
C2C01.append(["PT Stop","2C 01 00","5669564F7465636832002C"])
C2C01.append(["PT Start","2C 01 01","5669564F7465636832002C0000001C9B"])

C2801 = []
C2801.append(["Antenna Enable (OK)","28 01 01","5669564F74656368320028000000D66A"])

C2C02 = []
C2C02.append([" Poll for Token (OK)","2C 02 1F 00","5669564F7465636832002C00000503"])

C2C06 = []
C2C06.append(["Mifare auth - Sector 1","2C 06 01 01 FF FF FF FF FF FF","5669564F7465636832002C0000001C9B"])

C2C08 = []
C2C08.append(["Write Block #1","2C 08 31 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00","5669564F7465636832002C0000001C9B"])
C2C08.append(["Write Block #2","2C 08 31 02 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00","5669564F7465636832002C0000001C9B"])
C2C08.append(["Write Block #4","2C 08 31 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00","5669564F7465636832002C0000001C9B"])
C2C08.append(["Write Block #5","2C 08 31 05 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00","5669564F7465636832002C0000001C9B"])
C2C08.append(["Write Block #6","2C 08 31 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00","5669564F7465636832002C0000001C9B"])
C2C08.append(["Write Block #8","2C 08 31 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00","5669564F7465636832002C0000001C9B"])
C2C08.append(["Write Block #9","2C 08 31 09 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00","5669564F7465636832002C0000001C9B"])
C2C08.append(["Write Block #10","2C 08 31 0A 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00","5669564F7465636832002C0000001C9B"])
C2C08.append(["Write Block #12","2C 08 31 0C 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00","5669564F7465636832002C0000001C9B"])
C2C08.append(["Write Block #13","2C 08 31 0D 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00","5669564F7465636832002C0000001C9B"])
C2C08.append(["Write Block #14","2C 08 31 0E 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00","5669564F7465636832002C0000001C9B"])
C2C08.append(["Write Block #16","2C 08 31 10 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00","5669564F7465636832002C0000001C9B"])
C2C08.append(["Write Block #17","2C 08 31 11 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00","5669564F7465636832002C0000001C9B"])
C2C08.append(["Write Block #18","2C 08 31 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00","5669564F7465636832002C0000001C9B"])
C2C08.append(["Write Block #20","2C 08 31 14 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00","5669564F7465636832002C0000001C9B"])
C2C08.append(["Write Block #21","2C 08 31 15 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00","5669564F7465636832002C0000001C9B"])
C2C08.append(["Write Block #22","2C 08 31 16 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00","5669564F7465636832002C0000001C9B"])
C2C08.append(["Write Block #24","2C 08 31 18 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00","5669564F7465636832002C0000001C9B"])
C2C08.append(["Write Block #25","2C 08 31 19 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00","5669564F7465636832002C0000001C9B"])
C2C08.append(["Write Block #26","2C 08 31 1A 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00","5669564F7465636832002C0000001C9B"])
C2C08.append(["Write Block #28","2C 08 31 1C 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00","5669564F7465636832002C0000001C9B"])
C2C08.append(["Write Block #29","2C 08 31 1D 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00","5669564F7465636832002C0000001C9B"])
C2C08.append(["Write Block #30","2C 08 31 1E 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00","5669564F7465636832002C0000001C9B"])
C2C08.append(["Write Block #32","2C 08 31 20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00","5669564F7465636832002C0000001C9B"])
C2C08.append(["Write Block #33","2C 08 31 21 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00","5669564F7465636832002C0000001C9B"])
C2C08.append(["Write Block #34","2C 08 31 22 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00","5669564F7465636832002C0000001C9B"])
C2C08.append(["Write Block #36","2C 08 31 24 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00","5669564F7465636832002C0000001C9B"])
C2C08.append(["Write Block #37","2C 08 31 25 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00","5669564F7465636832002C0000001C9B"])
C2C08.append(["Write Block #38","2C 08 31 26 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00","5669564F7465636832002C0000001C9B"])
C2C08.append(["Write Block #40","2C 08 31 28 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00","5669564F7465636832002C0000001C9B"])
C2C08.append(["Write Block #41","2C 08 31 29 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00","5669564F7465636832002C0000001C9B"])
C2C08.append(["Write Block #42","2C 08 31 2A 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00","5669564F7465636832002C0000001C9B"])
C2C08.append(["Write Block #44","2C 08 31 2C 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00","5669564F7465636832002C0000001C9B"])
C2C08.append(["Write Block #45","2C 08 31 2D 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00","5669564F7465636832002C0000001C9B"])
C2C08.append(["Write Block #46","2C 08 31 2E 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00","5669564F7465636832002C0000001C9B"])
C2C08.append(["Write Block #48","2C 08 31 30 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00","5669564F7465636832002C0000001C9B"])
C2C08.append(["Write Block #49","2C 08 31 31 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00","5669564F7465636832002C0000001C9B"])
C2C08.append(["Write Block #50","2C 08 31 32 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00","5669564F7465636832002C0000001C9B"])
C2C08.append(["Write Block #52","2C 08 31 34 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00","5669564F7465636832002C0000001C9B"])
C2C08.append(["Write Block #53","2C 08 31 35 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00","5669564F7465636832002C0000001C9B"])
C2C08.append(["Write Block #54","2C 08 31 36 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00","5669564F7465636832002C0000001C9B"])
C2C08.append(["Write Block #56","2C 08 31 38 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00","5669564F7465636832002C0000001C9B"])
C2C08.append(["Write Block #57","2C 08 31 39 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00","5669564F7465636832002C0000001C9B"])
C2C08.append(["Write Block #58","2C 08 31 3A 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00","5669564F7465636832002C0000001C9B"])
C2C08.append(["Write Block #60","2C 08 31 3C 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00","5669564F7465636832002C0000001C9B"])
C2C08.append(["Write Block #61","2C 08 31 3D 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00","5669564F7465636832002C0000001C9B"])
C2C08.append(["Write Block #62","2C 08 31 3E 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00","5669564F7465636832002C0000001C9B"])


C2C07= []
C2C07.append(["Read Block #0","2C 07 31 00","5669564F7465636832002C000010????????????????????????????????????"])
C2C07.append(["Read Block #1","2C 07 31 01","5669564F7465636832002C000010 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00"])
C2C07.append(["Read Block #2","2C 07 31 02","5669564F7465636832002C000010 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00"])
C2C07.append(["Read Block #3","2C 07 31 03","5669564F7465636832002C000010????????????????????????????????????"])
C2C07.append(["Read Block #4","2C 07 31 04","5669564F7465636832002C000010 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00"])
C2C07.append(["Read Block #5","2C 07 31 05","5669564F7465636832002C000010 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00"])
C2C07.append(["Read Block #6","2C 07 31 06","5669564F7465636832002C000010 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00"])
C2C07.append(["Read Block #7","2C 07 31 07","5669564F7465636832002C000010????????????????????????????????????"])
C2C07.append(["Read Block #8","2C 07 31 08","5669564F7465636832002C000010 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00"])
C2C07.append(["Read Block #9","2C 07 31 09","5669564F7465636832002C000010 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00"])
C2C07.append(["Read Block #10","2C 07 31 0A","5669564F7465636832002C000010 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00"])
C2C07.append(["Read Block #11","2C 07 31 0B","5669564F7465636832002C000010????????????????????????????????????"])
C2C07.append(["Read Block #12","2C 07 31 0C","5669564F7465636832002C000010 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00"])
C2C07.append(["Read Block #13","2C 07 31 0D","5669564F7465636832002C000010 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00"])
C2C07.append(["Read Block #14","2C 07 31 0E","5669564F7465636832002C000010 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00"])
C2C07.append(["Read Block #15","2C 07 31 0F","5669564F7465636832002C000010????????????????????????????????????"])
C2C07.append(["Read Block #16","2C 07 31 10","5669564F7465636832002C000010 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00"])
C2C07.append(["Read Block #17","2C 07 31 11","5669564F7465636832002C000010 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00"])
C2C07.append(["Read Block #18","2C 07 31 12","5669564F7465636832002C000010 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00"])
C2C07.append(["Read Block #19","2C 07 31 13","5669564F7465636832002C000010????????????????????????????????????"])
C2C07.append(["Read Block #20","2C 07 31 14","5669564F7465636832002C000010 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00"])
C2C07.append(["Read Block #21","2C 07 31 15","5669564F7465636832002C000010 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00"])
C2C07.append(["Read Block #22","2C 07 31 16","5669564F7465636832002C000010 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00"])
C2C07.append(["Read Block #23","2C 07 31 17","5669564F7465636832002C000010????????????????????????????????????"])
C2C07.append(["Read Block #24","2C 07 31 18","5669564F7465636832002C000010 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00"])
C2C07.append(["Read Block #25","2C 07 31 19","5669564F7465636832002C000010 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00"])
C2C07.append(["Read Block #26","2C 07 31 1A","5669564F7465636832002C000010 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00"])
C2C07.append(["Read Block #27","2C 07 31 1B","5669564F7465636832002C000010????????????????????????????????????"])
C2C07.append(["Read Block #28","2C 07 31 1C","5669564F7465636832002C000010 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00"])
C2C07.append(["Read Block #29","2C 07 31 1D","5669564F7465636832002C000010 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00"])
C2C07.append(["Read Block #30","2C 07 31 1E","5669564F7465636832002C000010 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00"])
C2C07.append(["Read Block #31","2C 07 31 1F","5669564F7465636832002C000010????????????????????????????????????"])
C2C07.append(["Read Block #32","2C 07 31 20","5669564F7465636832002C000010 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00"])
C2C07.append(["Read Block #33","2C 07 31 21","5669564F7465636832002C000010 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00"])
C2C07.append(["Read Block #34","2C 07 31 22","5669564F7465636832002C000010 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00"])
C2C07.append(["Read Block #35","2C 07 31 23","5669564F7465636832002C000010????????????????????????????????????"])
C2C07.append(["Read Block #36","2C 07 31 24","5669564F7465636832002C000010 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00"])
C2C07.append(["Read Block #37","2C 07 31 25","5669564F7465636832002C000010 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00"])
C2C07.append(["Read Block #38","2C 07 31 26","5669564F7465636832002C000010 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00"])
C2C07.append(["Read Block #39","2C 07 31 27","5669564F7465636832002C000010????????????????????????????????????"])
C2C07.append(["Read Block #40","2C 07 31 28","5669564F7465636832002C000010 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00"])
C2C07.append(["Read Block #41","2C 07 31 29","5669564F7465636832002C000010 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00"])
C2C07.append(["Read Block #42","2C 07 31 2A","5669564F7465636832002C000010 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00"])
C2C07.append(["Read Block #43","2C 07 31 2B","5669564F7465636832002C000010????????????????????????????????????"])
C2C07.append(["Read Block #44","2C 07 31 2C","5669564F7465636832002C000010 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00"])
C2C07.append(["Read Block #45","2C 07 31 2D","5669564F7465636832002C000010 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00"])
C2C07.append(["Read Block #46","2C 07 31 2E","5669564F7465636832002C000010 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00"])
C2C07.append(["Read Block #47","2C 07 31 2F","5669564F7465636832002C000010????????????????????????????????????"])
C2C07.append(["Read Block #48","2C 07 31 30","5669564F7465636832002C000010 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00"])
C2C07.append(["Read Block #49","2C 07 31 31","5669564F7465636832002C000010 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00"])
C2C07.append(["Read Block #50","2C 07 31 32","5669564F7465636832002C000010 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00"])
C2C07.append(["Read Block #51","2C 07 31 33","5669564F7465636832002C000010????????????????????????????????????"])
C2C07.append(["Read Block #52","2C 07 31 34","5669564F7465636832002C000010 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00"])
C2C07.append(["Read Block #53","2C 07 31 35","5669564F7465636832002C000010 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00"])
C2C07.append(["Read Block #54","2C 07 31 36","5669564F7465636832002C000010 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00"])
C2C07.append(["Read Block #55","2C 07 31 37","5669564F7465636832002C000010????????????????????????????????????"])
C2C07.append(["Read Block #56","2C 07 31 38","5669564F7465636832002C000010 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00"])
C2C07.append(["Read Block #57","2C 07 31 39","5669564F7465636832002C000010 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00"])
C2C07.append(["Read Block #58","2C 07 31 3A","5669564F7465636832002C000010 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00"])
C2C07.append(["Read Block #59","2C 07 31 3B","5669564F7465636832002C000010????????????????????????????????????"])
C2C07.append(["Read Block #60","2C 07 31 3C","5669564F7465636832002C000010 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00"])
C2C07.append(["Read Block #61","2C 07 31 3D","5669564F7465636832002C000010 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00"])
C2C07.append(["Read Block #62","2C 07 31 3E","5669564F7465636832002C000010 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00"])
C2C07.append(["Read Block #63","2C 07 31 3F","5669564F7465636832002C000010????????????????????????????????????"])

C0930 = [["Get device memory","09 30"]]

##################################################



# Ready for DVT ##################################
DeviceType = Pro_GetDevice().Run(DL)
if(-1==DeviceType):
	DL.warnings = 1
	DL.setText("RED","Please define device type in Pro_GetDevice")
if(0<DeviceType and 10>=DeviceType):DL.setText("BLACK", "<Kiosk>")
if(10<DeviceType):DL.setText("BLACK", "<NEOII>")
##################################################



# Test Part ######################################

if(False ==  Pro_SendCmd().RunCK(Pro_SendCmd().Run(C2C01[0][0],C2C01[0][1],50000,False,DL),C2C01[0][2],DL)): DL.warnings = DL.warnings +1
strMemory = Pro_SendCmd().Run(C0930[0][0],C0930[0][1],5000,False,DL)
strMemory = strMemory.replace(" ","")
strMemory = strMemory[0:len(strMemory)-12]

if(False ==  Pro_SendCmd().RunCK(Pro_SendCmd().Run(C2C01[1][0],C2C01[1][1],50000,False,DL),C2C01[1][2],DL)): DL.warnings = DL.warnings +1

if (Robot == True):	DL.Robot_SwipeorTapCard(4)
else: DL.ShowMessageBox("Note!", "Tap Mafire S50, not move until the end", 30000)
if(False ==  Pro_SendCmd().RunCK(Pro_SendCmd().Run(C2C02[0][0],C2C02[0][1],50000,False,DL),C2C02[0][2],DL)): DL.warnings = DL.warnings +1

if(False ==  Pro_SendCmd().RunCK(Pro_SendCmd().Run(C2C06[0][0],C2C06[0][1],50000,False,DL),C2C06[0][2],DL)): DL.fails = DL.fails +1
for Case in C2C08:
    if(False ==  Pro_SendCmd().RunCK(Pro_SendCmd().Run(Case[0],Case[1],50000,False,DL),Case[2],DL)): DL.fails = DL.fails +1
for Case in C2C07:
    if(False ==  Pro_SendCmd().RunCK(Pro_SendCmd().Run(Case[0],Case[1],50000,False,DL),Case[2],DL)): DL.fails = DL.fails +1

if(Robot == True):  DL.Robot_RemoveCard()
else: DL.ShowMessageBox("Note!", "Remove card", 30000)

if(False ==  Pro_SendCmd().RunCK(Pro_SendCmd().Run(C2C01[0][0],C2C01[0][1],50000,False,DL),C2C01[0][2],DL)): DL.fails = DL.fails +1

#Check device memory not change after script
if(False ==  Pro_SendCmd().RunCK(Pro_SendCmd().Run(C0930[0][0],C0930[0][1],5000,False,DL),strMemory,DL)): 
    DL.fails = DL.fails +1
    DL.setText("RED","Device memory changed after script")

##################################################


# Result Count ####################################
# Warning Count & Fail Count
if(0 < (DL.fails + DL.warnings)):
	DL.setText("RED", "[Test Result] - Fail\r\n Warning:" +str(DL.warnings)+"\r\n Fail:" + str(DL.fails))
else:
	DL.setText("GREEN", "[Test Result] - PASS\r\n Warning:0\r\n Fail:0" )

##################################################

#! Script END