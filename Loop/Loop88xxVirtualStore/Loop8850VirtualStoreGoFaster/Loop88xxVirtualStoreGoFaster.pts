DL_SCRIPTVERSION
1
2480

'-----------------------------------------------------------------------
' This is a virtual store looping test scritp (template), which runs
' data flows in valid use sequences to simulate store transaction processes
'
' Note: this script is good for 88xx readers only 
' different locations as needed and forms a dedicated looping test by
' puting your own script statements in a single .pts file.
' 
' The following is an example for a command coverage test for VP88xx.
' which runs loops for most of 8800 IDG commands 
' 
'-----------------------------------------------------------------------
' This single loop test consists of multiple sub test projects 
' You may enable or disable any of them by setting the sub project
' variable runProj to "1" (enable) or "0" (disable) in an accosiated 
' sub project section (You may use "rearch" to locate to the proper
' test section quickly)
'
' For example: Diasble test for signature capture
'
'=================================================
' run proj get signature (cmd 83-19, 83-1A, 83-1B) 
'=================================================
' result = 1
' runProj = 0 - disable this test 
' If runProj <> 0 Then
'  StartProj ("C:\vivotech\regress\regression\regress_test\test_tree\Signature_Capture\SC019\SC019")
'
'-----------------------------------------------------------------------
'Note:
'This is just a template. It can be modified in any ways that may meet 
'your test needs 
'
'----------------------------------------------------------------------- 
'============================================================
' Global Variable definitions
'============================================================
Date_Time = "D" & Year(Now) & "." & Month(Now)  & "." & Day(Now) & "_T" & Hour(Now) & "." & Minute(Now) &  "." & Second(Now)
Test_ID = "Loop88xx"

freeMem = 15000
freeMemCounter = 0
preFreeMem = 30000
minFreeMem = 30

'============================================================
'FileOutput2.CreateFile "Free_Mem_Log.txt", False, False
'FileOutput2.WriteLine "List free memory size below:"

'============================================================

'------------------------------------------------------------
' Config Variables (!!!!! DO NOT EDIT !!!!!)
' - Set the following:
'   - Enable/disable Test Case Number and Description
'   - Enable/disable Test Step prompting
'   - Assign Docklight COM port
'   - Assign Docklight Baud Rate
'------------------------------------------------------------
'FileInput.OpenFile "C:\vivotech\regress\regression\regress_test\test_tree\Regress.Config"
FileInput.OpenFile "Loop.Config"
Dim Prompting(1)
Dim COM_Port(1)
Dim POSBaudRate(1)
DebuggerOption = 1
Dim ControlID
Dim SubTotalGID

Do Until FileInput.EndOfFile
  'Display Test Case Number and Description     
  result = FileInput.GetLine() 'by pass variable name
  result = FileInput.GetLine()
  Prompting(0) = result
      
  'Display Test Steps   
  result = FileInput.GetLine() 'by pass variable name
  result = FileInput.GetLine()      
  Prompting(1) = result

  'Set Docklight COM Port     
  result = FileInput.GetLine() 'by pass variable name
  result = FileInput.GetLine()      
  COM_Port(1) = result

  'Set Reader Baud Rate
  result = FileInput.GetLine() 'by pass variable name
  result = FileInput.GetLine()      
  POSBaudRate(1) = result

  'Set Test ID
  result = FileInput.GetLine() 'by pass variable name
  result = FileInput.GetLine()      
  Test_ID = result
     
Loop

Sub StepPrompt(PromptString)
      DL.AddComment PromptString
      If Prompting(1) = "ON" Then
            MsgBox PromptString, VBOKOnly, "Test Step"
      Else
      End If
      
End Sub

'------------------------------------------------------------
' Definitions and Initializations (!!!!! DO NOT EDIT !!!!!)
' - 
'------------------------------------------------------------
DL.ClearCommWindows
DL.AddComment Date_Time

FileOutput2.CreateFile Date_Time & "_" & Test_ID & "_Free_Mem_Log.txt", False, False
FileOutput2.WriteLine "* "
FileOutput2.WriteLine "* List free memory in the format below."
FileOutput2.WriteLine "* Free Mem = <size> -<No.of stores went through>- on Iteration <No.of iterations> TimeTag:<Date & Time>"
FileOutput2.WriteLine "* "


DL.StartLogging Date_Time & "_" & Test_ID & "_DOCKLIGHT_LOG" ,False, "H"
'DL.StartLogging "DOCKLIGHT_LOG",False, "H"
', false, true


Dim prompt
Dim confirm

result = 1

'------------------------------------------------------------
'Result reporting (!!!!! DO NOT EDIT !!!!!)
'------------------------------------------------------------
MasterResult = 1

Sub PrintMyResult(ResultX)

      If ResultX = 0 Then
            MasterResult = 0
            DL.AddComment "Result = FAILED"
      ElseIf ResultX = 1 Then
            DL.AddComment "Result = PASSED"
      End If

End Sub

'==============================================
' Sub: open project and set port and baudrate 
'==============================================
Sub StartProj (ProjectName)

'DL.Pause 500
DL.StopCommunication
DL.AddComment vbCrLf & "Communication stopped ..." & vbCrLf
DL.Pause 200

If ProjectName <> "0" Then
 DL.OpenProject ProjectName & ".ptp"
 DL.Pause 1000
 DL.AddComment vbCrLf & "TEST CASE: " & ProjectName & vbCrLf
End If

DL.AddComment "--- Set POS COM PORT Settings"
'DL.StopCommunication
DL.AddComment "Set POS COM PORT..."
DL.SetChannelSettings(COM_Port(1) & ":" & POSBaudRate(1) & ",NONE,8,1")
DL.AddComment "POS operating on " & COM_Port(1) & " @ " & POSBaudRate(1) & " baud..."
DL.AddComment "Set POS COM PORT - COMPLETE" & vbCrLf
DL.Pause 100

DL.StartCommunication
DL.AddComment vbCrLf & "Communication started ..." & vbCrLf
DL.Pause 200

End Sub
'==== End of open project and set port and baudrate


'-------------------------------------------------------------
' sub for card present token
'-------------------------------------------------------------
Sub sendToken (token_ID)
FileOutput.CreateFile "DLtoken.tkn", False, True
FileOutput.WriteLine token_ID
FileOutput.CloseFile
End Sub

Sub DL_OnSend()
sendPeek = DL.OnSend_Peek(1, "A")
cmdCode = DL.OnSend_Peek(11)
subCmd = DL.OnSend_Peek(12)

' DL.AddComment "sendPeek = " & sendPeek
' DL.AddComment "cmdCode = " & cmdCode
' DL.AddComment "subCmd = " & subCmd

' If sendPeek <> 86 Then
If sendPeek <> "V" Then
  DL.AddComment "sendPeek = " & sendPeek
Else



' If ((cmdCode = 2)And (subCmd <> 6 And subCmd <> 7)) Or ((cmdCode = 44) And (subCmd = 2)) Then
' DL.AddComment "cmdCode = " & cmdCode
' DL.AddComment "subCmd = " & subCmd
' DL.AddComment "Present card is required ... "
' sendToken ("2")
' End If

Select Case cmdCode
	Case 2
        If subCmd <> 6 And subCmd <> 7 Then
        DL.AddComment "cmdCode = " & cmdCode
        DL.AddComment "subCmd = " & subCmd
        DL.AddComment "Present card is required ... "
        sendToken ("1")
        End If

	Case 44
        If subCmd = 2 Then
        DL.AddComment "cmdCode = " & cmdCode
        DL.AddComment "subCmd = " & subCmd
        DL.AddComment "Present card is required ... "
        sendToken ("2")
        End If

End Select



    ' For all Send Sequences with minimum 3 bytes length (one byte user data,
    ' two bytes CRC, perform the following manipulation:
    ' - Calculate a 16 bit crc value on the characters 1 .. (DL.OnSend_Size() - 2)
    ' - Write the low byte to character no. DL.OnSend_GetSize()-1
    ' - Write the high byte to character no. DL.OnSend_GetSize()
    ' Example:
    ' Send Sequence name: MyCommand
    ' Send Sequence in HEX representation: 02 04 00 00 00 01 00 00
    ' --> Data transmitted by Docklight:   02 04 00 00 00 01 31 F9
    '     (with "31" as the low byte CRC, "F9" as the high byte)

    ' Check if there is at least one byte of user data
    usDataLen = DL.OnSend_GetSize() - 2
    If usDataLen > 0 Then
        crcStr = DL.CalcChecksum("CRC-CCITT", DL.OnSend_GetData("H"), "H", 1, usDataLen) 
        ' Write result to the last two bytes of the sequence
        DL.OnSend_Poke usDataLen + 1, CInt("&h" + Right(crcStr, 2)) ' low byte
        DL.OnSend_Poke usDataLen + 2, CInt("&h" + Left(crcStr, 2)) ' high byte
    End If
End If 'end of sendPeek
End Sub


Sub DL_OnReceive()
resultName = DL.OnReceive_GetName()
DL.AddComment "resultName = " & resultName

Select Case resultName
	Case "Display Control OK"
		resultRcv = DL.OnReceive_GetData("H")	' get the result as string of Hex-values
		DL.AddComment resultRcv	
		' one possible solution to get single characters
		MyArray = Split(resultRcv , " ", -1, 1)

		' ### Prints each byte in array
		'For i = 0 to UBound(MyArray)
   		'	DL.AddComment "i = " & i & "Array - " & (MyArray(i))
		'Next
		' ### Extracts 4 byte Control ID
		ControlID = MyArray(14) & " " & MyArray(15) & " " & MyArray(16) & " " & MyArray(17)
		' ### Prints 4 byte Control ID
		DL.AddComment "Control ID = " & ControlID

	Case "ENTER Key PRESSED"
		ENTER_Key_Pressed = 1

	Case "Get Mem Resp"
            Date_Time = "D" & Year(Now) & "." & Month(Now)  & "." & Day(Now) & "_T" & Hour(Now) & "." & Minute(Now) &  "." & Second(Now)
		resultRcv = DL.OnReceive_GetData("H")	' get the result as string of Hex-values
		DL.AddComment vbCrLf & resultRcv & vbCrLf
		' one possible solution to get single characters
		MyArray = Split(resultRcv , " ", -1, 1)

            freeMem = Chr("&H" & MyArray(55)) & Chr("&H" & MyArray(56)) & Chr("&H" & MyArray(57)) & Chr("&H" & MyArray(58)) & Chr("&H" & MyArray(59))

		' ### Prints free mem 5 byte freeMem
		DL.AddComment "Free Memory = " & freeMem
            FileOutput2.WriteLine "Free Mem = " & freeMem & "   - " & freeMemCounter & " - on Iteration " & Count & "          TimeTag: " & Date_Time
		freeMemCounter = freeMemCounter + 1 

End Select
End Sub


Function ReverseResult(ResultParam)
      If ResultParam = 1 Then
            result = 0
      ElseIf ResultParam = 0 Then
            result = 1
      End If
End Function 

'------------------------------------------------------------
'Debugging (!!!!! DO NOT EDIT !!!!!)
'------------------------------------------------------------
Function MyDebug(DebugString)
      DL.AddComment  vbCrLf & DebugString & " = " & result & vbCrLf
      MsgBox DebugString & " = " & result, VBOKOnly, "Debug"
End Function

'------------------------------------------------------------
'TEST BEGINS
'------------------------------------------------------------
'------------------------------------------------------------
loopForever = 1
runIt = 0
runTarget = 1
runWalmart = 1
runHomedepot = 1
runSubway = 1
runSubwayS = 0
Count = 0
BC_Enabled = 1
secureComm = 1

  StartProj("0")

'DL.StartCommunication
'DL.AddComment vbCrLf & "Communication started ..." & vbCrLf
'DL.Pause 500

  DL.ResetReceiveCounter
  DL.AddComment "--- Terminate secure session"
  DL.SendSequence "", "56 69 56 4F 74 65 63 68 32 00 80 0B 00 00 2E 49", "H"
  DL.Pause 2000

  DL.ResetReceiveCounter
  DL.AddComment "--- Reset to Initial State"
  DL.SendSequence "", "56 69 56 4F 74 65 63 68 32 00 83 01 00 00 33 15", "H"
  DL.Pause 2000

'  DL.ResetReceiveCounter
'  DL.AddComment "--- Set BC On Intitially"
'  DL.SendSequence "", "56 69 56 4F 74 65 63 68 32 00 04 00 00 04 DF 59 01 01 4B AF", "H"
'  DL.Pause 1000

  DL.ResetReceiveCounter
  DL.AddComment "--- Set BC Off Intitially"
  DL.SendSequence "", "56 69 56 4F 74 65 63 68 32 00 04 00 00 04 DF 59 01 00 6A BF", "H"
  DL.Pause 1500

  DL.ResetReceiveCounter
  DL.AddComment "--- Delete Key"
  DL.SendSequence "", "56 69 56 4F 74 65 63 68 32 00 83 00 00 00 03 22", "H"
  DL.Pause 2000
  
  DL.ResetReceiveCounter
  DL.AddComment "--- Set Unecrypted KLK"
  DL.SendSequence "", "56 69 56 4F 74 65 63 68 32 00 80 00 00 65 30 43 46 35 35 34 43 32 46 30 45 45 41 41 30 30 38 38 4B 30 54 44 30 30 4E 30 30 30 30 30 30 38 30 32 41 38 34 46 44 44 36 33 39 31 35 44 43 41 45 42 46 38 37 37 35 34 33 32 32 44 32 36 37 42 41 33 34 34 31 38 33 41 42 39 41 32 35 36 37 39 30 32 33 34 39 38 37 31 32 30 32 33 34 30 30 30 30 30 30 30 30 C2 98", "H"
  DL.Pause 1000

  DL.ResetReceiveCounter
  DL.AddComment "--- Set Unecrypted KLK 2"
  DL.SendSequence "", "56 69 56 4F 74 65 63 68 32 00 80 00 00 65 31 35 43 44 42 38 31 32 46 30 45 45 41 41 30 30 38 38 4B 30 54 44 30 30 4E 30 30 30 30 30 30 38 30 39 32 36 39 41 34 33 36 39 42 36 43 37 45 33 42 35 36 37 32 39 38 33 41 36 36 32 46 36 31 30 33 32 35 37 32 39 32 33 36 33 37 38 33 30 33 33 36 32 33 41 39 39 37 31 32 36 32 33 34 30 30 30 30 30 30 30 30 AA E9", "H"
  DL.Pause 1000

  DL.ResetReceiveCounter
  DL.AddComment "--- Ecrypted KLK"
  DL.SendSequence "", "56 69 56 4F 74 65 63 68 32 00 80 01 00 58 41 30 30 38 38 4B 30 54 44 30 30 4E 30 30 30 30 42 39 34 38 46 37 42 33 34 43 41 44 37 32 36 42 41 37 37 43 39 43 34 41 38 30 37 37 39 42 42 38 36 42 42 43 33 37 34 30 31 31 42 42 45 33 39 45 30 36 46 34 46 36 41 37 44 44 36 46 37 32 30 45 37 31 33 44 45 39 34 41 A0 6B", "H"
  DL.Pause 1000

  DL.ResetReceiveCounter
  DL.AddComment "--- Master Session Index 0"
  DL.SendSequence "", "56 69 56 4F 74 65 63 68 32 00 80 03 00 59 00 41 30 30 38 38 4B 30 54 44 30 30 4E 30 30 30 30 38 45 33 43 43 38 36 45 38 39 33 35 37 34 43 30 44 31 38 36 30 44 34 36 43 39 39 35 35 45 43 33 31 37 43 30 33 32 30 46 35 32 42 38 30 46 37 35 38 35 46 32 37 45 37 31 46 36 41 36 33 44 42 39 43 45 44 46 31 37 30 32 C8 61", "H"
  DL.Pause 1000

  DL.ResetReceiveCounter
  DL.AddComment "--- Master Session Index 9"
  DL.SendSequence "", "56 69 56 4F 74 65 63 68 32 00 80 03 00 59 09 41 30 30 38 38 4B 30 54 44 30 30 4E 30 30 30 30 38 45 33 43 43 38 36 45 38 39 33 35 37 34 43 30 44 31 38 36 30 44 34 36 43 39 39 35 35 45 43 33 31 37 43 30 33 32 30 46 35 32 42 38 30 46 37 35 38 35 46 32 37 45 37 31 46 36 41 36 33 44 42 39 43 45 44 46 31 37 30 32 C7 D9", "H"
  DL.Pause 1000

  DL.ResetReceiveCounter
  DL.AddComment "--- Load Dukpt"
  DL.SendSequence "", "56 69 56 4F 74 65 63 68 32 00 81 00 00 70 41 30 31 31 32 50 30 54 45 30 30 4E 30 31 30 30 4B 53 31 38 46 46 46 46 39 38 37 36 35 34 33 32 31 30 45 30 30 30 30 30 37 43 45 37 34 45 39 30 30 35 33 43 41 38 45 45 42 43 33 37 42 35 37 30 36 38 31 45 35 42 32 37 36 31 34 38 43 33 45 37 34 34 41 42 43 44 36 44 34 43 35 33 36 43 37 46 34 46 36 37 44 37 46 32 44 44 38 45 30 34 37 30 C5 3F", "H"
  DL.Pause 1000

  DL.ResetReceiveCounter
  DL.AddComment "--- Load secure session key"
  DL.SendSequence "", "56 69 56 4F 74 65 63 68 32 00 80 0C 00 58 41 30 30 38 38 44 30 54 45 30 30 4E 30 30 30 30 33 31 31 32 43 46 38 45 39 45 44 45 45 32 41 38 32 34 38 32 34 34 38 38 38 30 37 34 41 39 46 39 35 34 33 36 39 45 46 34 44 33 45 37 33 46 37 37 36 34 41 35 32 30 33 30 45 45 44 44 41 37 31 31 35 41 41 46 46 42 46 34 56 91", "H"
  DL.Pause 1000

'===========================================================================
' Post Init
'===========================================================================
result = 1
runProj = runTarget
If runProj <> 0 Then
  StartProj("sysCommon")

'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- Get memory"
  DL.SendSequence "Get memory"
  result = DL.WaitForSequence("Get Mem Resp", 1, 3000)

End If 'end of proj

Do
Count = Count + 1
  DL.AddComment vbCrLf & "----- Iteration #" & Count & " -----" & vbCrLf

'===========================================================================
' POSTarget
'===========================================================================
result = 1
runProj = runTarget
If runProj <> 0 Then
  StartProj("posTarget")

'============================================================
 DL.ResetReceiveCounter
  DL.AddComment "--- Enable Custom Display Mode"
  DL.SendSequence "Enable Custom Display Mode"
  result = DL.WaitForSequence("Display CUSTOM MODE OK", 1, 3000)
'-------------------------------------------------------------
  DL.ResetReceiveCounter
  DL.AddComment "--- White/Red"
  DL.SendSequence "White/Red"
  result = DL.WaitForSequence("generic resp", 1, 3000)
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- Welcome to Target text"
  DL.SendSequence "Welcome to Target text"
  result = DL.WaitForSequence("generic resp", 1, 3000)
  DL.Pause 500
'============================================================
'  DL.ResetReceiveCounter
'  DL.AddComment "--- Clear Display"
'  DL.SendSequence "Clear Display"
'  result = DL.WaitForSequence("Clear Display Resp", 1, 3000)
'============================================================
'  DL.ResetReceiveCounter
'  DL.AddComment "--- Clear Even Queue"
'  DL.SendSequence "Clear Even Queue"
'  result = DL.WaitForSequence("Display CUSTOM MODE OK", 1, 3000)
'============================================================ 
' DL.ResetReceiveCounter
'  DL.AddComment "--- Enable Custom Display Mode"
'  DL.SendSequence "Enable Custom Display Mode"
'  result = DL.WaitForSequence("Display CUSTOM MODE OK", 1, 3000)
'-------------------------------------------------------------
  DL.ResetReceiveCounter
  DL.AddComment "--- slides show Target"
  DL.SendSequence "slides show Target"
  result = DL.WaitForSequence("Display CUSTOM MODE OK", 1, 3000)
  DL.Pause 10000
'-------------------------------------------------------------
  DL.ResetReceiveCounter
  DL.AddComment "--- stop slides show"
  DL.SendSequence "stop slides show"
  result = DL.WaitForSequence("Display CUSTOM MODE OK", 1, 3000)
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- Clear Display"
  DL.SendSequence "Clear Display"
  result = DL.WaitForSequence("Clear Display Resp", 1, 3000)
'============================================================

  
For I = 1 To 6

  ' DL.Pause 1000
  
  DL.ResetReceiveCounter
  DL.AddComment "--- buzz w/ led 3 on "
  DL.SendSequence "buzz w/ led 3 on "
  result = DL.WaitForSequence("generic resp", 1, 3000)

  DL.ResetReceiveCounter
  DL.AddComment "--- num item " & I
  DL.SendSequence "num item " & I
  result = DL.WaitForSequence("Display Control OK", 1, 3000)
 
  DL.ResetReceiveCounter
  DL.AddComment "--- dsc item " & I
  DL.SendSequence "dsc item " & I
  result = DL.WaitForSequence("Display Control OK", 1, 3000)

  DL.ResetReceiveCounter
  DL.AddComment "--- amt item " & I
  DL.SendSequence "amt item " & I
  result = DL.WaitForSequence("Display Control OK", 1, 3000)

  DL.Pause 100
  DL.ResetReceiveCounter
  DL.AddComment "--- no buzz w/ led 3 off "
  DL.SendSequence "no buzz w/ led 3 off "
  result = DL.WaitForSequence("generic resp", 1, 3000)
Next

'---------------------------------------------------------------

  DL.ResetReceiveCounter
  DL.AddComment "--- subtotal text "
  DL.SendSequence "subtotal text "
  result = DL.WaitForSequence("Display Control OK", 1, 3000)

  DL.ResetReceiveCounter
  DL.AddComment "--- subtotal amt "
  DL.SendSequence "subtotal amt  "
  result = DL.WaitForSequence("Display Control OK", 1, 3000)

  DL.Pause 500

'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- Clear Even Queue "
  DL.SendSequence "Clear Even Queue "
  result = DL.WaitForSequence("generic resp", 1, 3000)
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- Select payment text"
  DL.SendSequence "Select payment text"
  result = DL.WaitForSequence("generic resp", 1, 3000)
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- Select target card text"
  DL.SendSequence "Select target card text"
  result = DL.WaitForSequence("generic resp", 1, 3000)
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- big Credit Button T "
  DL.SendSequence "big Credit Button T"
  result = DL.WaitForSequence("generic resp", 1, 3000)
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- big Debit Button T"
  DL.SendSequence "big Debit Button T"
  result = DL.WaitForSequence("generic resp", 1, 3000)
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- Target card Button"
  DL.SendSequence "Target card Button"
  result = DL.WaitForSequence("generic resp", 1, 3000)
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- Get Input Event "
  DL.SendSequence "Get Input Event "
  result = DL.WaitForSequence("generic resp", 1, 2000)
  DL.Pause 500
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- Enhanced Activate Transaction Command (02-20) 218.66 "
  DL.SendSequence "Enhanced Activate Transaction Command (02-20) 218.66 "
  result = DL.WaitForSequence("generic resp", 1, 3500)
  DL.Pause 500
'============================================================
  ' DL.ResetReceiveCounter
  ' DL.AddComment "--- White/Red"
  ' DL.SendSequence "White/Red"
  ' result = DL.WaitForSequence("generic resp", 1, 3000)
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- get dukpt pin "
  DL.SendSequence "get dukpt pin "
  result = DL.WaitForSequence("generic resp", 1, 6000)
  DL.Pause 2000
'============================================================
'  DL.ResetReceiveCounter
'  DL.AddComment "--- signature capture "
'  DL.SendSequence "signature capture "
'  result = DL.WaitForSequence("generic resp", 1, 48000)
  ' DL.Pause 1000
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- Thanks for shopping at Target text "
  DL.SendSequence "Thanks for shopping at Target text "
  result = DL.WaitForSequence("generic resp", 1, 3000)
  DL.Pause 500
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- display tagetLady png "
  DL.SendSequence "display tagetLady png "
  result = DL.WaitForSequence("generic resp", 1, 3000)
  DL.Pause 1000

'=============================================================
     DL.AddComment "get free mem size"
     DL.ResetReceiveCounter
     DL.SendSequence "", "56 69 56 4F 74 65 63 68 32 00 82 04 00 00 77 88", "H"
     result = DL.WaitForSequence("Get Mem Resp", 1, 15000)
'--------------------------------------------------------------

End If 'end of proj

'===========================================================================
' POSWalmart
'===========================================================================
result = 1
runProj = runWalmart
If runProj <> 0 Then
  StartProj("posWalmart")

'============================================================
 DL.ResetReceiveCounter
  DL.AddComment "--- Enable Custom Display Mode"
  DL.SendSequence "Enable Custom Display Mode"
  result = DL.WaitForSequence("Display CUSTOM MODE OK", 1, 3000)
'-------------------------------------------------------------
  DL.ResetReceiveCounter
  DL.AddComment "--- White/Blue"
  DL.SendSequence "White/Blue"
  result = DL.WaitForSequence("generic resp", 1, 3000)
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- Welcome to Walmart text"
  DL.SendSequence "Welcome to Walmart text"
  result = DL.WaitForSequence("generic resp", 1, 3000)
  DL.Pause 500
'============================================================
'  DL.ResetReceiveCounter
'  DL.AddComment "--- Clear Display"
'  DL.SendSequence "Clear Display"
'  result = DL.WaitForSequence("Clear Display Resp", 1, 3000)
'============================================================
'  DL.ResetReceiveCounter
'  DL.AddComment "--- Clear Even Queue"
'  DL.SendSequence "Clear Even Queue"
'  result = DL.WaitForSequence("Display CUSTOM MODE OK", 1, 3000)
'============================================================ 
' DL.ResetReceiveCounter
'  DL.AddComment "--- Enable Custom Display Mode"
'  DL.SendSequence "Enable Custom Display Mode"
'  result = DL.WaitForSequence("Display CUSTOM MODE OK", 1, 3000)
'-------------------------------------------------------------
  DL.ResetReceiveCounter
  DL.AddComment "--- slides show walmart"
  DL.SendSequence "slides show walmart"
  result = DL.WaitForSequence("Display CUSTOM MODE OK", 1, 3000)
  DL.Pause 15000
'-------------------------------------------------------------
  DL.ResetReceiveCounter
  DL.AddComment "--- stop slides show"
  DL.SendSequence "stop slides show"
  result = DL.WaitForSequence("Display CUSTOM MODE OK", 1, 3000)
'============================================================
'  DL.ResetReceiveCounter
'  DL.AddComment "--- Clear Display"
'  DL.SendSequence "Clear Display"
'  result = DL.WaitForSequence("Clear Display Resp", 1, 3000)
'============================================================
' go into to auto service dept
' select service
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- Walmart Auto Service Department text"
  DL.SendSequence "Walmart Auto Service Department text"
  result = DL.WaitForSequence("generic resp", 1, 3000)
'============================================================
If secureComm <> 0 Then

  DL.ResetReceiveCounter
  DL.AddComment "--- Start secure session"
  DL.SendSequence "Start secure session"
  result = DL.WaitForSequence("generic resp", 1, 3000)

  DL.ResetReceiveCounter
  DL.AddComment "--- Check Box S 1"
  DL.SendSequence "Check Box S 1"
  result = DL.WaitForSequence("generic resp", 1, 3000)

  DL.ResetReceiveCounter
  DL.AddComment "--- Check Box S 2"
  DL.SendSequence "Check Box S 2"
  result = DL.WaitForSequence("generic resp", 1, 3000)

  DL.ResetReceiveCounter
  DL.AddComment "--- Terminate secure session"
  DL.SendSequence "Terminate secure session"
  result = DL.WaitForSequence("generic resp", 1, 3000)

Else

  DL.ResetReceiveCounter
  DL.AddComment "--- Check Box 1"
  DL.SendSequence "Check Box 1"
  result = DL.WaitForSequence("generic resp", 1, 3000)

  DL.ResetReceiveCounter
  DL.AddComment "--- Check Box 2"
  DL.SendSequence "Check Box 2"
  result = DL.WaitForSequence("generic resp", 1, 3000)

End If
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- oil chane text"
  DL.SendSequence "oil chane text"
  result = DL.WaitForSequence("generic resp", 1, 3000)
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- Tire service"
  DL.SendSequence "Tire service"
  result = DL.WaitForSequence("generic resp", 1, 3000)
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- check your service"
  DL.SendSequence "check your service"
  result = DL.WaitForSequence("generic resp", 1, 3000)
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- Done Button"
  DL.SendSequence "Done Button"
  result = DL.WaitForSequence("generic resp", 1, 3000)
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- Clear Even Queue"
  DL.SendSequence "Clear Even Queue"
  result = DL.WaitForSequence("generic resp", 1, 3000)
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- Get Input Event "
  DL.SendSequence "Get Input Event "
  result = DL.WaitForSequence("generic resp", 1, 12000)
'============================================================
  DL.Pause 500
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- select motor oil text text"
  DL.SendSequence "select motor oil text text"
  result = DL.WaitForSequence("generic resp", 1, 3000)
'============================================================
If secureComm <> 0 Then

  DL.ResetReceiveCounter
  DL.AddComment "--- Start secure session"
  DL.SendSequence "Start secure session"
  result = DL.WaitForSequence("generic resp", 1, 3000)
  
  For I = 1 To 4
  DL.ResetReceiveCounter
  DL.AddComment "--- Radio button S " & I
  DL.SendSequence "Radio button S " & I
  result = DL.WaitForSequence("generic resp", 1, 3000)
  Next

  DL.ResetReceiveCounter
  DL.AddComment "--- Terminate secure session"
  DL.SendSequence "Terminate secure session"
  result = DL.WaitForSequence("generic resp", 1, 3000)

Else

  For I = 1 To 4
  DL.ResetReceiveCounter
  DL.AddComment "--- Radio button " & I
  DL.SendSequence "Radio button " & I
  result = DL.WaitForSequence("generic resp", 1, 3000)
  Next

End If
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- Done Button"
  DL.SendSequence "Done Button"
  result = DL.WaitForSequence("generic resp", 1, 3000)
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- Clear Even Queue"
  DL.SendSequence "Clear Even Queue"
  result = DL.WaitForSequence("generic resp", 1, 3000)
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- Get Input Event "
  DL.SendSequence "Get Input Event "
  result = DL.WaitForSequence("generic resp", 1, 12000)
'============================================================
  DL.Pause 500
'============================================================
'  DL.ResetReceiveCounter
'  DL.AddComment "--- Clear Display"
'  DL.SendSequence "Clear Display"
'  result = DL.WaitForSequence("generic resp", 1, 3000)
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- Auto service authorzation text"
  DL.SendSequence "Auto service authorzation text"
  result = DL.WaitForSequence("generic resp", 1, 3000)
'============================================================
If secureComm <> 0 Then

  DL.ResetReceiveCounter
  DL.AddComment "--- Start secure session"
  DL.SendSequence "Start secure session"
  result = DL.WaitForSequence("generic resp", 1, 3000)

  DL.ResetReceiveCounter
  DL.AddComment "--- Display paragraph at xy in specified area (multi pages) font 2 S"
  DL.SendSequence "Display paragraph at xy in specified area (multi pages) font 2 S"
  result = DL.WaitForSequence("generic resp", 1, 3000)

  DL.ResetReceiveCounter
  DL.AddComment "--- Terminate secure session"
  DL.SendSequence "Terminate secure session"
  result = DL.WaitForSequence("generic resp", 1, 3000)

Else

  DL.ResetReceiveCounter
  DL.AddComment "--- Display paragraph at xy in specified area (multi pages) font 2"
  DL.SendSequence "Display paragraph at xy in specified area (multi pages) font 2"
  result = DL.WaitForSequence("generic resp", 1, 3000)

End If
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- Display paragraph button 1"
  DL.SendSequence "Display paragraph button 1"
  result = DL.WaitForSequence("generic resp", 1, 3000)
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- Display paragraph button 2"
  DL.SendSequence "Display paragraph button 2"
  result = DL.WaitForSequence("generic resp", 1, 3000)
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- Clear Even Queue"
  DL.SendSequence "Clear Even Queue"
  result = DL.WaitForSequence("generic resp", 1, 3000)
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- Get Input Event "
  DL.SendSequence "Get Input Event "
  result = DL.WaitForSequence("generic resp", 1, 12000)
'============================================================
   ' DL.Pause 1000
'============================================================
'  DL.ResetReceiveCounter
'  DL.AddComment "--- Clear Display"
'  DL.SendSequence "Clear Display"
'  result = DL.WaitForSequence("generic resp", 1, 3000)
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- Walmart Auto Service Department text"
  DL.SendSequence "Walmart Auto Service Department text"
  result = DL.WaitForSequence("generic resp", 1, 3000)
'============================================================
 
For I = 4 To 6
  DL.Pause 100
  
  DL.ResetReceiveCounter
  DL.AddComment "--- buzz w/ led 3 on "
  DL.SendSequence "buzz w/ led 3 on "
  result = DL.WaitForSequence("generic resp", 1, 3000)

  DL.ResetReceiveCounter
  DL.AddComment "--- num item " & I
  DL.SendSequence "num item " & I
  result = DL.WaitForSequence("Display Control OK", 1, 3000)
 
  DL.ResetReceiveCounter
  DL.AddComment "--- dsc item " & I
  DL.SendSequence "dsc item " & I
  result = DL.WaitForSequence("Display Control OK", 1, 3000)

  DL.ResetReceiveCounter
  DL.AddComment "--- amt item " & I
  DL.SendSequence "amt item " & I
  result = DL.WaitForSequence("Display Control OK", 1, 3000)

  DL.Pause 100
  DL.ResetReceiveCounter
  DL.AddComment "--- no buzz w/ led 3 off "
  DL.SendSequence "no buzz w/ led 3 off "
  result = DL.WaitForSequence("generic resp", 1, 3000)
Next

'---------------------------------------------------------------

  DL.ResetReceiveCounter
  DL.AddComment "--- subtotal text "
  DL.SendSequence "subtotal text "
  result = DL.WaitForSequence("Display Control OK", 1, 3000)

  DL.ResetReceiveCounter
  DL.AddComment "--- subtotal amt "
  DL.SendSequence "subtotal amt  "
  result = DL.WaitForSequence("Display Control OK", 1, 3000)

  DL.Pause 1000

'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- Select payment text"
  DL.SendSequence "Select payment text"
  result = DL.WaitForSequence("generic resp", 1, 3000)
  SelPaymentGID = ControlID
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- big Credit Button"
  DL.SendSequence "big Credit Button"
  result = DL.WaitForSequence("generic resp", 1, 3000)
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- big Debit Button"
  DL.SendSequence "big Debit Button"
  result = DL.WaitForSequence("generic resp", 1, 3000)
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- big Gift Button"
  DL.SendSequence "big Gift Button"
  result = DL.WaitForSequence("generic resp", 1, 3000)
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- big Cash Button"
  DL.SendSequence "big Cash Button"
  result = DL.WaitForSequence("generic resp", 1, 3000)
'============================================================
  DL.Pause 1000
  DL.ResetReceiveCounter
  DL.AddComment "--- Change payment select Text Display "
  DL.SendSequence "Change payment select Text Display ", SelPaymentGID, "H"
  result = DL.WaitForSequence("generic resp", 1, 3000)
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- Clear Even Queue "
  DL.SendSequence "Clear Even Queue "
  result = DL.WaitForSequence("generic resp", 1, 10000)
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- Get Input Event "
  DL.SendSequence "Get Input Event "
  result = DL.WaitForSequence("generic resp", 1, 11000)
  DL.Pause 1000

'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- Active transaction (02-11) 37.06 "
  DL.SendSequence "Active transaction (02-11) 37.06 "
  result = DL.WaitForSequence("generic resp", 1, 3000)
'============================================================
  ' DL.ResetReceiveCounter
  ' DL.AddComment "--- White/Blue"
  ' DL.SendSequence "White/Blue"
  ' result = DL.WaitForSequence("generic resp", 1, 3000)
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- Clear Even Queue "
  DL.SendSequence "Clear Even Queue "
  result = DL.WaitForSequence("generic resp", 1, 10000)
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- Get Input Event "
  DL.SendSequence "Get Input Event "
  result = DL.WaitForSequence("generic resp", 1, 11000)
  DL.Pause 1000
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- Get Transaction Result (03-00) "
  DL.SendSequence "Get Transaction Result (03-00) "
  result = DL.WaitForSequence("generic resp", 1, 3000)
  ' DL.Pause 1000
'============================================================
'  DL.ResetReceiveCounter
'  DL.AddComment "--- get dukpt pin "
'  DL.SendSequence "get dukpt pin "
'  result = DL.WaitForSequence("generic resp", 1, 31000)
'  DL.Pause 2000
'============================================================
'  DL.ResetReceiveCounter
'  DL.AddComment "--- signature capture "
'  DL.SendSequence "signature capture "
'  result = DL.WaitForSequence("generic resp", 1, 48000)
'  DL.Pause 1000
'=============================================================
'  DL.AddComment "--- Clear Display"
'  DL.SendSequence " Clear Display"
'  result = DL.WaitForSequence("generic resp", 1, 3000)
'=============================================================
  DL.AddComment "--- Get signature text"
  DL.SendSequence " Get signature text"
  result = DL.WaitForSequence("generic resp", 1, 3000)
'============================================================
  DL.AddComment "--- signature capture (83-19)"
  DL.SendSequence " signature capture (83-19)"
  result = DL.WaitForSequence("Display Control OK", 1, 3000)
  DL.Pause 500
'============================================================
  DL.AddComment "--- Clear SigCap 83 1b"
  DL.SendSequence "Clear SigCap 83 1b", ControlID, "H"
  result = DL.WaitForSequence("generic resp", 1, 10000)
  'DL.Pause 1000
'============================================================
  DL.AddComment "--- Get SigCap 83 1A"
  DL.SendSequence " Get SigCap 83 1A", ControlID, "H"
  result = DL.WaitForSequence("generic resp", 1, 10000)
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- Thanks for shopping at Walmart text "
  DL.SendSequence "Thanks for shopping at Walmart text "
  result = DL.WaitForSequence("generic resp", 1, 3000)
  DL.Pause 500
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- display walmartLady png "
  DL.SendSequence "display walmartLady png "
  result = DL.WaitForSequence("generic resp", 1, 3000)
  DL.Pause 1000

'=============================================================
     DL.AddComment "get free mem size"
     DL.ResetReceiveCounter
     DL.SendSequence "", "56 69 56 4F 74 65 63 68 32 00 82 04 00 00 77 88", "H"
     result = DL.WaitForSequence("Get Mem Resp", 1, 15000)
'--------------------------------------------------------------

End If 'end of proj

'===========================================================================
' POSHomeDepot
'===========================================================================
result = 1
runProj = runHomedepot
If runProj <> 0 Then
  StartProj("posHomeDepot")

'============================================================
 DL.ResetReceiveCounter
  DL.AddComment "--- Enable Custom Display Mode"
  DL.SendSequence "Enable Custom Display Mode"
  result = DL.WaitForSequence("Display CUSTOM MODE OK", 1, 3000)
'-------------------------------------------------------------
  DL.ResetReceiveCounter
  DL.AddComment "--- White/Orange"
  DL.SendSequence "White/Orange"
  result = DL.WaitForSequence("generic resp", 1, 3000)
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- Welcome to HomeDepot text"
  DL.SendSequence "Welcome to HomeDepot text"
  result = DL.WaitForSequence("generic resp", 1, 3000)
  DL.Pause 500
'============================================================
'  DL.ResetReceiveCounter
'  DL.AddComment "--- Clear Display"
'  DL.SendSequence "Clear Display"
'  result = DL.WaitForSequence("Clear Display Resp", 1, 3000)
'============================================================
'  DL.ResetReceiveCounter
'  DL.AddComment "--- Clear Even Queue"
'  DL.SendSequence "Clear Even Queue"
'  result = DL.WaitForSequence("Display CUSTOM MODE OK", 1, 3000)
'============================================================ 
' DL.ResetReceiveCounter
'  DL.AddComment "--- Enable Custom Display Mode"
'  DL.SendSequence "Enable Custom Display Mode"
'  result = DL.WaitForSequence("Display CUSTOM MODE OK", 1, 3000)
'-------------------------------------------------------------
  DL.ResetReceiveCounter
  DL.AddComment "--- slides show homedepot 1"
  DL.SendSequence "slides show homedepot 1"
  result = DL.WaitForSequence("Display CUSTOM MODE OK", 1, 3000)
  DL.Pause 10000
'-------------------------------------------------------------
  DL.ResetReceiveCounter
  DL.AddComment "--- stop slides show "
  DL.SendSequence "stop slides show "
  result = DL.WaitForSequence("Display CUSTOM MODE OK", 1, 3000)
'============================================================
'  DL.ResetReceiveCounter
'  DL.AddComment "--- Clear Display"
'  DL.SendSequence "Clear Display"
'  result = DL.WaitForSequence("Clear Display Resp", 1, 3000)
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- Checkout at HomeDepot"
  DL.SendSequence "Checkout at HomeDepot"
  result = DL.WaitForSequence("generic resp", 1, 3000)
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- subtotal text "
  DL.SendSequence "subtotal text "
  result = DL.WaitForSequence("generic resp", 1, 3000)

  DL.ResetReceiveCounter
  DL.AddComment "--- subtotal amt "
  DL.SendSequence "subtotal amt  "
  result = DL.WaitForSequence("Display Control OK", 1, 3000)
  SubTotalGID =  ControlID
 
For I = 4 To 6
  DL.Pause 100
  
  DL.ResetReceiveCounter
  DL.AddComment "--- buzz w/ led 3 on "
  DL.SendSequence "buzz w/ led 3 on "
  result = DL.WaitForSequence("generic resp", 1, 3000)

  DL.ResetReceiveCounter
  DL.AddComment "--- num item " & I
  DL.SendSequence "num item " & I
  result = DL.WaitForSequence("Display Control OK", 1, 3000)
 
  DL.ResetReceiveCounter
  DL.AddComment "--- dsc item " & I
  DL.SendSequence "dsc item " & I
  result = DL.WaitForSequence("Display Control OK", 1, 3000)

  DL.ResetReceiveCounter
  DL.AddComment "--- amt item " & I
  DL.SendSequence "amt item " & I
  result = DL.WaitForSequence("Display Control OK", 1, 3000)

  DL.Pause 100
  DL.ResetReceiveCounter
  DL.AddComment "--- no buzz w/ led 3 off "
  DL.SendSequence "no buzz w/ led 3 off "
  result = DL.WaitForSequence("generic resp", 1, 3000)

  DL.ResetReceiveCounter
  DL.AddComment "--- subtotal GID = " & SubTotalGID
  DL.SendSequence "Change subtotal amt " & I, SubTotalGID, "H"
  result = DL.WaitForSequence ("generic resp ", 1,3000)

Next

'---------------------------------------------------------------
  DL.Pause 500
'============================================================
' get extebded warranty
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- Clear Event Queue"
  DL.SendSequence " Clear Even Queue"
  result = DL.WaitForSequence("generic resp", 1, 3000)
  'verdict(result)
'------------------------------------------------------------
  DL.ResetReceiveCounter
  DL.AddComment "--- select a warranty"
  DL.SendSequence " select a warranty"
  result = DL.WaitForSequence("generic resp", 1, 3000)
  'verdict(result)
'------------------------------------------------------------
'  DL.ResetReceiveCounter
'  DL.AddComment "--- Enable Custom Display Mode"
'  DL.SendSequence " Enable Custom Display Mode"
'  result = DL.WaitForSequence("generic resp", 1, 3000)
  'verdict(result)
'------------------------------------------------------------
  DL.ResetReceiveCounter
  DL.AddComment "--- Line Item Box"
  DL.SendSequence "Line Item Box"
  result = DL.WaitForSequence("Display Control Ok", 1, 3000)
'------------------------------------------------------------
  DL.ResetReceiveCounter
  'Debugger "ControlID", ControlID
  DL.AddComment "--- Line Item 1"
  DL.SendSequence "Line Item 1", ControlID, "H"
  result = DL.WaitForSequence("generic resp", 1, 3000)
'------------------------------------------------------------
  DL.ResetReceiveCounter
  'Debugger "ControlID", ControlID
  DL.AddComment "--- Line Item 2"
  DL.SendSequence "Line Item 2", ControlID, "H"
  result = DL.WaitForSequence("generic resp", 1, 3000)
'------------------------------------------------------------
  DL.ResetReceiveCounter
  'Debugger "ControlID", ControlID
  DL.AddComment "--- Line Item 3"
  DL.SendSequence "Line Item 3", ControlID, "H"
  result = DL.WaitForSequence("generic resp", 1, 3000)
'------------------------------------------------------------
  DL.ResetReceiveCounter
  'Debugger "ControlID", ControlID
  DL.AddComment "--- Line Item 4"
  DL.SendSequence "Line Item 4", ControlID, "H"
  result = DL.WaitForSequence("generic resp", 1, 3000)
'------------------------------------------------------------
  DL.ResetReceiveCounter
  'Debugger "ControlID", ControlID
  DL.AddComment "--- Line Item 5"
  DL.SendSequence "Line Item 5", ControlID, "H"
  result = DL.WaitForSequence("generic resp", 1, 3000)
'------------------------------------------------------------
  DL.ResetReceiveCounter
  'Debugger "ControlID", ControlID
  DL.AddComment "--- Display List"
  DL.SendSequence "Display List", ControlID, "H"
  resultIgnore = DL.WaitForSequence("generic resp", 1, 3000)
'------------------------------------------------------------
  DL.Pause 500
  DL.ResetReceiveCounter
  DL.AddComment "--- Get Input Event "
  DL.SendSequence "Get Input Event"
  resultIgnore = DL.WaitForSequence("generic resp", 1, 10000)
  DL.Pause 100
'--------------------------------------------------------------
'  DL.ResetReceiveCounter
  'Debugger "ControlID", ControlID
'  DL.AddComment "--- Get Select Item "
'  DL.SendSequence "Get Select Item ", ControlID, "H"
'  resultIgore = DL.WaitForSequence("generic resp", 1, 3000)
'------------------------------------------------------------
'  DL.ResetReceiveCounter
  'Debugger "ControlID", ControlID
'  DL.AddComment "--- Delete List"
'  DL.SendSequence "Delete List", ControlID, "H"
'  result = DL.WaitForSequence("generic resp", 1, 3000)
'------------------------------------------------------------
  DL.ResetReceiveCounter
  'Debugger "ControlID", ControlID
  DL.AddComment "--- Clear Display"
  DL.SendSequence "Clear Display"
  result = DL.WaitForSequence("generic resp", 1, 3000)

'=== end of get extended warranty ===========================

'------------------------------------------------------------
' redeem coupon
'------------------------------------------------------------
'------------------------------------------------------------

  DL.ResetReceiveCounter
  DL.AddComment "--- display hdCoupon.png"
  DL.SendSequence "display hdCoupon.png"
  result = DL.WaitForSequence ("generic resp", 1,5000)
  DL.Pause 1000

'------------------------------------------------------------

  DL.ResetReceiveCounter
  DL.AddComment "--- redeem homedepot coupon"
  DL.SendSequence "redeem homedepot coupon"
  result = DL.WaitForSequence ("generic resp", 1,3000)
  DL.Pause 1000

'------------------------------------------------------------

  DL.ResetReceiveCounter
  DL.AddComment "--- Disable Custom Display Mode"
  DL.SendSequence "Disable Custom Display Mode"
  result = DL.WaitForSequence ("generic resp", 1,3000)

'------------------------------------------------------------

  DL.ResetReceiveCounter
  DL.AddComment "--- Clear Even Queue"
  DL.SendSequence "Clear Even Queue"
  result = DL.WaitForSequence ("generic resp", 1,3000)

'------------------------------------------------------------

  DL.ResetReceiveCounter
  DL.AddComment "--- enter zip code"
  DL.SendSequence "enter zip code"
  result = DL.WaitForSequence ("generic resp", 1,3000)

'------------------------------------------------------------

  DL.ResetReceiveCounter
  DL.AddComment "--- Input Field Formatting Zip Code"
  DL.SendSequence "Input Field Formatting Zip Code"
  result = DL.WaitForSequence ("Display Control OK", 1,3000)

'-------------------------------------------------------------

  DL.ResetReceiveCounter
  DL.AddComment "--- Get Input Event "
  DL.SendSequence "Get Input Event "
  result = DL.WaitForSequence ("generic resp", 1,10000)

'---------------------------------------------------------------

'  DL.Pause 3000
'  DL.ResetReceiveCounter
'  DL.SendSequence "Get Input Field Value (83-1D)", ControlID, "H"
'  result = DL.WaitForSequence ("generic resp", 1,3000)

  DL.Pause 500
'-------------------------------------------------------------

'  DL.ResetReceiveCounter
'  DL.SendSequence "Clear Input Field (83-1E)", ControlID, "H"
'  result = DL.WaitForSequence ("generic resp", 1,3000)

'============ end of redeem coupon ==========================

'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- Select payment text"
  DL.SendSequence "Select payment text"
  result = DL.WaitForSequence("generic resp", 1, 3000)
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- Credit Button"
  DL.SendSequence "Credit Button"
  result = DL.WaitForSequence("generic resp", 1, 3000)
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- DEBIT Button"
  DL.SendSequence "DEBIT Button"
  result = DL.WaitForSequence("generic resp", 1, 3000)
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- GIFT Button"
  DL.SendSequence "GIFT Button"
  result = DL.WaitForSequence("generic resp", 1, 3000)
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- Clear Even Queue "
  DL.SendSequence "Clear Even Queue "
  result = DL.WaitForSequence("generic resp", 1, 10000)
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- Get Input Event "
  DL.SendSequence "Get Input Event "
  result = DL.WaitForSequence("generic resp", 1, 11000)
  DL.Pause 500

'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- 02 20 Mag, CL, w/ Disable LCD default msg UI, w/ event "
  DL.SendSequence "02 20 Mag, CL, w/ Disable LCD default msg UI, w/ event "
  result = DL.WaitForSequence("generic resp", 1, 3000)
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- total text"
  DL.SendSequence "total text"
  result = DL.WaitForSequence("generic resp", 1, 3000)
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- total amt"
  DL.SendSequence "total amt"
  result = DL.WaitForSequence("generic resp", 1, 3000)
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- text w/ activate transaction (02-20) "
  DL.SendSequence "text w/ activate transaction (02-20) "
  result = DL.WaitForSequence("generic resp", 1, 3000)
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- Clear Even Queue "
  DL.SendSequence "Clear Even Queue "
  result = DL.WaitForSequence("generic resp", 1, 10000)
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- Get Input Event "
  DL.SendSequence "Get Input Event "
  result = DL.WaitForSequence("generic resp", 1, 11000)
  DL.Pause 500
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- Get Transaction Result (03-00) "
  DL.SendSequence "Get Transaction Result (03-00) "
  result = DL.WaitForSequence("generic resp", 1, 3000)
  ' DL.Pause 1000
'============================================================
'  DL.ResetReceiveCounter
'  DL.AddComment "--- get dukpt pin "
'  DL.SendSequence "get dukpt pin "
'  result = DL.WaitForSequence("generic resp", 1, 31000)
'  DL.Pause 2000
'============================================================
'  DL.ResetReceiveCounter
'  DL.AddComment "--- signature capture "
'  DL.SendSequence "signature capture "
'  result = DL.WaitForSequence("generic resp", 1, 48000)
'  DL.Pause 1000
'=============================================================
  DL.AddComment "--- Clear Display"
  DL.SendSequence " Clear Display"
  result = DL.WaitForSequence("generic resp", 1, 3000)
'=============================================================
  DL.AddComment "--- Get signature text"
  DL.SendSequence " Get signature text"
  result = DL.WaitForSequence("generic resp", 1, 3000)
'============================================================
  DL.AddComment "--- signature capture (83-19)"
  DL.SendSequence " signature capture (83-19)"
  result = DL.WaitForSequence("Display Control OK", 1, 3000)
  DL.Pause 1000
'============================================================
'  DL.AddComment "--- Clear SigCap 83 1b"
'  DL.SendSequence "Clear SigCap 83 1b", ControlID, "H"
'  result = DL.WaitForSequence("generic resp", 1, 10000)
'  DL.Pause 500
'============================================================
'  DL.AddComment "--- Get SigCap 83 1A"
'  DL.SendSequence " Get SigCap 83 1A", ControlID, "H"
'  result = DL.WaitForSequence("generic resp", 1, 10000)
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- Thanks for shopping at HomeDepot text "
  DL.SendSequence "Thanks for shopping at HomeDepot text "
  result = DL.WaitForSequence("generic resp", 1, 3000)
  DL.Pause 500
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- display hdDay.png "
  DL.SendSequence "display hdDay.png "
  result = DL.WaitForSequence("generic resp", 1, 3000)
  DL.Pause 500

'=============================================================
     DL.AddComment "get free mem size"
     DL.ResetReceiveCounter
     DL.SendSequence "", "56 69 56 4F 74 65 63 68 32 00 82 04 00 00 77 88", "H"
     result = DL.WaitForSequence("Get Mem Resp", 1, 15000)
'--------------------------------------------------------------

End If 'end of proj

'=======================================================================
' Pos Subway
'=======================================================================
result = 1
runProj = runSubway
If runProj <> 0 Then
  StartProj("posSubway")

'============================================================
'If result <> 0 Then
'  DL.Pause 500
'  DL.ResetReceiveCounter
'  DL.AddComment "--- Load secure session key"
'  DL.SendSequence " Load secure session key"
'  result = DL.WaitForSequence("generic resp ", 1, 10000)
'End If
'============================================================
'If result <> 0 Then
'  DL.Pause 500
'  DL.ResetReceiveCounter
'  DL.AddComment "--- Start secure session"
'  DL.SendSequence " Start secure session"
'  result = DL.WaitForSequence("generic resp ", 1, 10000)
'End If
'============================================================
 DL.ResetReceiveCounter
  DL.AddComment "--- Enable Custom Display Mode"
  DL.SendSequence "Enable Custom Display Mode"
  result = DL.WaitForSequence("Display CUSTOM MODE OK", 1, 3000)
'-------------------------------------------------------------
  DL.ResetReceiveCounter
  DL.AddComment "--- subway color"
  DL.SendSequence "subway color"
  result = DL.WaitForSequence("generic resp", 1, 3000)
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- Welcome to Subway text"
  DL.SendSequence "Welcome to Subway text"
  result = DL.WaitForSequence("generic resp", 1, 3000)
  DL.Pause 500
'============================================================
'  DL.ResetReceiveCounter
'  DL.AddComment "--- Clear Display"
'  DL.SendSequence "Clear Display"
'  result = DL.WaitForSequence("Clear Display Resp", 1, 3000)
'============================================================
'  DL.ResetReceiveCounter
'  DL.AddComment "--- Clear Even Queue"
'  DL.SendSequence "Clear Even Queue"
'  result = DL.WaitForSequence("Display CUSTOM MODE OK", 1, 3000)
'============================================================ 
'  DL.ResetReceiveCounter
'  DL.AddComment "--- Enable Custom Display Mode"
'  DL.SendSequence "Enable Custom Display Mode"
'  result = DL.WaitForSequence("Display CUSTOM MODE OK", 1, 3000)
'-------------------------------------------------------------
  DL.ResetReceiveCounter
  DL.AddComment "--- slides show subway"
  DL.SendSequence "slides show subway"
  result = DL.WaitForSequence("Display CUSTOM MODE OK", 1, 3000)
  DL.Pause 10000
'-------------------------------------------------------------
  DL.ResetReceiveCounter
  DL.AddComment "--- stop slides show"
  DL.SendSequence "stop slides show"
  result = DL.WaitForSequence("Display CUSTOM MODE OK", 1, 3000)
'============================================================
'  DL.ResetReceiveCounter
'  DL.AddComment "--- Clear Display"
'  DL.SendSequence "Clear Display"
'  result = DL.WaitForSequence("Clear Display Resp", 1, 3000)
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- select order"
  DL.SendSequence "select order"
  result = DL.WaitForSequence("generic resp", 1, 3000)
'============================================================
For I = 1 To 4
  DL.ResetReceiveCounter
  DL.AddComment "--- display sw imge png " & I
  DL.SendSequence "display sw imge png " & I 
  result = DL.WaitForSequence("generic resp", 1, 3000)
Next
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- Clear Even Queue"
  DL.SendSequence "Clear Even Queue"
  result = DL.WaitForSequence("generic resp", 1, 3000)
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- Get Input Event "
  DL.SendSequence "Get Input Event "
  result = DL.WaitForSequence("generic resp", 1, 3000)
  DL.Pause 1000
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- confirm your order"
  DL.SendSequence "confirm your order"
  result = DL.WaitForSequence("generic resp", 1, 3000)
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- Yes Button"
  DL.SendSequence "No Button"
  result = DL.WaitForSequence("generic resp", 1, 3000)
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- No Button"
  DL.SendSequence "Yes Button"
  result = DL.WaitForSequence("generic resp", 1, 3000)
'============================================================
For I = 5 To 6
  DL.Pause 100
  
  DL.ResetReceiveCounter
  DL.AddComment "--- buzz w/ led 3 on "
  DL.SendSequence "buzz w/ led 3 on "
  result = DL.WaitForSequence("generic resp", 1, 3000)

  DL.ResetReceiveCounter
  DL.AddComment "--- num item " & I
  DL.SendSequence "num item " & I
  result = DL.WaitForSequence("Display Control OK", 1, 3000)
 
  DL.ResetReceiveCounter
  DL.AddComment "--- dsc item " & I
  DL.SendSequence "dsc item " & I
  result = DL.WaitForSequence("Display Control OK", 1, 3000)

  DL.ResetReceiveCounter
  DL.AddComment "--- amt item " & I
  DL.SendSequence "amt item " & I
  result = DL.WaitForSequence("Display Control OK", 1, 3000)

  DL.Pause 100
  DL.ResetReceiveCounter
  DL.AddComment "--- no buzz w/ led 3 off "
  DL.SendSequence "no buzz w/ led 3 off "
  result = DL.WaitForSequence("generic resp", 1, 3000)

  ' DL.Pause 1000

Next
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- subtotal text "
  DL.SendSequence "subtotal text "
  result = DL.WaitForSequence("generic resp", 1, 3000)
'-----------------------------------------------------------
  DL.ResetReceiveCounter
  DL.AddComment "--- subtotal amt "
  DL.SendSequence "subtotal amt  "
  result = DL.WaitForSequence("Display Control OK", 1, 3000)
  SubTotalGID =  ControlID
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- Clear Even Queue"
  DL.SendSequence "Clear Even Queue"
  result = DL.WaitForSequence("generic resp", 1, 3000)
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- Get Input Event "
  DL.SendSequence "Get Input Event "
  result = DL.WaitForSequence("generic resp", 1, 11000)
  DL.pause 1000
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- Select payment text"
  DL.SendSequence "Select payment text"
  result = DL.WaitForSequence("generic resp", 1, 3000)
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- Credit Button"
  DL.SendSequence "Credit Button"
  result = DL.WaitForSequence("generic resp", 1, 3000)
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- DEBIT Button"
  DL.SendSequence "DEBIT Button"
  result = DL.WaitForSequence("generic resp", 1, 3000)
'============================================================
'  DL.ResetReceiveCounter
'  DL.AddComment "--- GIFT Button"
'  DL.SendSequence "GIFT Button"
'  result = DL.WaitForSequence("generic resp", 1, 3000)
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- Clear Even Queue "
  DL.SendSequence "Clear Even Queue "
  result = DL.WaitForSequence("generic resp", 1, 10000)
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- Get Input Event "
  DL.SendSequence "Get Input Event "
  result = DL.WaitForSequence("generic resp", 1, 11000)
  DL.Pause 1000
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- Activate Transaction Event with Data Encryption (02-15) Track 1  "
  DL.SendSequence "Activate Transaction Event with Data Encryption (02-15) Track 1  "
  result = DL.WaitForSequence("generic resp", 1, 3000)
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- Clear Even Queue "
  DL.SendSequence "Clear Even Queue "
  result = DL.WaitForSequence("generic resp", 1, 10000)
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- Get Input Event "
  DL.SendSequence "Get Input Event "
  result = DL.WaitForSequence("generic resp", 1, 11000)
  DL.Pause 200
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- Get Transaction Result (03-00) "
  DL.SendSequence "Get Transaction Result (03-00) "
  result = DL.WaitForSequence("generic resp", 1, 3000)
  DL.Pause 200
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- get dukpt pin "
  DL.SendSequence "get dukpt pin "
  result = DL.WaitForSequence("generic resp", 1, 5000)
  DL.Pause 1000
'============================================================
'  DL.ResetReceiveCounter
'  DL.AddComment "--- signature capture "
'  DL.SendSequence "signature capture "
'  result = DL.WaitForSequence("generic resp", 1, 48000)
'  DL.Pause 1000
'=============================================================
  DL.AddComment "--- Clear Display"
  DL.SendSequence " Clear Display"
  result = DL.WaitForSequence("generic resp", 1, 3000)
'=============================================================
  DL.AddComment "--- Get signature text"
  DL.SendSequence " Get signature text"
  result = DL.WaitForSequence("generic resp", 1, 3000)
  DL.Pause 1000
'============================================================
  DL.AddComment "--- signature capture (83-19)"
  DL.SendSequence " signature capture (83-19)"
  result = DL.WaitForSequence("Display Control OK", 1, 3000)
  DL.Pause 3000
'============================================================
'  DL.AddComment "--- Clear SigCap 83 1b"
'  DL.SendSequence "Clear SigCap 83 1b", ControlID, "H"
'  result = DL.WaitForSequence("generic resp", 1, 1000)
'  DL.Pause 500
'============================================================
'  DL.AddComment "--- Get SigCap 83 1A"
'  DL.SendSequence " Get SigCap 83 1A", ControlID, "H"
'  result = DL.WaitForSequence("generic resp", 1, 2000)
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- Thanks for coming Subway "
  DL.SendSequence "Thanks for coming Subway "
  result = DL.WaitForSequence("generic resp", 1, 3000)
  DL.Pause 500
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- display sw logo 2 imge png "
  DL.SendSequence "display sw logo 2 imge png "
  result = DL.WaitForSequence("generic resp", 1, 3000)
  DL.Pause 1000
'=============================================================
'If result <> 0 Then
'  DL.Pause 500
'  DL.ResetReceiveCounter
'  DL.AddComment "--- Terminate secure session"
'  DL.SendSequence " Terminate secure session"
'  result = DL.WaitForSequence("generic resp ", 1, 10000)
'End If

'=============================================================
     DL.AddComment "get free mem size"
     DL.ResetReceiveCounter
     DL.SendSequence "", "56 69 56 4F 74 65 63 68 32 00 82 04 00 00 77 88", "H"
     result = DL.WaitForSequence("Get Mem Resp", 1, 15000)
'--------------------------------------------------------------

End If 'end of proj

'=======================================================================
' Pos Subway w/ secure session
'=======================================================================
result = 1
runProj = runSubwayS
If runProj <> 0 Then
  StartProj("posSubway")

'============================================================
'If result <> 0 Then
'  DL.Pause 500
'  DL.ResetReceiveCounter
'  DL.AddComment "--- Load secure session key"
'  DL.SendSequence " Load secure session key"
'  result = DL.WaitForSequence("generic resp ", 1, 10000)
'End If
'============================================================
If result <> 0 Then
  DL.Pause 500
  DL.ResetReceiveCounter
  DL.AddComment "--- Start secure session"
  DL.SendSequence " Start secure session"
  result = DL.WaitForSequence("generic resp ", 1, 10000)
End If
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- subway color S "
  DL.SendSequence "subway color S"
  result = DL.WaitForSequence("generic resp", 1, 3000)
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- Welcome to Subway text S"
  DL.SendSequence "Welcome to Subway text S"
  result = DL.WaitForSequence("generic resp", 1, 3000)
  DL.Pause 3000
'============================================================
'  DL.ResetReceiveCounter
'  DL.AddComment "--- Clear Display"
'  DL.SendSequence "Clear Display"
'  result = DL.WaitForSequence("Clear Display Resp", 1, 3000)
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- Clear Even Queue"
  DL.SendSequence "Clear Even Queue"
  result = DL.WaitForSequence("Display CUSTOM MODE OK", 1, 3000)
'============================================================ 
 DL.ResetReceiveCounter
  DL.AddComment "--- Enable Custom Display Mode"
  DL.SendSequence "Enable Custom Display Mode"
  result = DL.WaitForSequence("Display CUSTOM MODE OK", 1, 3000)
'-------------------------------------------------------------
  DL.ResetReceiveCounter
  DL.AddComment "--- slides show subway S"
  DL.SendSequence "slides show subway S"
  result = DL.WaitForSequence("Display CUSTOM MODE OK", 1, 3000)
  DL.Pause 20000
'-------------------------------------------------------------
  DL.ResetReceiveCounter
  DL.AddComment "--- stop slides show"
  DL.SendSequence "stop slides show"
  result = DL.WaitForSequence("Display CUSTOM MODE OK", 1, 3000)
'============================================================
'  DL.ResetReceiveCounter
'  DL.AddComment "--- Clear Display"
'  DL.SendSequence "Clear Display"
'  result = DL.WaitForSequence("Clear Display Resp", 1, 3000)
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- select order S"
  DL.SendSequence "select order S"
  result = DL.WaitForSequence("generic resp", 1, 3000)
'============================================================
For I = 1 To 4
  DL.ResetReceiveCounter
  DL.AddComment "--- display sw imge png S " & I
  DL.SendSequence "display sw imge png S " & I 
  result = DL.WaitForSequence("generic resp", 1, 3000)
Next
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- Clear Even Queue"
  DL.SendSequence "Clear Even Queue"
  result = DL.WaitForSequence("generic resp", 1, 3000)
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- Get Input Event S"
  DL.SendSequence "Get Input Event S "
  result = DL.WaitForSequence("generic resp", 1, 3000)
  DL.Pause 10000
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- confirm your order S"
  DL.SendSequence "confirm your order S"
  result = DL.WaitForSequence("generic resp", 1, 3000)
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- Yes Button S"
  DL.SendSequence "No Button S"
  result = DL.WaitForSequence("generic resp", 1, 3000)
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- No Button S"
  DL.SendSequence "Yes Button S"
  result = DL.WaitForSequence("generic resp", 1, 3000)
'============================================================
For I = 5 To 6
  DL.Pause 200
  
  DL.ResetReceiveCounter
  DL.AddComment "--- buzz w/ led 3 on S"
  DL.SendSequence "buzz w/ led 3 on S "
  result = DL.WaitForSequence("generic resp", 1, 3000)

  DL.ResetReceiveCounter
  DL.AddComment "--- num item S " & I
  DL.SendSequence "num item S " & I
  result = DL.WaitForSequence("generic resp", 1, 3000)
 
  DL.ResetReceiveCounter
  DL.AddComment "--- dsc item S " & I
  DL.SendSequence "dsc item S " & I
  result = DL.WaitForSequence("generic resp", 1, 3000)

  DL.ResetReceiveCounter
  DL.AddComment "--- amt item S " & I
  DL.SendSequence "amt item S " & I
  result = DL.WaitForSequence("generic resp", 1, 3000)

  DL.Pause 200
  DL.ResetReceiveCounter
  DL.AddComment "--- no buzz w/ led 3 off S"
  DL.SendSequence "no buzz w/ led 3 off S "
  result = DL.WaitForSequence("generic resp", 1, 3000)

  DL.Pause 1000

Next
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- subtotal text S "
  DL.SendSequence "subtotal text S "
  result = DL.WaitForSequence("generic resp", 1, 3000)
'-----------------------------------------------------------
  DL.ResetReceiveCounter
  DL.AddComment "--- subtotal amt S "
  DL.SendSequence "subtotal amt S  "
  result = DL.WaitForSequence("Display Control OK", 1, 3000)
  SubTotalGID =  ControlID
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- Clear Even Queue"
  DL.SendSequence "Clear Even Queue"
  result = DL.WaitForSequence("generic resp", 1, 3000)
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- Get Input Event S "
  DL.SendSequence "Get Input Event S "
  result = DL.WaitForSequence("generic resp", 1, 11000)
  DL.pause 1200
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- Select payment text S"
  DL.SendSequence "Select payment text S"
  result = DL.WaitForSequence("generic resp", 1, 3000)
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- Credit Button S"
  DL.SendSequence "Credit Button S"
  result = DL.WaitForSequence("generic resp", 1, 3000)
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- DEBIT Button S"
  DL.SendSequence "DEBIT Button S"
  result = DL.WaitForSequence("generic resp", 1, 3000)
'============================================================
'  DL.ResetReceiveCounter
'  DL.AddComment "--- GIFT Button"
'  DL.SendSequence "GIFT Button"
'  result = DL.WaitForSequence("generic resp", 1, 3000)
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- Clear Even Queue "
  DL.SendSequence "Clear Even Queue "
  result = DL.WaitForSequence("generic resp", 1, 10000)
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- Get Input Event S "
  DL.SendSequence "Get Input Event S "
  result = DL.WaitForSequence("generic resp", 1, 11000)
  DL.Pause 1200
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- Activate Transaction Event with Data Encryption (02-15) Track 1 S  "
  DL.SendSequence "Activate Transaction Event with Data Encryption (02-15) Track 1 S "
  result = DL.WaitForSequence("generic resp", 1, 3000)
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- Clear Even Queue "
  DL.SendSequence "Clear Even Queue "
  result = DL.WaitForSequence("generic resp", 1, 10000)
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- Get Input Event S "
  DL.SendSequence "Get Input Event S "
  result = DL.WaitForSequence("generic resp", 1, 11000)
  DL.Pause 1000
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- Get Transaction Result (03-00) "
  DL.SendSequence "Get Transaction Result (03-00) "
  result = DL.WaitForSequence("generic resp", 1, 3000)
  ' DL.Pause 1000
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- get dukpt pin S "
  DL.SendSequence "get dukpt pin S "
  result = DL.WaitForSequence("generic resp", 1, 31000)
  DL.Pause 3100
'============================================================
'  DL.ResetReceiveCounter
'  DL.AddComment "--- signature capture "
'  DL.SendSequence "signature capture "
'  result = DL.WaitForSequence("generic resp", 1, 48000)
'  DL.Pause 1000
'=============================================================
'  DL.AddComment "--- Clear Display"
'  DL.SendSequence " Clear Display"
'  result = DL.WaitForSequence("generic resp", 1, 3000)
'=============================================================
  DL.AddComment "--- Get signature text S"
  DL.SendSequence " Get signature text S"
  result = DL.WaitForSequence("generic resp", 1, 3000)
'============================================================
  DL.AddComment "--- signature capture (83-19) S"
  DL.SendSequence " signature capture (83-19) S"
  result = DL.WaitForSequence("Display Control OK", 1, 6000)
  DL.Pause 4000
'============================================================
'  DL.AddComment "--- Clear SigCap 83 1b"
'  DL.SendSequence "Clear SigCap 83 1b", ControlID, "H"
'  result = DL.WaitForSequence("generic resp", 1, 10000)
'  DL.Pause 2000
'============================================================
'  DL.AddComment "--- Get SigCap 83 1A"
'  DL.SendSequence " Get SigCap 83 1A", ControlID, "H"
'  result = DL.WaitForSequence("generic resp", 1, 10000)
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- Thanks for coming Subway S "
  DL.SendSequence "Thanks for coming Subway S "
  result = DL.WaitForSequence("generic resp", 1, 3000)
  DL.Pause 2000
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- display sw logo 2 imge png S "
  DL.SendSequence "display sw logo 2 imge png S "
  result = DL.WaitForSequence("generic resp", 1, 3000)
  DL.Pause 3000
'=============================================================
'If result <> 0 Then
  DL.Pause 500
  DL.ResetReceiveCounter
  DL.AddComment "--- Terminate secure session"
  DL.SendSequence " Terminate secure session"
  result = DL.WaitForSequence("generic resp ", 1, 10000)
'End If
DL.Pause 1000

'=============================================================
     DL.AddComment "get free mem size"
     DL.ResetReceiveCounter
     DL.SendSequence "", "56 69 56 4F 74 65 63 68 32 00 82 04 00 00 77 88", "H"
     result = DL.WaitForSequence("Get Mem Resp", 1, 15000)
'--------------------------------------------------------------

End If 'end of proj

'=======================================================================
' run proj buzz LED, get mem, ping, get version, default param
' get param, set BC, cancel tran, Reset to Init state & PING-PONG
' Poll on demand, burst mode Auto
' (01-02 82-04 ,18-01, 09-20, 05-01, 04-09, 83-01,04-00, 03-02, 01-01,)
'=======================================================================
result = 1
runProj = runIt
If runProj <> 0 Then
  StartProj("sysCommon")

'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- Ping"
  DL.SendSequence "Ping"
  result = DL.WaitForSequence("Ping Resp", 1, 10000)
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- One beep with LED All On"
  DL.SendSequence "One beep with LED All On"
  result = DL.WaitForSequence("buzzLed Resp", 1, 10000)
  DL.Pause 2000
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- Double beep with All LED Off"
  DL.SendSequence "Double beep with All LED Off"
  result = DL.WaitForSequence("buzzLed Resp", 1, 10000)
  DL.Pause 2000
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- Three short beep with LED 1 On"
  DL.SendSequence "Three short beep with LED 1 On"
  result = DL.WaitForSequence("buzzLed Resp", 1, 10000)
  DL.Pause 2000
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- Four short beep with LED 3 On"
  DL.SendSequence "Four short beep with LED 3 On"
  result = DL.WaitForSequence("buzzLed Resp", 1, 10000)
  DL.Pause 2000
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- Get AR Module Versions"
  DL.SendSequence "Get AR Module Versions"
  result = DL.WaitForSequence("get module version Resp", 1, 10000)
  DL.Pause 1000
'============================================================
'  DL.ResetReceiveCounter
'  DL.AddComment "--- Reset to Initial State (83-01)"
'  DL.SendSequence "Reset to Initial State (83-01)"
'  result = DL.WaitForSequence("83-xx generic resp", 1, 10000)
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- Set Param to Default (04-09)"
  DL.SendSequence "Set Param to Default (04-09)"
  result = DL.WaitForSequence("04-xx generic resp", 1, 10000)
'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- Get Params (03-02)"
  DL.SendSequence "Get Params (03-02)"
  result = DL.WaitForSequence("03-xx generic resp", 1, 10000)
'============================================================
If BC_Enabled <> 0 Then

  DL.ResetReceiveCounter
  DL.AddComment "--- Poll on Demand"
  DL.SendSequence "Poll on Demand"
  result = DL.WaitForSequence("01-xx generic resp", 1, 10000)

  DL.ResetReceiveCounter
  DL.AddComment "--- Burst Auto"
  DL.SendSequence "Burst Auto"
  result = DL.WaitForSequence("04-xx generic resp", 1, 10000)

  DL.ResetReceiveCounter
  DL.AddComment "--- Disable Backwards Compatibility"
  DL.SendSequence "Disable Backwards Compatibility"
  result = DL.WaitForSequence("04-xx generic resp", 1, 10000)
  BC_Enabled = 0
Else
  DL.ResetReceiveCounter
  DL.AddComment "--- Enable Backwards Compatibility"
  DL.SendSequence "Enable Backwards Compatibility"
  result = DL.WaitForSequence("04-xx generic resp", 1, 10000)
  BC_Enabled = 1
End If

'============================================================
  DL.ResetReceiveCounter
  DL.AddComment "--- Get memory"
  DL.SendSequence "Get memory"
  result = DL.WaitForSequence("Get Mem Resp", 1, 10000)
  DL.Pause 1000
  
  DL.AddComment "--- PING the reader and Wait for PONG"
  DL.SendSequence "PING-PONG"
  result = DL.WaitForSequence("PONG Resp", 1, 5000)
  DL.Pause 1000

  DL.AddComment "--- Cancel Transactions (05-01)"
  DL.SendSequence "Cancel Transactions (05-01)"
  result = DL.WaitForSequence("Cancel Transaction Resp", 1, 5000)
  DL.Pause 1000

  DL.AddComment "--- Check Master Key Present (80-02)"
  DL.SendSequence "Check Master Key Present (80-02)"
  result = DL.WaitForSequence("Check Master Key Present Resp", 1, 5000)
  DL.Pause 1000

End If 'end of proj

'=======================================================================
' run proj CA Key management (D0-21,D0-22,D0-23,D0-24,D0-25,D0-26,D0-27)
'=======================================================================
result = 1
runProj = runIt
If runProj <> 0 Then
  ' StartProj("C:\vivotech\regress\regression\regress_test\test_tree\8xxx_Set_CA_Key\KME036\KME036")
  StartProj("KME036-LP")

If result <> 0 Then
  DL.Pause 400
  DL.AddComment "DeleteAllKeys"
  DL.SendSequence " DeleteAllKeys"
  result = DL.WaitForSequence("Successful Command", 1, 10000)
End If
If result <> 0 Then
  DL.ResetReceiveCounter
  DL.Pause 400
  DL.AddComment "Set Key F5 Contactless 01"
  DL.SendSequence " Set Key F5 Contactless 01"
  result = DL.WaitForSequence("Successful Command", 1, 10000)
End If
If result <> 0 Then
  DL.ResetReceiveCounter
  DL.Pause 400
  DL.AddComment "Set Key F5 Contact 02"
  DL.SendSequence " Set Key F5 Contact 02"
  result = DL.WaitForSequence("Successful Command", 1, 10000)
End If
If result <> 0 Then
  DL.ResetReceiveCounter
  DL.Pause 400
  DL.AddComment "Delete B0 Key Contact 02"
  DL.SendSequence " Delete B0 Key Contact 02"
  result = DL.WaitForSequence("Successful Command", 1, 10000)
End If

If result <> 0 Then
  DL.Pause 400
  DL.AddComment "Get B0 Key Contactless 01"
  DL.SendSequence "Get B0 Key Contactless 01"
  result = DL.WaitForSequence("Get B0 Key", 1, 10000)
End If
If result <> 0 Then
  DL.Pause 400
  DL.AddComment "Get B0 Hash Contactless 01"
  DL.SendSequence "Get B0 Hash Contactless 01"
  result = DL.WaitForSequence("Get B0 Hash", 1, 10000)
End If
If result <> 0 Then
  DL.Pause 400
  DL.AddComment "CA GetRids Contact 01"
  DL.SendSequence "CA GetRids Contactless 01"
  result = DL.WaitForSequence("Get BO Rids", 1, 10000)
End If
If result <> 0 Then
  DL.Pause 400
  DL.AddComment "Get Key IDs for B0 12 34 56 78 Contactless 01"
  DL.SendSequence "Get Key IDs for B0 12 34 56 78 Contactless 01"
  result = DL.WaitForSequence("Get B0 Key ID", 1, 10000)
End If
If result <> 0 Then
  DL.Pause 400
  DL.ResetReceiveCounter
  DL.AddComment "Get B0 Key Contactless 02"
  DL.SendSequence "Get B0 Key Contactless 02"
  result = DL.WaitForSequence("Key Not Found", 1, 10000)
End If
If result <> 0 Then
  DL.Pause 400
  DL.ResetReceiveCounter
  DL.AddComment "Get B0 Hash Contactless 02"
  DL.SendSequence "Get B0 Hash Contactless 02"
  result = DL.WaitForSequence("Key Not Found", 1, 10000)
End If
If result <> 0 Then
  DL.Pause 400
  DL.ResetReceiveCounter
  DL.AddComment "CA GetRids Contact 02"
  DL.SendSequence "CA GetRids Contact 02"
  result = DL.WaitForSequence("Key Not Found", 1, 10000)
End If
If result <> 0 Then
  DL.Pause 400
  DL.ResetReceiveCounter
  DL.AddComment "Get Key IDs for B0 12 34 56 78 Contact 02"
  DL.SendSequence "Get Key IDs for B0 12 34 56 78 Contact 02"
  result = DL.WaitForSequence("Key Not Found", 1, 10000)
End If

End If 'end of proj
'=======================================================================
' run proj KLK2 (80-xx, 81-01)
'=======================================================================
result = 1
runProj = runIt
If runProj <> 0 Then
  StartProj("KLK2-01-LP")
'============================================================
If result <> 0 Then
  DL.AddComment "--- Delete KLK Keys"
  DL.SendSequence " Delete KLK Keys"
  result = DL.WaitForSequence("No KLK Response", 1, 30000)
End If
'============================================================
If result <> 0 Then
  DL.ResetReceiveCounter "Load KLK Response"
  DL.AddComment "--- Load KLK 1"
  DL.SendSequence " Load KLK 1"
  result = DL.WaitForSequence("Load KLK Response", 1, 30000)
End If
'============================================================
DL.ResetReceiveCounter "Load KLK Response"
If result <> 0 Then
  DL.ResetReceiveCounter "Load KLK Response"
  DL.AddComment "--- Load KLK 2"
  DL.SendSequence " Load KLK 2"
  result = DL.WaitForSequence("Load KLK Response", 1, 30000)
End If
'============================================================
DL.ResetReceiveCounter "Load KLK Response"
If result <> 0 Then
  DL.ResetReceiveCounter "Load KLK Response"
  DL.AddComment "--- Load KLK 3"
  DL.SendSequence " Load KLK 3"
  result = DL.WaitForSequence("Load KLK Response", 1, 30000)
End If
'============================================================
If result <> 0 Then
  DL.ResetReceiveCounter  
  DL.AddComment "--- Load master key"
  DL.SendSequence " Load master key"
  result = DL.WaitForSequence("Load KLK Response", 1, 10000)
  DL.Pause 1000
End If
'============================================================
If result <> 0 Then
  DL.ResetReceiveCounter
  DL.AddComment "--- DUKPT PIN Entry with no DUKPT"
  DL.SendSequence " DUKPT PIN Entry with no DUKPT"
  resultIgnore = DL.WaitForSequence("DUKPT Response", 1, 11000)
End If
'============================================================
If result <> 0 Then
  DL.ResetReceiveCounter
  DL.AddComment "--- Load DUKPT key"
  DL.SendSequence " Load DUKPT key"
  result = DL.WaitForSequence("DUKPT Response", 1, 10000)
  DL.Pause 1000
End If
'============================================================
If result <> 0 Then
  DL.ResetReceiveCounter
  DL.AddComment "--- Check master keys"
  DL.SendSequence " Check master keys"
  result = DL.WaitForSequence("Master Session Response", 1, 10000)
  DL.Pause 1000
End If
'============================================================
If result <> 0 Then
  DL.ResetReceiveCounter
  DL.AddComment "--- Get DUKPT PIN"
  DL.SendSequence " Get DUKPT PIN"
  resulIgnore = DL.WaitForSequence("DUKPT Response", 1, 11000)
  DL.Pause 3000
End If
'============================================================
If result <> 0 Then
  DL.ResetReceiveCounter
  DL.AddComment "--- Select master key"
  DL.SendSequence " Select master key"
  result = DL.WaitForSequence("Master Session Response", 1, 10000)
  DL.Pause 1000
End If
'============================================================
If result <> 0 Then
  DL.ResetReceiveCounter  
  DL.AddComment "--- Master Session Pin Entry"
  DL.SendSequence " Master Session Pin Entry"
  resultIgnore = DL.WaitForSequence("Master Session Response", 1, 11000)
End If
  DL.Pause 3000

'============================================================
If result <> 0 Then
  DL.ResetReceiveCounter
  DL.AddComment "--- Return Master key"
  DL.SendSequence " Return Master key"
  result = DL.WaitForSequence("Master Session Response", 1, 10000)
End If
'============================================================
If result <> 0 Then
  DL.ResetReceiveCounter  
  DL.AddComment "--- Read Valid Key Mask"
  DL.SendSequence " Read Valid Key Mask"
  result = DL.WaitForSequence("Master Session Response", 1, 10000)
End If

End If 'end of proj

'=======================================================================
' run proj secure_mode (80-xx)
'=======================================================================
result = 1
runProj = runIt
If runProj <> 0 Then
  ' StartProj("C:\vivotech\regress\regression\regress_test\test_tree\8xxx_Secure_mode\SECM001\SECM001")
  StartProj("SECM001-LP")

If result <> 0 Then
  DL.AddComment "--- Delete Key"
  DL.SendSequence " Delete Key"
  result = DL.WaitForSequence("Load Key Response", 1, 10000)
End If
'============================================================
If result <> 0 Then
  DL.Pause 500
  DL.ResetReceiveCounter
  DL.AddComment "--- Set Unecrypted KLK"
  DL.SendSequence " Set Unecrypted KLK"
  result = DL.WaitForSequence("Secure Mode Response", 1, 10000)
End If
'============================================================
If result <> 0 Then
  DL.Pause 500
  DL.ResetReceiveCounter
  DL.AddComment "--- Set Unecrypted KLK 2"
  DL.SendSequence " Set Unecrypted KLK 2"
  result = DL.WaitForSequence("Secure Mode Response", 1, 10000)
End If
'============================================================
If result <> 0 Then
  DL.Pause 500
  DL.ResetReceiveCounter
  DL.AddComment "--- Ecrypted KLK"
  DL.SendSequence " Ecrypted KLK"
  result = DL.WaitForSequence("Secure Mode Response", 1, 10000)
End If
'============================================================
If result <> 0 Then
  DL.Pause 500
  DL.ResetReceiveCounter
  DL.AddComment "--- Master Session Index 9"
  DL.SendSequence " Master Session Index 9"
  result = DL.WaitForSequence("Secure Mode Response", 1, 10000)
End If
'============================================================
If result <> 0 Then
  DL.Pause 500
  DL.ResetReceiveCounter
  DL.AddComment "--- Load Duk"
  DL.SendSequence " Load Duk"
  result = DL.WaitForSequence("Load Duk Response", 1, 10000)
End If
'============================================================
If result <> 0 Then
  DL.Pause 500
  DL.ResetReceiveCounter
  DL.AddComment "--- Load secure session key"
  DL.SendSequence " Load secure session key"
  result = DL.WaitForSequence("Secure Mode Response", 1, 10000)
End If
'============================================================
If result <> 0 Then
  DL.Pause 500
  DL.ResetReceiveCounter
  DL.AddComment "--- Start secure session"
  DL.SendSequence " Start secure session"
  result = DL.WaitForSequence("Secure Mode Response", 1, 10000)
End If
'============================================================
If result <> 0 Then
  DL.ResetReceiveCounter
  DL.AddComment "--- Beep:"
  DL.SendSequence " Beep:"
  result = DL.WaitForSequence("Beep Response", 1, 10000)
End If
'============================================================
If result <> 0 Then
  DL.ResetReceiveCounter
  DL.AddComment "---Display welcome in center (encrypted)"
  DL.SendSequence " Display welcome in center (encrypted)"
  result = DL.WaitForSequence("Display Welcome", 1, 10000)
End If
'============================================================
If result <> 0 Then
  DL.ResetReceiveCounter
  DL.AddComment "---Terminate secure session"
  DL.SendSequence " Terminate secure session"
  result = DL.WaitForSequence("Secure Mode Response", 1, 10000)
End If
'============================================================

End If 'end of proj

'=======================================================================
' run proj set-get params (03-02,03-04,03-05,03-06,03-07)
' (04-00,04-02,04-03,04-04,04-05,04-09,09-20
'=======================================================================
result = 1
runProj = runIt
If runProj <> 0 Then
  StartProj("PARAM-01-LP")

'============================================================
If result <> 0 Then
  DL.ResetReceiveCounter
  DL.AddComment "--- GET ALL AIDS Success"
  DL.SendSequence "Get all AIDs"
  result = DL.WaitForSequence("Response Get All Groups", 1, 10000)
End If
'============================================================
If result <> 0 Then
  DL.Pause 400
  DL.ResetReceiveCounter
  DL.AddComment "--- AMEX AID"
  DL.SendSequence "Amex AID"
  result = DL.WaitForSequence("Response Data", 1, 10000)
End If
'------------------------------------------------------------
If result <> 0 Then
DL.Pause 300
  DL.ResetReceiveCounter
  DL.AddComment "--- Default set Parameters"
  DL.SendSequence " Default set Parameters"
  result = DL.WaitForSequence("Set Parameter Response", 1, 10000)
End If
'------------------------------------------------------------
If result <> 0 Then
DL.Pause 300
  DL.ResetReceiveCounter
  DL.AddComment "--- Get Default Parameters"
  DL.SendSequence " Get Default Parameters"
  result = DL.WaitForSequence("Get Parameter Default Response", 1, 10000)
End If
'============================================================
If result <> 0 Then
  DL.ResetReceiveCounter
  DL.AddComment "--- Delete Group ID Failed as expected"
  DL.SendSequence "Delete Group ID 0"
  result = DL.WaitForSequence("Response Delete Group ID 0", 1, 10000)
End If
'============================================================
If result <> 0 Then
  DL.ResetReceiveCounter
  DL.AddComment "--- Create User AID Failed as Expected"
  DL.SendSequence "Create User AID in Non-Exising Group"
  result = DL.WaitForSequence("Create User AID in Non-Exising Group Response", 1, 10000)
End If
'============================================================
If result <> 0 Then
  DL.ResetReceiveCounter
  DL.AddComment "--- Create Group Successful"
  DL.SendSequence "Create Group 2"
  result = DL.WaitForSequence("Create group 2 response", 1, 10000)
End If
'------------------------------------------------------------
If result <> 0 Then
  DL.ResetReceiveCounter
  DL.AddComment "--- Check Successful"
  DL.SendSequence "check group 2"
  result = DL.WaitForSequence("check group 2 response", 1, 10000)
End If
'============================================================
If result <> 0 Then
  DL.ResetReceiveCounter
  DL.AddComment "--- Create AID 1 Successful"
  DL.SendSequence "Create AID 1"
  result = DL.WaitForSequence("Create AID Response", 1, 10000)
End If
'============================================================
If result <> 0 Then
DL.Pause 1000
  DL.ResetReceiveCounter
  DL.AddComment "--- Delete AID 1"
  DL.SendSequence "Delete AID 1"
  result = DL.WaitForSequence("Delete AID Response", 1, 10000)
End If
'------------------------------------------------------------
If result <> 0 Then
  DL.ResetReceiveCounter
  DL.AddComment "--- get all groups"
  DL.SendSequence "get all groups"
  result = DL.WaitForSequence("get all group resp", 1, 10000)
End If
'------------------------------------------------------------
If result <> 0 Then
  DL.ResetReceiveCounter
  DL.AddComment "--- Set Default Param"
  DL.SendSequence "Set Default Param"
  result = DL.WaitForSequence("Create AID Response", 1, 10000)
End If
DL.Pause 2000
'------------------------------------------------------------
End If 'end of proj

'=======================================================================
' run proj active transaction (02-01, 02-20,02-11,02-15,02-05 )
'=======================================================================
result = 1
runProj = runIt
If runProj <> 0 Then
  ' StartProj("C:\vivotech\regress\regression\regress_test\test_tree\8xxx_Special_Transactions\SAT019\SAT019")
  StartProj("SAT019-LP")
'========================================================
' cmd 02-21
'========================================================
If result <> 0 Then
  DL.AddComment "--- Activate Transaction (02-01)"
  DL.SendSequence " Activate Transaction (02-01)"
  resultIgnore = DL.WaitForSequence("83 Response", 1, 11000)
  DL.Pause 2000
End If

'========================================================
' cmd 02-20
'========================================================
If result <> 0 Then
  DL.AddComment "--- UI EVENT CLEAR"
  DL.SendSequence " UI EVENT CLEAR"
  result = DL.WaitForSequence("83 Response", 1, 10000)
End If

'------------------------------------------------------------
If result <> 0 Then
  DL.AddComment "--- Enhanced Activate Transaction Command (02-20)"
  DL.SendSequence " Enhanced Activate Transaction Command (02-20)"
  resultIgnore = DL.WaitForSequence("Activate 02 Response", 1, 11000)
End If

'------------------------------------------------------------
If result <> 0 Then
  DL.Pause 500
  DL.AddComment "--- Get Input Event"
  DL.SendSequence " Get Input Event"
  resultIgnore = DL.WaitForSequence("Input Response", 1, 2000)
End If

'------------------------------------------------------------
If result <> 0 Then
  DL.AddComment "--- Get Transaction Result (03-00)"
  DL.SendSequence " Get Transaction Result (03-00)"
  resultIgnore = DL.WaitForSequence("Get Transaction Response", 1, 3000)
End If
DL.Pause 5000
'==============================================================
' cmd 02-11
'==============================================================
'------------------------------------------------------------
If result <> 0 Then
  DL.AddComment "--- UI EVENT CLEAR"
  DL.SendSequence " UI EVENT CLEAR"
  result = DL.WaitForSequence("83 Response", 1, 3000)
End If

'------------------------------------------------------------
If result <> 0 Then
  DL.AddComment "--- Activate Transaction Event (02-11)"
  DL.SendSequence " Activate Transaction Event (02-11)"
  resultIgnore = DL.WaitForSequence("Activate 02 Response", 1, 11000)
End If
'------------------------------------------------------------
If result <> 0 Then
  DL.Pause 500
  DL.AddComment "--- Get Input Event"
  DL.SendSequence " Get Input Event"
  resultIgnore = DL.WaitForSequence("Input Response", 1, 2000)
End If
'------------------------------------------------------------
If result <> 0 Then
  DL.AddComment "--- Get Transaction Result (03-00)"
  DL.SendSequence " Get Transaction Result (03-00)"
  resultIgnore = DL.WaitForSequence("Get Transaction Response", 1, 3000)
End If
DL.Pause 5000
'=====================================================
' cmd 02-15
'=====================================================
'------------------------------------------------------------
If result <> 0 Then
  DL.AddComment "--- UI EVENT CLEAR"
  DL.SendSequence " UI EVENT CLEAR"
  result = DL.WaitForSequence("83 Response", 1, 10000)
End If
'------------------------------------------------------------
If result <> 0 Then
  DL.Pause 500
  DL.AddComment "--- Activate Transaction Event with Data Encryption (02-15) Track 1"
  DL.SendSequence " Activate Transaction Event with Data Encryption (02-15) Track 1"
  resultIgnore = DL.WaitForSequence("Activate 02 Response", 1, 11000)
End If
'------------------------------------------------------------
If result <> 0 Then
  DL.Pause 500
  DL.AddComment "--- Get Input Event"
  DL.SendSequence " Get Input Event"
  resultIgnore = DL.WaitForSequence("Input Response", 1, 2000)
End If
'------------------------------------------------------------
If result <> 0 Then
  DL.Pause 500
  DL.AddComment "--- Get Transaction Result (03-00)"
  DL.SendSequence " Get Transaction Result (03-00)"
  resultIgnore = DL.WaitForSequence("Track 1 Encrypt", 1, 3000)
End If
DL.Pause 5000
'=======================================================
' cmd 02-05
'=======================================================
'------------------------------------------------------------
If result <> 0 Then
  DL.AddComment "--- UI EVENT CLEAR"
  DL.SendSequence " UI EVENT CLEAR"
  result = DL.WaitForSequence("83 Response", 1, 10000)
End If
'------------------------------------------------------------
If result <> 0 Then
  DL.AddComment "---Activate Transaction Data Encryption (02-05) Track 1 "
  DL.SendSequence " Activate Transaction Data Encryption (02-05) Track 1 "
  resultIgnore = DL.WaitForSequence("Track 1 Encryption 2c 05 Response", 1, 11000)
End If
DL.Pause 5000

End If 'end of proj
'=======================================================================
' run proj pass through (2c-01,2c-02,0a-02,0b-01,0b-02, 28-01)
' (18-01)
'=======================================================================
result = 1
runProj = runIt
If runProj <> 0 Then
  StartProj("PassThroughTest-LP")
'------------------------------------------------------------
If result <> 0 Then
  DL.ResetReceiveCounter
  DL.AddComment "--- Enable Pass Through"
  DL.SendSequence "Enable Pass Through"
  result = DL.WaitForSequence("Pass-Through - START and STOP (OK)", 1, 10000)
End If
'------------------------------------------------------------
If result <> 0 Then
  DL.ResetReceiveCounter
  DL.AddComment "--- Enable Antenna"
  DL.SendSequence "Enable Antenna"
  result = DL.WaitForSequence("Antenna Disabled (OK)", 1, 10000)
End If
'------------------------------------------------------------
If result <> 0 Then
  DL.ResetReceiveCounter
  DL.AddComment "--- Disable Antenna"
  DL.SendSequence "Disable Antenna"
  result = DL.WaitForSequence("Antenna Disabled (OK)", 1, 10000)
End If

'------------------------------------------------------------
If result <> 0 Then
  DL.ResetReceiveCounter
  DL.AddComment "--- Control LED"
  DL.SendSequence "Control LED"
  result = DL.WaitForSequence("Control LED OK", 1, 10000)
End If
DL.Pause 2000
'------------------------------------------------------------
If result <> 0 Then
  DL.ResetReceiveCounter
  DL.AddComment "--- Control Buzzer Short"
  DL.SendSequence "Control Buzzer Short"
  result = DL.WaitForSequence("Control Buzzer OK", 1, 10000)
End If
'------------------------------------------------------------
If result <> 0 Then
  DL.ResetReceiveCounter
  DL.AddComment "--- Control Buzzer Long"
  DL.SendSequence "Control Buzzer Long"
  result = DL.WaitForSequence("Control Buzzer OK", 1, 10000)
End If
'------------------------------------------------------------
If result <> 0 Then
  DL.ResetReceiveCounter
  DL.AddComment "--- Poll for Token (10 Seconds)"
  DL.SendSequence "Poll for Token (10 Seconds)"
  resultIgnore = DL.WaitForSequence("Poll for Token (10 Seconds) (OK)", 1, 12000)
End If
'------------------------------------------------------------
If result <> 0 Then
  DL.ResetReceiveCounter
  DL.AddComment "--- Pass-Through - STOP"
  DL.SendSequence "Pass-Through - STOP"
  result = DL.WaitForSequence("Pass-Through - START and STOP (OK)", 1, 10000)
End If
If result <> 0 Then
  DL.ResetReceiveCounter
  DL.AddComment "--- Ping reader"
  DL.SendSequence "Ping reader"
  result = DL.WaitForSequence("Ping resp", 1, 10000)
End If

End If 'end of proj
'================================================================
' run test proj mifare card (cmd 2c-06, 2c-07, 2c-08, 2c-0a)
' use Mifare test card 308-001 or 002
'================================================================
result = 1
runProj = runIt
If runProj <> 0 Then
  StartProj("PUR001-LP")

	DL.AddComment vbCrLf & "--- Start PT Mode" 
	DL.SendSequence "Start PT Mode"
	result = DL.WaitForSequence ("PT Command (OK)", 1, 5000)
	DL.ResetReceiveCounter "PT Command (OK)"

	DL.AddComment vbCrLf & "--- Turn On Antenna"
	DL.SendSequence "Turn On Antenna"
	result = DL.WaitForSequence ("Turn On Antenna (OK)", 1, 5000)

	DL.AddComment vbCrLf & "--- Poll for Token" 
	DL.SendSequence "Poll for Token"
	resultIgnore = DL.WaitForSequence ("Poll for Token (OK)", 1, 12000)
	
	DL.AddComment vbCrLf & "--- Authenticate Block 10h = 16d" 
	DL.SendSequence "Authenticate Block 10h = 16d"
	resultIgnore = DL.WaitForSequence ("PT Command (OK)", 1, 5000)
      DL.ResetReceiveCounter

	DL.AddComment vbCrLf & "--- Initialize Blocks" 
	DL.SendSequence "Initialize Blocks"
	resultIgnore = DL.WaitForSequence ("PT Command (OK)", 1, 5000)
	DL.ResetReceiveCounter "PT Command (OK)"

	DL.AddComment vbCrLf & "--- Read 3 Initialized Blocks" 
	DL.SendSequence "Read 3 Initialized Blocks"
	resultIgnore = DL.WaitForSequence ("Read Initialized Blocks (OK)", 1, 5000)
	DL.ResetReceiveCounter "Read Initialized Blocks (OK)"
	

	DL.AddComment vbCrLf & "========== TEST1 =============================================="	& vbCrLf
	DL.AddComment vbCrLf & "--- Decrement Block *Original - minus 1 @ block 16 without BACKUP - Define 1 send 1"
	DL.SendSequence "Decrement Block *Original - minus 1 @ block 16 without BACKUP - Define 1 send 1"
	resultIgnore = DL.WaitForSequence ("PT Command (OK)", 1, 5000)
	'PrintMyResult(result)
	DL.ResetReceiveCounter "PT Command (OK)"

	DL.AddComment vbCrLf & "--- Increment Block *Original - plus 1 @ block 16 without BACKUP - Define 1 send 1"
	DL.SendSequence "Increment Block *Original - plus 1 @ block 16 without BACKUP - Define 1 send 1"
	resultIgnore = DL.WaitForSequence ("PT Command (OK)", 1, 5000)
	'PrintMyResult(result)
	DL.ResetReceiveCounter "PT Command (OK)"

	DL.AddComment vbCrLf & "--- Read Blocks 3 again"
	DL.SendSequence "Read 3 Blocks again"
	resultIgnore = DL.WaitForSequence ("Read Initialized Blocks (OK)", 1, 5000)
	'PrintMyResult(result)

	DL.AddComment vbCrLf & "--- Stop PT Mode" 
	DL.SendSequence "Stop PT Mode"
	result = DL.WaitForSequence ("PT Command (OK)", 1, 5000)
	DL.ResetReceiveCounter "PT Command (OK)"


End If 'end of proj
'================================================================
' run test proj PCD exchange (cmd 2c-10)
' use payPass A test card
'================================================================
result = 1
runProj = runIt
If runProj <> 0 Then
  ' StartProj("C:\vivotech\regress\regression\regress_test\test_tree\8xxx_PCD\APCD001\APCD001")
  StartProj("APCD001-LP")

If result <> 0 Then
  DL.AddComment "--- EMV:2C - Start PT Mode"
  DL.SendSequence " EMV:2C - Start PT Mode"
  result = DL.WaitForSequence("PassT Cmds Response", 1, 10000)
End If
'============================================================
'If result <> 0 Then
'   prompt2 = prompt2 & "Place PayPass Type A Card. When ready click on OK"
'   result = MsgBox(prompt2, VBOKOnly, "Advanced Activate Transaction")
'End If

'------------------------------------------------------------
If result <> 0 Then
  DL.AddComment "--- PCD Single Cmd Xchg 8XXX - WUPA"
  DL.SendSequence " PCD Single Cmd Xchg 8XXX - WUPA"
  resultIgnore = DL.WaitForSequence("WUPA Response", 1, 11000)
End If

'------------------------------------------------------------
If result <> 0 Then
  DL.AddComment "--- EMV:2C - Stop Passthru"
  DL.SendSequence " EMV:2C - Stop Passthru"
  result = DL.WaitForSequence("PassT Cmds Response", 1, 10000)
End If
'============================================================

End If 'end of proj
'================================================================
' run test proj pass through (cmd 2c-11, 2c-13)
'================================================================
result = 1
runProj = runIt
If runProj <> 0 Then
  ' StartProj("C:\vivotech\regress\regression\regress_test\test_tree\SAM_Passthrough\SPT001\SPT001")
  StartProj("SPT001-LP")

If result <> 0 Then
  DL.AddComment "---Start Passthrough Mode"
  DL.SendSequence " Start Passthrough Mode"
  result = DL.WaitForSequence("Version 2 Protocol: Response (Status=OK)", 1, 10000)
End If
'============================================================
'If result <> 0 Then
'   prompt2 = prompt2 & "Insert Contact Visa Test Card. When ready click on OK"
'   result = MsgBox(prompt2, VBOKOnly, "Advanced PassThrough")
'End If

'------------------------------------------------------------
'If result <> 0 Then
'  DL.ResetReceiveCounter
'  DL.AddComment "--- Enhanced PT - Poll for Token - ICC (Tout=32s)"
'  DL.SendSequence " Enhanced PT - Poll for Token - ICC (Tout=32s)"
'  resultIgnore = DL.WaitForSequence("Version 2 Protocol: Response (Status=OK)", 1, 12000)
'End If

'------------------------------------------------------------

If result <> 0 Then
  DL.ResetReceiveCounter
  DL.AddComment "--- Exchange APDU with ICC (Select PSE)"
  DL.SendSequence " Exchange APDU with ICC (Select PSE)"
  resultIgnore = DL.WaitForSequence("Version 2 Protocol: Response (Status=OK)", 1, 12000)
End If
'------------------------------------------------------------
If result <> 0 Then
  DL.ResetReceiveCounter
  DL.AddComment "--- Exchange APDU with ICC (Select Visa)"
  DL.SendSequence " Exchange APDU with ICC (Select Visa)"
  resultIgnore = DL.WaitForSequence("Version 2 Protocol: Response (Status=OK)", 1, 12000)
End If
'------------------------------------------------------------
If result <> 0 Then
  DL.Pause 500
  DL.ResetReceiveCounter
  DL.AddComment "--- Enhanced PT - Deactivate - ICC"
  DL.SendSequence " Enhanced PT - Deactivate - ICC"
  resultIgnore = DL.WaitForSequence("Version 2 Protocol: Response (Status=OK)", 1, 12000)
End If

'------------------------------------------------------------
If result <> 0 Then
  DL.ResetReceiveCounter
  DL.AddComment "--- Stop Passthrough Mode"
  DL.SendSequence " Stop Passthrough Mode"
  result = DL.WaitForSequence("Version 2 Protocol: Response (Status=OK)", 1, 10000)
End If
'------------------------------------------------------------

End If 'end of proj
'================================================================
' run test proj pass through (cmd 2c-11, 2c-12)
'================================================================
result = 1
runProj = runIt
If runProj <> 0 Then
  ' StartProj("C:\vivotech\regress\regression\regress_test\test_tree\SAM_Passthrough\SPT004\SPT004")
  StartProj("SPT004-LP")

If result <> 0 Then
  DL.AddComment "---Start Passthrough Mode"
  DL.SendSequence " Start Passthrough Mode"
  result = DL.WaitForSequence("Version 2 Protocol: Response (Status=OK)", 1, 10000)
End If
'============================================================
'If result <> 0 Then
'   prompt2 = prompt2 & "Insert Contact card Visa Test Card. When ready click on OK"
'   result = MsgBox(prompt2, VBOKOnly, "Advanced PassThrough")
'End If

'------------------------------------------------------------
If result <> 0 Then
  DL.ResetReceiveCounter
  DL.AddComment "--- Enhanced PT - Poll for Token - ICC (Tout=32s)"
  DL.SendSequence " Enhanced PT - Poll for Token - ICC (Tout=32s)"
  resultIgnore = DL.WaitForSequence("Version 2 Protocol: Response (Status=OK)", 1, 33000)
End If

'------------------------------------------------------------
If result <> 0 Then
  DL.ResetReceiveCounter
  DL.AddComment "--- Enhanced PT - Get ATR - ICC"
  DL.SendSequence " Enhanced PT - Get ATR - ICC"
  resultIgnore = DL.WaitForSequence("Version 2 Protocol: Response (Status=OK)", 1, 5000)
End If
'------------------------------------------------------------
If result <> 0 Then
  DL.ResetReceiveCounter
  DL.AddComment "--- Enhanced PT - Deactivate - ICC"
  DL.SendSequence " Enhanced PT - Deactivate - ICC"
  resultIgnore = DL.WaitForSequence("Version 2 Protocol: Response (Status=OK)", 1, 5000)
End If
'------------------------------------------------------------

If result <> 0 Then
  DL.ResetReceiveCounter
  DL.AddComment "--- Stop Passthrough Mode"
  DL.SendSequence " Stop Passthrough Mode"
  result = DL.WaitForSequence("Version 2 Protocol: Response (Status=OK)", 1, 10000)
End If

End If 'end of proj


'=============================================
' run proj get signature (cmd 83-02) 
'=============================================
result = 1
runProj = runIt
If runProj <> 0 Then
  ' StartProj ("C:\vivotech\regress\regression\regress_test\test_tree\Signature_Capture\SC001\SC001")
  StartProj ("SC001-LP")
  
  DL.AddComment "--- Signature capture 1"
  DL.SendSequence " Capture and verify signature (PNG)"
  result = DL.WaitForSequence("Signature Response", 1, 11000)
  
  DL.Pause 3000

  ' DL.AddComment "--- Welcome"
  ' DL.SendSequence " Welcome"
  ' result = DL.WaitForSequence("Welcome Response", 1, 10000)
  ' PrintMyResult(result)
End If 'end of proj

'=============================================
' run proj get signature (cmd 83-19, 83-1A, 83-1B) 
'=============================================
result = 1
runProj = runIt
If runProj <> 0 Then
  ' StartProj ("C:\vivotech\regress\regression\regress_test\test_tree\Signature_Capture\SC019\SC019")
  StartProj ("SC019-LP")

'=============================================================
  DL.AddComment "--- Clear Display"
  DL.SendSequence " Clear Display"
  result = DL.WaitForSequence("Signature Response", 1, 10000)
 
'============================================================
  DL.AddComment "--- Custom PNG 479x271"
  DL.SendSequence " Custom PNG 479x271"
  result = DL.WaitForSequence("Display Control OK", 1, 10000)
  DL.Pause 5000
'============================================================
  DL.AddComment "--- Clear SigCap 83 1b"
  DL.SendSequence "Clear SigCap 83 1b", ControlID, "H"
  result = DL.WaitForSequence("Signature Response", 1, 10000)
  DL.Pause 2000
'============================================================
  DL.AddComment "--- Get SigCap 83 1A"
  DL.SendSequence " Get SigCap 83 1A", ControlID, "H"
  result = DL.WaitForSequence("Signature Response", 1, 10000)
  
End If 'end of proj

'=============================================
' run proj replace amount (cmd 83-04 and 83-17) 
'=============================================
result = 1
runProj = runIt
If runProj <> 0 Then
  ' StartProj ("C:\vivotech\regress\regression\regress_test\test_tree\Amount_prompt\AMT002\AMT002")
  StartProj ("AMT002-LP")
If result <> 0 Then
  DL.ResetReceiveCounter
  DL.AddComment "--- Clear Display"
  DL.SendSequence "Clear Display"
  result = DL.WaitForSequence ("Display CUSTOM MODE OK", 1,3000)
End If
'------------------------------------------------------------
If result <> 0 Then
  DL.ResetReceiveCounter
  DL.AddComment "--- Disable Custom Display Mode"
  DL.SendSequence "Disable Custom Display Mode"
  result = DL.WaitForSequence ("Display CUSTOM MODE OK", 1,3000)
End If
'------------------------------------------------------------
If result <> 0 Then
  DL.ResetReceiveCounter
  DL.AddComment "--- VP8100: Display Amount $55.66 - Line 1"
  DL.SendSequence "VP8100: Display Amount $55.66 - Line 1"
  result = DL.WaitForSequence ("Display Control OK", 1,3000)
  DL.Pause 5000
  DL.SendSequence "VP8100: Change Amount - Line 1 - Part 1", ControlID, "H"
  result = DL.WaitForSequence ("Display Control OK ", 1,3000)
End If
  

End If 'end of proj
'===========================================================================
' run proj amount display & LED + Buzzer (83-04, 01-02, 83-0D, 83-08, 83-09)
'===========================================================================
result = 1
runProj = runIt
If runProj <> 0 Then
 
 StartProj ("AMTLoop")

'--- display amount page 1 ----
If result <> 0 Then
  DL.ResetReceiveCounter
  DL.AddComment "--- Clear Display"
  DL.SendSequence "Clear Display"
  result = DL.WaitForSequence ("Display CUSTOM MODE OK", 1,3000)
End If
'------------------------------------------------------------
If result <> 0 Then
  DL.ResetReceiveCounter
  DL.AddComment "--- Enable Custom Display Mode"
  DL.SendSequence "Enable Custom Display Mode"
  result = DL.WaitForSequence ("Display CUSTOM MODE OK", 1,3000)
End If
'------------------------------------------------------------
For I = 1 To 9
If result <> 0 Then
  DL.ResetReceiveCounter
  DL.AddComment "--- Display Amount w/ font " & I
  DL.SendSequence "Display Amount w/ font " & I
  result = DL.WaitForSequence ("Display Amount OK resp", 1,3000)
End If
Next
'DL.Pause 5000

'--- LDEs and Buzzers ---

If result <> 0 Then
  DL.Pause 200
  DL.ResetReceiveCounter
  DL.AddComment "---Buzzer LED 1"
  DL.SendSequence " Buzzer LED 1"
  result = DL.WaitForSequence("LED Response", 1, 30000)
End If
If result <> 0 Then
  DL.Pause 200
  DL.ResetReceiveCounter
  DL.AddComment "---Buzzer LED 2"
  DL.SendSequence " Buzzer LED 2"
  result = DL.WaitForSequence("LED Response", 1, 30000)
End If

End If 'end of proj

'============================================================
' run proj display and change text  (83-03, 83-0D, 83-08, 83-09, 83-16)
'============================================================
result = 1
runProj = runIt
If runProj <> 0 Then

 ' StartProj("C:\vivotech\regress\regression\regress_test\test_tree\8xxx_Display_Text\DTX020\DTX020")
 StartProj("DTX020-LP")

If result <> 0 Then
  DL.ResetReceiveCounter "Display CUSTOM MODE OK"
  DL.AddComment vbCrLf & "--- Disable Custom Display Mode"
  DL.SendSequence "Disable CUSTOM Display MODE"
  result = DL.WaitForSequence ("Display Custom Mode OK", 1,3000)
End If
'------------------------------------------------------------
If result <> 0 Then
  DL.AddComment vbCrLf & "--- Clear Present Display."
  DL.SendSequence "Clear Display"
  result = DL.WaitForSequence ("Clear Display Resp", 1,3000)
End If
'------------------------------------------------------------
If result <> 0 Then
  'DL.Pause 3000
  DL.ResetReceiveCounter
  DL.AddComment vbCrLf & vbCrLf & "--- Send Display Text XY 01 message"
  DL.SendSequence "Display Text XY 01"
  result = DL.WaitForSequence ("Display Control OK", 1,3000)
  GID01 = ControlID
End If
If result <> 0 Then
  'DL.Pause 3000
  DL.ResetReceiveCounter
  DL.AddComment vbCrLf & vbCrLf & "--- Send Display Text XY 02 message"
  DL.SendSequence "Display Text XY 02"
  result = DL.WaitForSequence ("Display Control OK", 1,3000)
  GID02 = ControlID
End If
If result <> 0 Then
  'DL.Pause 3000
  DL.ResetReceiveCounter
  DL.AddComment vbCrLf & vbCrLf & "--- Send Display Text XY 03 message"
  DL.SendSequence "Display Text XY 03"
  result = DL.WaitForSequence ("Display Control OK", 1,3000)
  GID03 = ControlID
End If
'------------------------------------------------------------
If result <> 0 Then
  DL.Pause 3000
  DL.AddComment vbCrLf & vbCrLf & "--- Send Change Text Display"
  DL.SendSequence "Change Text Display", GID01, "H"
  result = DL.WaitForSequence ("List Directory OK", 1,3000)
End If
If result <> 0 Then
  DL.ResetReceiveCounter
  DL.AddComment vbCrLf & "--- Enable Custom Display Mode"
  DL.SendSequence "Enable CUSTOM Display MODE"
  result = DL.WaitForSequence ("Display Custom Mode OK", 1,3000)
End If

End If 'end of proj

'============================================================
' run proj display buttons (83-05, 83-0D, 83-0c)
'============================================================
result = 1
runProj = runIt
If runProj <> 0 Then

 'StartProj("C:\vivotech\regress\regression\regress_test\test_tree\8xxx_Buttons\BRB001\BRB001")
 StartProj("BRB001-LP")


'----------------------------------------------------------
  DL.ResetReceiveCounter
  DL.AddComment "--- Clear display"
  DL.SendSequence "Clear display"
  result = DL.WaitForSequence ("Clear display Response", 1,3000)
'------------------------------------------------------------
  If result <> 0 Then
  	DL.ResetReceiveCounter
  	DL.AddComment "--- Event queue clear"
  	DL.SendSequence "Event queue clear"
  	result = DL.WaitForSequence ("Clear display Response", 1,3000)
   End If

'------------------------------------------------------------
  If result <> 0 Then
  	DL.ResetReceiveCounter "Good Box Response"
  	DL.AddComment "--- 1,1 Done Button"
  	DL.SendSequence "1,1 Done Button"
  	result = DL.WaitForSequence ("Good Box Response", 1,3000)
  End If
'------------------------------------------------------------
  If result <> 0 Then
  	DL.ResetReceiveCounter "Good Box Response"
  	DL.AddComment "--- 1,2 Credit Button"
  	DL.SendSequence "1,2 Credit Button"
  	result = DL.WaitForSequence ("Good Box Response", 1,3000)
   End If
'------------------------------------------------------------
  If result <> 0 Then
  	DL.ResetReceiveCounter "Good Box Response"
  	DL.AddComment "--- 1,3 Debit Button"
  	DL.SendSequence "1,3 Debit Button"
  	result = DL.WaitForSequence ("Good Box Response", 1,3000)
  End If
'------------------------------------------------------------
  If result <> 0 Then
  	DL.ResetReceiveCounter "Good Box Response"
  	DL.AddComment "--- 1,4 Cancel Button"
  	DL.SendSequence "1,4 Cancel Button"
  	result = DL.WaitForSequence ("Good Box Response", 1,3000)
  End If
'------------------------------------------------------------
  If result <> 0 Then
  	DL.ResetReceiveCounter "Good Box Response"
  	DL.AddComment "--- 1,5 Clear Button"
  	DL.SendSequence "1,5 Clear Button"
  	result = DL.WaitForSequence ("Good Box Response", 1,3000)
  End If
'------------------------------------------------------------
  If result <> 0 Then
  	DL.ResetReceiveCounter "Good Box Response"
  	DL.AddComment "--- 2,1 Ok Button"
  	DL.SendSequence "2,1 Ok Button"
  	result = DL.WaitForSequence ("Good Box Response", 1,3000)
  End If
'------------------------------------------------------------
  If result <> 0 Then
  	DL.ResetReceiveCounter "Good Box Response"
  	DL.AddComment "--- 2,2 Yes Button"
  	DL.SendSequence "2,2 Yes Button"
  	result = DL.WaitForSequence ("Good Box Response", 1,3000)
  End If
'------------------------------------------------------------
  If result <> 0 Then
  	DL.ResetReceiveCounter "Good Box Response"
  	DL.AddComment "--- 2,3 NO Button"
  	DL.SendSequence "2,3 NO Button"
  	result = DL.WaitForSequence ("Good Box Response", 1,3000)
  End If
'------------------------------------------------------------
  If result <> 0 Then
  	DL.ResetReceiveCounter "Good Box Response"
  	DL.AddComment "--- 2,4 Loyalty Button"
  	DL.SendSequence "2,4 Loyalty Button"
  	result = DL.WaitForSequence ("Good Box Response", 1,3000)
  End If
'------------------------------------------------------------
  If result <> 0 Then
  	DL.ResetReceiveCounter "Good Box Response"
 	 DL.AddComment "--- 2,5 EBT Button"
  	DL.SendSequence "2,5 EBT Button"
  	result = DL.WaitForSequence ("Good Box Response", 1,3000)
  End If
'------------------------------------------------------------
  If result <> 0 Then
  	DL.ResetReceiveCounter "Good Box Response"
  	DL.AddComment "--- 3,1 Gift Card Button"
 	DL.SendSequence "3,1 Gift Card Button"
  	result = DL.WaitForSequence ("Good Box Response", 1,3000)
  End If
'------------------------------------------------------------
  If result <> 0 Then
  	DL.ResetReceiveCounter "Good Box Response"
  	DL.AddComment "--- 3,2 Cash Button"
  	DL.SendSequence "3,2 Cash Button"
  	result = DL.WaitForSequence ("Good Box Response", 1,3000)
  End If
'------------------------------------------------------------
  If result <> 0 Then
  	DL.ResetReceiveCounter "Good Box Response"
  	DL.AddComment "--- 3,3 Touch Button"
  	DL.SendSequence "3,3 Touch Button"
  	result = DL.WaitForSequence ("Good Box Response", 1,3000)
  End If
'------------------------------------------------------------
  If result <> 0 Then
  	DL.ResetReceiveCounter "Good Box Response"
  	DL.AddComment "--- 3,4 Accept Button"
  	DL.SendSequence "3,4 Accept Button"
  	result = DL.WaitForSequence ("Good Box Response", 1,3000)
  End If
'------------------------------------------------------------
  If result <> 0 Then
  	DL.ResetReceiveCounter "Good Box Response"
  	DL.AddComment "--- 3,5 Enter Button"
  	DL.SendSequence "3,5 Enter Button"
  	result = DL.WaitForSequence ("Good Box Response", 1,3000)
   End If
'------------------------------------------------------------
  If result <> 0 Then
  	DL.ResetReceiveCounter "Good Box Response"
  	DL.AddComment "---4,1 Does not Appl Button"
  	DL.SendSequence "4,1 Does not Appl Button"
  	result = DL.WaitForSequence ("Good Box Response", 1,3000)
  End If
'------------------------------------------------------------
  If result <> 0 Then
 	 DL.ResetReceiveCounter "Good Box Response"
 	 DL.AddComment "--- 4,2 Agree Button"
  	DL.SendSequence "4,2 Agree Button"
  	result = DL.WaitForSequence ("Good Box Response", 1,3000)
   End If
'------------------------------------------------------------
  If result <> 0 Then
 	 DL.ResetReceiveCounter "Good Box Response"
 	 DL.AddComment "--- 4,3 Decline Button"
 	 DL.SendSequence "4,3 Decline Button"
 	 result = DL.WaitForSequence ("Good Box Response", 1,3000)
  End If
DL.Pause 5000

End If 'end of proj

'============================================================
' run proj display Radio buttons (83-12)
'============================================================
result = 1
runProj = runIt
If runProj <> 0 Then
 StartProj("BRB007-LP")

'------------------------------------------------------------
  DL.AddComment "--- Clear display"
  DL.SendSequence "Clear display"
  result = DL.WaitForSequence ("Clear display Response", 1,3000)
  
If result <> 0 Then
  DL.Pause 100
  DL.ResetReceiveCounter
  DL.AddComment "--- Event queue clear"
  DL.SendSequence "Event queue clear"
  result = DL.WaitForSequence ("Clear display Response", 1,3000)
End If
'------------------------------------------------------------
If result <> 0 Then
  DL.Pause 100
  DL.ResetReceiveCounter
  DL.AddComment "--- Radio button, grouip 1, Bryce rev"
  DL.SendSequence "Radio button, grouip 1, Bryce rev"
  result = DL.WaitForSequence ("General Response", 1,3000)
End If
'------------------------------------------------------------
If result <> 0 Then
  DL.Pause 100
  DL.ResetReceiveCounter
  DL.AddComment "--- Radio button, grouip 1, Monica rev"
  DL.SendSequence "Radio button, grouip 1, Monica rev"
  result = DL.WaitForSequence ("General Response", 1,3000)
End If
'------------------------------------------------------------
If result <> 0 Then
  DL.Pause 100
  DL.ResetReceiveCounter
  DL.AddComment "--- Radio button, grouip 1, Buff rev"
  DL.SendSequence "Radio button, grouip 1, Buff rev"
  result = DL.WaitForSequence ("General Response", 1,3000)
End If
'------------------------------------------------------------
If result <> 0 Then
  DL.Pause 100
  DL.ResetReceiveCounter
  DL.AddComment "--- Radio button, grouip 1, Bob rev"
  DL.SendSequence "Radio button, grouip 1, Bob rev"
  result = DL.WaitForSequence ("General Response", 1,3000)
End If
'------------------------------------------------------------
If result <> 0 Then
  DL.Pause 100
  DL.ResetReceiveCounter
  DL.AddComment "--- Radio button, grouip 2, Buy More Memory rev"
  DL.SendSequence "Radio button, grouip 2, Buy More Memory rev"
  result = DL.WaitForSequence ("General Response", 1,3000)
End If
'------------------------------------------------------------
If result <> 0 Then
  DL.Pause 100
  DL.ResetReceiveCounter
  DL.AddComment "--- Radio button, grouip 2, label multiple processors rev"
  DL.SendSequence "Radio button, grouip 2, label multiple processors rev"
End If
'------------------------------------------------------------
If result <> 0 Then
  DL.Pause 100
  DL.ResetReceiveCounter
  DL.AddComment "--- Radio button, grouip 2, More Food rev"
  DL.SendSequence "Radio button, grouip 2, More Food rev"
End If
'------------------------------------------------------------
If result <> 0 Then
  DL.Pause 100
  DL.ResetReceiveCounter
  DL.AddComment "---Radio button, grouip 2, label More Employees rev"
  DL.SendSequence "Radio button, grouip 2, label More Employees rev"
End If
'------------------------------------------------------------
If result <> 0 Then
  DL.Pause 100
  DL.ResetReceiveCounter
  DL.AddComment "--- Radio button, grouip 2, More Stock rev"
  DL.SendSequence "Radio button, grouip 2, More Stock rev"
End If
'------------------------------------------------------------
If result <> 0 Then
  DL.Pause 100
  DL.ResetReceiveCounter
  DL.AddComment "--- Radio button, grouip 2, label More Money rev"
  DL.SendSequence "Radio button, grouip 2, label More Money rev"
End If
'------------------------------------------------------------
If result <> 0 Then
  DL.Pause 100
  DL.ResetReceiveCounter
  DL.AddComment "--- Get event 0 timeout"
  DL.SendSequence "Get event 0 timeout"
End If
DL.Pause 3000

End If 'end of proj

'============================================================
' run proj input field (83-1C, 83-1E, 83-1D, 83-06)
'============================================================
result = 1
runProj = runIt
If runProj <> 0 Then

 ' StartProj("C:\vivotech\regress\regression\regress_test\test_tree\8xxx_Input_Field\INP005\INP005")
 StartProj("INP005-LP")

If result <> 0 Then
  DL.AddComment "--- Clear Display"
  DL.SendSequence "Clear Display"
  result = DL.WaitForSequence ("Display CUSTOM MODE OK", 1,3000)
End If
'------------------------------------------------------------
If result <> 0 Then
  DL.AddComment "--- Disable Custom Display Mode"
  DL.SendSequence "Disable Custom Display Mode"
  result = DL.WaitForSequence ("Display CUSTOM MODE OK", 1,3000)
End If
'------------------------------------------------------------
If result <> 0 Then
  DL.AddComment "--- Display Text: Please enter tip"
  DL.SendSequence "Display Text: Please enter tip"
  result = DL.WaitForSequence ("Display Control OK", 1,3000)
End If
'------------------------------------------------------------
If result <> 0 Then
  DL.AddComment "--- UI Event Queue Clear"
  DL.SendSequence "UI Event Queue Clear"
  result = DL.WaitForSequence ("Display Control OK", 1,3000)
End If
'------------------------------------------------------------
If result <> 0 Then
  DL.AddComment "--- Input Field Formatting 1"
  DL.SendSequence "Input Field Formatting 1"
  result = DL.WaitForSequence ("Display Control OK", 1,3000)
End If
If result <> 0 Then
  DL.Pause 2000
  DL.SendSequence "Clear Input Field (83-1E)", ControlID, "H"
  result = DL.WaitForSequence ("Display CUSTOM MODE OK", 1,3000)
End If
If result <> 0 Then
  DL.Pause 1000
  DL.SendSequence "Get Input Field Value (83-1D)", ControlID, "H"
  result = DL.WaitForSequence ("Display CUSTOM MODE OK", 1,3000)
End If

'------------------------------------------------------------
If result <> 0 Then
  DL.AddComment "--- Read Event Request"
  DL.SendSequence "Read Event Request"
  resultIgnore = DL.WaitForSequence ("1 Key PRESSED", 1,15000)
End If
  DL.Pause 10000
End If 'end of proj

'============================================================
' run proj line items (83-10,83-11,83-13,83-14,83-15)
'============================================================
result = 1
runProj = runIt
If runProj <> 0 Then

  ' StartProj("C:\vivotech\regress\regression\regress_test\test_tree\8xxx_Line_Item_Display\LID005\LID005")
  StartProj("LID005-LP")

  DL.AddComment "--- Clear Event Queue"
  DL.SendSequence " Clear Even Queue"
  result = DL.WaitForSequence("Stop/Start Response", 1, 3000)
  'verdict(result)
'------------------------------------------------------------
  DL.ResetReceiveCounter
  DL.AddComment "--- Clear Display"
  DL.SendSequence " Clear Display"
  result = DL.WaitForSequence("Stop/Start Response", 1, 3000)
  'verdict(result)
'------------------------------------------------------------
  DL.ResetReceiveCounter
  DL.AddComment "--- Start Custom Display Mode"
  DL.SendSequence " Start Custom Display Mode"
  result = DL.WaitForSequence("Stop/Start Response", 1, 3000)
  'verdict(result)
'------------------------------------------------------------
  DL.ResetReceiveCounter
  DL.AddComment "--- Line Item Box"
  DL.SendSequence "Line Item Box"
  result = DL.WaitForSequence("Display Control Ok", 1, 3000)
'------------------------------------------------------------
  DL.ResetReceiveCounter
  'Debugger "ControlID", ControlID
  DL.AddComment "--- Line Item 1"
  DL.SendSequence "Line Item 1", ControlID, "H"
  result = DL.WaitForSequence("Stop/Start Response", 1, 3000)
'------------------------------------------------------------
DL.Pause 3000
  DL.ResetReceiveCounter
  'Debugger "ControlID", ControlID
  DL.AddComment "--- Delete List"
  DL.SendSequence "Delete List", ControlID, "H"
  result = DL.WaitForSequence("Stop/Start Response", 1, 3000)
'------------------------------------------------------------
' reprint box and line items
'------------------------------------------------------------
  DL.ResetReceiveCounter
  DL.AddComment "--- Line Item Box"
  DL.SendSequence "Line Item Box"
  result = DL.WaitForSequence("Display Control Ok", 1, 3000)
'------------------------------------------------------------
  DL.ResetReceiveCounter
  'Debugger "ControlID", ControlID
  DL.AddComment "--- Line Item 1"
  DL.SendSequence "Line Item 1", ControlID, "H"
  result = DL.WaitForSequence("Stop/Start Response", 1, 3000)
'------------------------------------------------------------
  DL.ResetReceiveCounter
  'Debugger "ControlID", ControlID
  DL.AddComment "--- Line Item 2"
  DL.SendSequence "Line Item 2", ControlID, "H"
  result = DL.WaitForSequence("Stop/Start Response", 1, 3000)
'------------------------------------------------------------
  DL.ResetReceiveCounter
  'Debugger "ControlID", ControlID
  DL.AddComment "--- Line Item 3"
  DL.SendSequence "Line Item 3", ControlID, "H"
  result = DL.WaitForSequence("Stop/Start Response", 1, 3000)
'------------------------------------------------------------
  DL.ResetReceiveCounter
  'Debugger "ControlID", ControlID
  DL.AddComment "--- Line Item 4"
  DL.SendSequence "Line Item 4", ControlID, "H"
  result = DL.WaitForSequence("Stop/Start Response", 1, 3000)
'------------------------------------------------------------
  DL.ResetReceiveCounter
  'Debugger "ControlID", ControlID
  DL.AddComment "--- Line Item 5"
  DL.SendSequence "Line Item 5", ControlID, "H"
  result = DL.WaitForSequence("Stop/Start Response", 1, 3000)
'------------------------------------------------------------
  DL.ResetReceiveCounter
  'Debugger "ControlID", ControlID
  DL.AddComment "--- Display List"
  DL.SendSequence "Display List", ControlID, "H"
  resultIgnore = DL.WaitForSequence("Display List Response", 1, 3000)
'--------------------------------------------------------------
  DL.ResetReceiveCounter
  'Debugger "ControlID", ControlID
  DL.AddComment "--- Get Select Item "
  DL.SendSequence "Get Select Item ", ControlID, "H"
  resultIgore = DL.WaitForSequence("Invaild Subcommand", 1, 3000)
'------------------------------------------------------------
  'DL.Pause 5000
  'DL.ResetReceiveCounter
  'DL.AddComment "--- Get Input Event "
  'DL.SendSequence "Get Input Event"
  'resultIgnore = DL.WaitForSequence("Line Item 5 Response", 1, 3000)

End If 'end of proj

'============================================================
' run proj display check box (83-18)
'============================================================
result = 1
runProj = runIt
If runProj <> 0 Then

  ' StartProj("C:\vivotech\regress\regression\regress_test\test_tree\8xxx_Check_Box\CKB003\CKB003")
  StartProj("CKB003-LP")

'------------------------------------------------------------
  If result <> 0 Then
  DL.ResetReceiveCounter
  DL.AddComment "--- Clear Display"
  DL.SendSequence " Clear Display"
  result = DL.WaitForSequence("Clear display Response", 1, 3000)
  End If
'------------------------------------------------------------
  If result <> 0 Then
  DL.ResetReceiveCounter
  DL.AddComment "--- Check Box Left Marked "
  DL.SendSequence " Check Box Left Marked"
  result = DL.WaitForSequence("Check Box Response", 1, 4000)
  End If
'------------------------------------------------------------
  If result <> 0 Then
  DL.ResetReceiveCounter
  DL.AddComment "--- Check Box Right "
  DL.SendSequence " Check Box Right"
  result = DL.WaitForSequence("Check Box Response", 1, 4000)
  End If

End If 'end of proj

'============================================================
' run proj set property (83-0B)
'============================================================
result = 1
runProj = runIt
If runProj <> 0 Then

  ' StartProj("C:\vivotech\regress\regression\regress_test\test_tree\8XXX_Set_Property\SPP001\SPP001")
  StartProj("SPP001-LP")
  
 	 If result <> 0 Then
    		 DL.AddComment "--- Clear Event Queue"
   		  DL.SendSequence " Clear Even Queue"
    		 result = DL.WaitForSequence("Stop/Start Response", 1, 3000)
 	 End If
'------------------------------------------------------------
  	If result <> 0 Then
  		DL.ResetReceiveCounter
  		DL.AddComment "--- Clear Display"
		  DL.SendSequence " Clear Display"
 		 result = DL.WaitForSequence("Stop/Start Response", 1, 3000)
	End If
'------------------------------------------------------------
  	If result <> 0 Then
 		 DL.ResetReceiveCounter
 		 DL.AddComment "--- Start Custom Display Mode"
 		 DL.SendSequence " Start Custom Display Mode"
 		 result = DL.WaitForSequence("Stop/Start Response", 1, 3000)
 	 End if

'------------------------------------------------------------
	If result <> 0 Then
  		DL.ResetReceiveCounter
  		DL.AddComment "--- Get Button Press Yes"
  		DL.SendSequence "Get Button Press Yes"
  		result = DL.WaitForSequence("Display Button", 1, 3000)
	End If
'------------------------------------------------------------
	If result <> 0 Then
  		DL.ResetReceiveCounter
  		DL.AddComment "--- Get Button Press No"
  		DL.SendSequence "Get Button Press No"
  		result = DL.WaitForSequence("Display Button", 1, 3000)
	End If

'------------------------------------------------------------
  	If result <> 0 Then
		DL.ResetReceiveCounter
  		'Debugger "ControlID", ControlID
  		DL.AddComment "--- Set Property Disable"
  		DL.SendSequence "Set Property Disable", ControlID, "H"
 		result = DL.WaitForSequence("Stop/Start Response", 1, 3000)
	End If
'------------------------------------------------------------
  	'If result <> 0 Then
 	'	DL.ResetReceiveCounter
  	'	DL.AddComment "--- Get Input Event "
  	'	DL.SendSequence " Get Input Event "
  	'	resultIgnore = DL.WaitForSequence("Yes Button Press", 1, 20000)
 	'End If

End If 'end of proj

'============================================================
' run proj set foreground and background (83-0A)
'============================================================
result = 1
runProj = runIt
If runProj <> 0 Then

  ' StartProj("C:\vivotech\regress\regression\regress_test\test_tree\Set_Background_Color\SBC001\SBC001")
  StartProj("SBC001-LP")
'------------------------------------------------------------
  DL.ResetReceiveCounter
  DL.AddComment "--- Clear Display"
  DL.SendSequence " Clear Display"
  result = DL.WaitForSequence("Stop/Start Response", 1, 3000)
'------------------------------------------------------------
  DL.ResetReceiveCounter
  DL.AddComment "--- White/Black"
  DL.SendSequence "White/Black"
  result = DL.WaitForSequence("Stop/Start Response", 1, 3000)
'------------------------------------------------------------
  DL.ResetReceiveCounter
  DL.AddComment "--- Please Use Other VISA Card"
  DL.SendSequence "Please Use Other VISA Card"
  result = DL.WaitForSequence("Test Response", 1, 3000)

  DL.Pause 3000
'------------------------------------------------------------
  DL.ResetReceiveCounter
  DL.AddComment "--- White/Red"
  DL.SendSequence "White/Red"
  result = DL.WaitForSequence("Stop/Start Response", 1, 3000)
'------------------------------------------------------------
  DL.ResetReceiveCounter
  DL.AddComment "--- Please Use Other VISA Card"
  DL.SendSequence "Please Use Other VISA Card"
  result = DL.WaitForSequence("Test Response", 1, 3000)

  DL.Pause 3000
'------------------------------------------------------------
  DL.ResetReceiveCounter
  DL.AddComment "--- Black/White"
  DL.SendSequence "Black/White"
  result = DL.WaitForSequence("Stop/Start Response", 1, 3000)
'------------------------------------------------------------
  DL.ResetReceiveCounter
  DL.AddComment "--- Please Use Other VISA Card"
  DL.SendSequence "Please Use Other VISA Card"
  result = DL.WaitForSequence("Test Response", 1, 3000)

  DL.Pause 3000

'------------------------------------------------------------
'  DL.ResetReceiveCounter
'  DL.Pause 3000
'  DL.AddComment "--- Clear Display"
'  DL.SendSequence " Clear Display"
'  result = DL.WaitForSequence("Stop/Start Response", 1, 3000)
'------------------------------------------------------------
End If 'end of proj

'=================================================================
' run proj file management (83-22,83-23,83-24,83-25,83-26,83-1F)
'=================================================================
result = 1
runProj = runIt
If runProj <> 0 Then
  ' StartProj("C:\vivotech\regress\regression\regress_test\test_tree\8xxx_Directory\DIR005\DIR005")
  StartProj("DIR005-LP")
'------------------------------------------------------------

If result <> 0 Then
  DL.AddComment "--- Check Free Space on Drive (83-23)"
  DL.SendSequence "Check Free Space on Drive (83-23)"
  result = DL.WaitForSequence ("FREE SPACE OK", 1,3000)
End If
'------------------------------------------------------------
'If result <> 0 Then
  DL.ResetReceiveCounter
  DL.AddComment "--- Delete File - applefile.x in ROOT/apple"
  DL.SendSequence "Delete File - applefile.x in ROOT/apple"
  resultIgnor = DL.WaitForSequence ("List Directory OK", 1,3000)
'End If
'------------------------------------------------------------
'If result <> 0 Then
  DL.ResetReceiveCounter
  DL.AddComment "--- Delete Directory - apple"
  DL.SendSequence "Delete Directory - apple"
  resultIngore = DL.WaitForSequence ("List Directory OK", 1,3000)
'End If
'----------------------------------------------------------
If result <> 0 Then
  DL.AddComment "--- Create Directory 'apple' (83-25)"
  DL.SendSequence "Create Directory 'apple' (83-25)"
  result = DL.WaitForSequence ("List Directory OK", 1,3000)
End If
'------------------------------------------------------------
If result <> 0 Then
  DL.ResetReceiveCounter
  DL.AddComment "--- File Download - part 1 - apple/applefile.x:30bytes"
  DL.SendSequence "File Download - part 1 - apple/applefile.x:30bytes"
  result = DL.WaitForSequence ("List Directory OK", 1,3000)
End If
'------------------------------------------------------------
If result <> 0 Then
  DL.ResetReceiveCounter
  DL.AddComment "--- File Download - part 2 - apple/applefile.x:30bytes"
  DL.SendSequence "File Download - part 2 - apple/applefile.x:30bytes"
  result = DL.WaitForSequence ("List Directory OK", 1,3000)
End If
'------------------------------------------------------------
If result <> 0 Then
  DL.ResetReceiveCounter
  DL.AddComment "--- File Download - part 3 - apple/applefile.x:30bytes"
  DL.SendSequence "File Download - part 3 - apple/applefile.x:30bytes"
  result = DL.WaitForSequence ("List Directory OK", 1,3000)
End If
'-------------------------------------------------------------
If result <> 0 Then
  DL.ResetReceiveCounter
  DL.AddComment "--- List present directories and files"
  DL.SendSequence "List Directory (83-22) - Recursive"
  resultIgnore = DL.WaitForSequence ("List Directory OK", 1,3000)
End If
'------------------------------------------------------------
If result <> 0 Then
  DL.ResetReceiveCounter
  DL.AddComment "--- Delete File - applefile.x in ROOT/apple"
  DL.SendSequence "Delete File - applefile.x in ROOT/apple"
  result = DL.WaitForSequence ("List Directory OK", 1,3000)
End If
'------------------------------------------------------------
If result <> 0 Then
  DL.ResetReceiveCounter
  DL.AddComment "--- Delete Directory - apple"
  DL.SendSequence "Delete Directory - apple"
  result = DL.WaitForSequence ("List Directory OK", 1,3000)
End If
'------------------------------------------------------------
If result <> 0 Then
  DL.ResetReceiveCounter
  DL.AddComment "--- List present directories and files"
  DL.SendSequence "List Directory (83-22) - Recursive"
  result = DL.WaitForSequence ("List Directory OK", 1,3000)
End If
'------------------------------------------------------------
End If 'end of proj

'=======================================================================
' run proj display image (83-0e)
'=======================================================================
result = 1
runProj = runIt
If runProj <> 0 Then
  'StartProj("C:\vivotech\regress\regression\regress_test\test_tree\Event_Queue\EVQ024\EVQ024")
  StartProj("EVQ024-LP")
'--Show Images ----------------------------------------------------------
  DL.ResetReceiveCounter
  DL.AddComment "--- Clear Display"
  DL.SendSequence " Clear Display"
  result = DL.WaitForSequence("Stop/Start Response", 1, 3000)
'------------------------------------------------------------
  DL.ResetReceiveCounter
  DL.AddComment "--- Start Custom Display Mode"
  DL.SendSequence " Start Custom Display Mode"
  result = DL.WaitForSequence("Stop/Start Response", 1, 3000)
'------------------------------------------------------------
  DL.ResetReceiveCounter
  DL.AddComment "--- Display Duck"
  DL.SendSequence "Display Duck"
  result = DL.WaitForSequence("Display Image", 1, 3000)

'------------------------------------------------------------
  DL.ResetReceiveCounter
  DL.AddComment "--- Get Input Event "
  DL.SendSequence "Get Input Event"
  result = DL.WaitForSequence("Touch Duck", 1, 32000)
'------------------------------------------------------------
  DL.Pause 5000

End If 'end of proj
'=======================================================================
' run proj display slides (83-20,83-21)
'=======================================================================
result = 1
runProj = runIt
If runProj <> 0 Then
  ' StartProj("C:\vivotech\regress\regression\regress_test\test_tree\Event_Queue\EVQ020\EVQ020")
  StartProj("EVQ020-LP")

'--Show Slides ----------------------------------------------------------
  DL.ResetReceiveCounter
  DL.AddComment "--- Clear Display"
  DL.SendSequence " Clear Display"
  result = DL.WaitForSequence("Stop/Start Response", 1, 3000)
'------------------------------------------------------------
  DL.ResetReceiveCounter
  DL.AddComment "--- Start Custom Display Mode"
  DL.SendSequence " Start Custom Display Mode"
  result = DL.WaitForSequence("Stop/Start Response", 1, 3000)
'------------------------------------------------------------
  DL.ResetReceiveCounter
  DL.AddComment "--- Slide Show Start"
  DL.SendSequence "Slide Show Start"
  result = DL.WaitForSequence("Stop/Start Response", 1, 3000)
  DL.Pause 5000
'------------------------------------------------------------
  DL.ResetReceiveCounter
  DL.Pause 15000
  DL.AddComment "--- Slide Show Stop"
  DL.SendSequence "Slide Show Stop"
  result = DL.WaitForSequence("Stop/Start Response", 1, 3000)
'------------------------------------------------------------
  DL.ResetReceiveCounter
  DL.Pause 3000
  DL.AddComment "--- Get Input Event "
  DL.SendSequence "Get Input Event"
  result = DL.WaitForSequence("Stop Slide Show Event", 1, 32000)
  DL.Pause 2000
'------------------------------------------------------------
'  DL.ResetReceiveCounter
'  DL.AddComment "--- Clear Display"
'  DL.SendSequence "Clear Display"
'  result = DL.WaitForSequence("Stop/Start Response", 1, 3000)
'  verdict(result)
'------------------------------------------------------------

End If 'end of proj

'=======================================================================
' run proj display paragrapgs (83-28)
'=======================================================================
result = 1
runProj = runIt
If runProj <> 0 Then
  StartProj("DPGH020-LP")
If result <> 0 Then
  DL.ResetReceiveCounter
  DL.AddComment vbCrLf & "--- Clear display"
  DL.SendSequence "Clear display"
  result = DL.WaitForSequence ("common 83-xx resp ", 1,3000)
End If
'------------------------------------------------------------
If result <> 0 Then
  DL.ResetReceiveCounter
  DL.AddComment vbCrLf & "--- Begin custom mode"
  DL.SendSequence "Begin custom mode"
  result = DL.WaitForSequence ("common 83-xx resp ", 1,3000)
End If
'------------------------------------------------------------
If result <> 0 Then
  DL.Pause 1000
  DL.ResetReceiveCounter
  DL.AddComment vbCrLf & vbCrLf & "--- Display paragraph at xy in specified area (multi pages) font 2  "
  DL.SendSequence "Display paragraph at xy in specified area (multi pages) font 2  "
  result = DL.WaitForSequence ("common 83-28 resp sts=00", 1,3000)
End If

If result <> 0 Then
  DL.Pause 1000
  DL.ResetReceiveCounter
  DL.AddComment vbCrLf & vbCrLf & "--- Display text for paragraph test  "
  DL.SendSequence "Display text for paragraph test  "
  result = DL.WaitForSequence ("common 83-28 resp sts=00", 1,3000)
End If

If result <> 0 Then
  DL.Pause 1000
  DL.ResetReceiveCounter
  DL.AddComment vbCrLf & vbCrLf & "--- Display button 1 for paragraph test  "
  DL.SendSequence "Display button 1 for paragraph test  "
  result = DL.WaitForSequence ("common 83-28 resp sts=00", 1,3000)
End If

If result <> 0 Then
  DL.Pause 1000
  DL.ResetReceiveCounter
  DL.AddComment vbCrLf & vbCrLf & "--- Display button 2 for paragraph test  "
  DL.SendSequence "Display button 2 for paragraph test  "
  result = DL.WaitForSequence ("common 83-28 resp sts=00", 1,3000)
End If

End If 'end of proj

'=================================================================
' run proj transaction log list (84-00,84-01,84-02)
'=================================================================
result = 1
runProj = runIt
If runProj <> 0 Then
  ' StartProj("C:\vivotech\regress\regression\regress_test\test_tree\Transaction_logList\TLST001\TLST001")
  StartProj("TLST001-LP")

If result <> 0 Then
  DL.ResetReceiveCounter
  DL.AddComment "--- Delete All Entries from EMV Transaction Log (84-01)"
  DL.SendSequence "Delete All Entries from EMV Transaction Log (84-01)"
  result = DL.WaitForSequence("Add or Del Entry of EMV R or E List resp", 1, 5000)
End If
If result <> 0 Then
  DL.ResetReceiveCounter
  DL.AddComment "--- Get EMV Transaction Log Status (84-00)"
  DL.SendSequence "Get EMV Transaction Log Status (84-00)"
  result = DL.WaitForSequence("Get trans log status with 0 record resp", 1, 5000)
End If
If result <> 0 Then
  DL.ResetReceiveCounter
  DL.AddComment "--- Get EMV Transaction Log (84-02)"
  DL.SendSequence "Get EMV Transaction Log (84-02)"
  resultIgnore = DL.WaitForSequence("Get trans log list with 1 record resp", 1, 5000)
End If

End If 'end of proj

'=================================================================
' run proj revocation log list (84-03,84-04,84-05,84-06,84-07)
'=================================================================
result = 1
runProj = runIt
If runProj <> 0 Then
  ' StartProj("C:\vivotech\regress\regression\regress_test\test_tree\Revocation_logList\RLST001\RLST001")
  StartProj("RLST001-LP")

If result <> 0 Then
  DL.ResetReceiveCounter
  DL.AddComment vbCrLf & "--- Delete All Entries from EMV Revocation List (84-06)"
  DL.SendSequence "Delete All Entries from EMV Revocation List (84-06)"
  resultIgnore = DL.WaitForSequence("Add or Del Entry of EMV R or E List resp", 1, 10000)
End If
If result <> 0 Then
  DL.ResetReceiveCounter
  DL.AddComment vbCrLf & vbCrLf & "--- Add Entry to EMV Revocation List (84-04) - TEST"
  DL.SendSequence "Add Entry to EMV Revocation List (84-04) - TEST"
  result = DL.WaitForSequence("Add or Del Entry of EMV R or E List resp", 1, 10000)
End If
'============================================================
If result <> 0 Then
  DL.ResetReceiveCounter
  DL.AddComment vbCrLf & vbCrLf & "--- Get EMV Revocation Log Status (84-03)"
  DL.SendSequence "Get EMV Revocation Log Status (84-03)"
  result = DL.WaitForSequence("Get R or E log status with 1 record resp", 1, 10000)
End If
'============================================================
If result <> 0 Then
  DL.ResetReceiveCounter
  DL.AddComment vbCrLf & vbCrLf & "--- Get EMV Revocation List (84-07)"
  DL.SendSequence "Get EMV Revocation List (84-07)"
  result = DL.WaitForSequence("Get R list with record TEST resp", 1, 10000)
End If
If result <> 0 Then
  DL.ResetReceiveCounter
  DL.AddComment vbCrLf & vbCrLf & "--- Delete Entry from EMV Revocation List (84-05) TEST"
  DL.SendSequence "Delete Entry from EMV Revocation List (84-05) TEST"
  result = DL.WaitForSequence("Add or Del Entry of EMV R or E List resp", 1, 10000)
End If

End If 'end of proj

'=================================================================
' run proj exception log list (84-08,84-09,84-0A,84-0B,84-0C)
'=================================================================
result = 1
runProj = runIt
If runProj <> 0 Then
  ' StartProj("C:\vivotech\regress\regression\regress_test\test_tree\Exception_logList\ELST001\ELST001")
  StartProj("ELST001-LP")

If result <> 0 Then
  DL.ResetReceiveCounter
  DL.AddComment vbCrLf & "--- Delete All Entries from EMV Exception List (84-0B)"
  DL.SendSequence "Delete All Entries from EMV Exception List (84-0B)"
  resultIgnore = DL.WaitForSequence("Add or Del Entry of EMV R or E List resp", 1, 10000)
End If
If result <> 0 Then
  DL.ResetReceiveCounter
  DL.AddComment vbCrLf & vbCrLf & "--- Add Entry to EMV Exception List (84-09) - CUBIC VISA"
  DL.SendSequence "Add Entry to EMV Exception List (84-09) - CUBIC VISA"
  result = DL.WaitForSequence("Add or Del Entry of EMV R or E List resp", 1, 10000)
End If
'============================================================
If result <> 0 Then
  DL.ResetReceiveCounter
  DL.AddComment vbCrLf & vbCrLf & "--- Get EMV Exception Log Status (84-08)"
  DL.SendSequence "Get EMV Exception Log Status (84-08)"
  result = DL.WaitForSequence("Get R or E log status with 1 record resp", 1, 10000)
End If
'============================================================
If result <> 0 Then
  DL.ResetReceiveCounter
  DL.AddComment vbCrLf & vbCrLf & "--- Get EMV Exception List (84-0C)"
  DL.SendSequence "Get EMV Exception List (84-0C)"
  result = DL.WaitForSequence("Get E list with record EMV Contact CUBIC VISA resp", 1, 10000)
End If
If result <> 0 Then
  DL.ResetReceiveCounter
  DL.AddComment vbCrLf & vbCrLf & "--- Delete Entry from EMV Exception List (84-0A) - CUBIC VISA"
  DL.SendSequence "Delete Entry from EMV Exception List (84-0A) - CUBIC VISA"
  result = DL.WaitForSequence("Add or Del Entry of EMV R or E List resp", 1, 10000)
End If

End If 'end of proj

Loop While loopForever <> 0


DL.AddComment vbCrLf
PrintMyResult(result)

DL.AddComment "---------- END OF TEST ----------" & vbCrLf

'------------------------------------------------------------
'Result verdict (!!!!! DO NOT EDIT !!!!!)
'------------------------------------------------------------
DL.pause 1000

If result = 0 then
  DL.AddComment Chr(13) & "Result = FAILED"
Else
  DL.AddComment Chr(13) & "Result = PASSED"
End If

If Prompting(0) = "ON" Then
  If result = 0 then
    MsgBox "Result = FAILED", VBOKOnly, "Result"
  Else 
    MsgBox "Result = PASSED", VBOKOnly, "Result"
  End If
End If

'-------------------------------------------------------------
' DETERMINE MASTER VERDICT (!!!!! DO NOT EDIT !!!!!)
'-------------------------------------------------------------

If MasterResult = 1 Then
      MasterVerdict = "PASSED"
ElseIf MasterResult = 0 Then
      MasterVerdict = "FAILED"
End If
result = MasterResult
DL.AddComment vbCrLf
DL.AddComment "MASTER RESULT = " & MasterVerdict
'MasterResult = 0
'------------------------------------------------------------
' WRITE FINAL VERDICT (!!!!! DO NOT EDIT !!!!!)
'------------------------------------------------------------
'If MasterResult = 0 Then 
'	FileOutput.CreateFile "MR_FAIL"
'ElseIf MasterResult = 1 Then
'	FileOutput.CreateFile "MR_PASS"
'End If

' FileOutput.CreateFile "FINAL_VERDICT.txt"

If MasterResult = 0 Then 
	' FileOutput.WriteLine "0|FAIL|NOK"
ElseIf MasterResult = 1 Then
	' FileOutput.WriteLine "1|PASS|OK"
End If
'FileOutput.WriteLine MasterResult
FileOutput.CloseFile 


