VERSION
8

COMMSETTINGS
0
COM1
COM2
9600
2
0
4
0
0

COMMDISPLAY
0

SEND
0
Erase All Keys
56 69 56 4F 74 65 63 68 32 00 83 00 00 00 03 22
0
5

SEND
1
Load Plaintext KPK Component (the 1st)
56 69 56 4F 74 65 63 68 32 00 80 00 00 65 30 43 46 35 35 34 43 32 46 30 45 45 41 41 30 30 38 38 4B 30 54 44 30 30 4E 30 30 30 30 30 30 38 30 32 41 38 34 46 44 44 36 33 39 31 35 44 43 41 45 42 46 38 37 37 35 34 33 32 32 44 32 36 37 42 41 33 34 34 31 38 33 41 42 39 41 32 35 36 37 39 30 32 33 34 39 38 37 31 32 30 32 33 34 30 30 30 30 30 30 30 30 C2 98
0
5

SEND
2
Load Plaintext KPK Component (the last)
56 69 56 4F 74 65 63 68 32 00 80 00 00 65 31 35 43 44 42 38 31 32 46 30 45 45 41 41 30 30 38 38 4B 30 54 44 30 30 4E 30 30 30 30 30 30 38 30 39 32 36 39 41 34 33 36 39 42 36 43 37 45 33 42 35 36 37 32 39 38 33 41 36 36 32 46 36 31 30 33 32 35 37 32 39 32 33 36 33 37 38 33 30 33 33 36 32 33 41 39 39 37 31 32 36 32 33 34 30 30 30 30 30 30 30 30 AA E9
0
5

SEND
3
Load KPK
56 69 56 4F 74 65 63 68 32 00 80 01 00 58 41 30 30 38 38 4B 30 54 44 30 30 4E 30 30 30 30 42 39 34 38 46 37 42 33 34 43 41 44 37 32 36 42 41 37 37 43 39 43 34 41 38 30 37 37 39 42 42 38 36 42 42 43 33 37 34 30 31 31 42 42 45 33 39 45 30 36 46 34 46 36 41 37 44 44 36 46 37 32 30 45 37 31 33 44 45 39 34 41 A0 6B
0
5

SEND
4
Load DUKPT key (key index 5)
56 69 56 4F 74 65 63 68 32 00 81 00 00 71 05 41 30 31 31 32 44 30 54 45 30 30 4E 30 31 30 30 4B 53 31 38 46 46 46 46 39 38 37 36 35 34 33 32 31 30 45 30 30 30 30 30 37 43 45 37 34 45 39 30 30 35 33 43 41 38 45 45 42 43 33 37 42 35 37 30 36 38 31 45 35 42 32 37 36 31 34 38 43 33 45 37 34 34 41 42 43 44 36 44 34 43 35 33 36 43 37 46 34 46 36 37 44 37 46 32 32 44 33 39 34 45 44 42 A8 31
0
5

SEND
5
Select DUKPT Data Encryption Key (key slot 5)
56 69 56 4F 74 65 63 68 32 00 81 09 00 01 05 40 D3
0
5

SEND
6
-----------------------  Start/Stop Passthrough Mode (2C-01) ------------------------
00 00
0
5

SEND
7
Start Passthrough Mode
56 69 56 4F 74 65 63 68 32 00 2C 01 00 01 01 19 1D
0
5

SEND
8
Stop Passthrough Mode
56 69 56 4F 74 65 63 68 32 00 2C 01 00 01 00 38 0D
0
5

SEND
9
Enhanced PT - Poll for Token - SAM3 (Tout=5s)
56 69 56 4F 74 65 63 68 32 00 2C 11 00 0A 00 05 02 00 04 00 23 00 00 00 18 EE
0
5

SEND
10
Enhanced PT - Deactivate - SAM3
56 69 56 4F 74 65 63 68 32 00 2C 11 00 0A 00 00 00 00 10 00 23 00 00 00 57 0A
0
5

SEND
11
---------------------------------  Exchange APDU (2C-13) ----------------------------------
00 00
0
5

SEND
12
Exchange APDU SAM3 (Select SAM)
56 69 56 4F 74 65 63 68 32 00 2C 13 00 0E 23 00 A4 04 00 07 A0 00 00 02 99 50 10 00 D0 81
0
5

SEND
13
Exchange APDU SAM3 (SetCaPublicKey) VISA - 64
56 69 56 4F 74 65 63 68 32 00 2C 13 00 AC 23 80 40 00 00 A5 64 00 A2 A0 00 00 00 03 01 01 01 D3 4A 6A 77 60 11 C7 E7 CE 3A EC 5F 03 AD 2F 8C FC 55 03 CC 00 00 00 03 00 80 C6 96 03 42 13 D7 D8 54 69 84 57 9D 1D 0F 0E A5 19 CF F8 DE FF C4 29 35 4C F3 A8 71 A6 F7 18 3F 12 28 DA 5C 74 70 C0 55 38 71 00 CB 93 5A 71 2C 4E 28 64 DF 5D 64 BA 93 FE 7E 63 E7 1F 25 B1 E5 F5 29 85 75 EB E1 C6 3A A6 17 70 69 17 91 1D C2 A7 5A C2 8B 25 1C 7E F4 0F 23 65 91 24 90 B9 39 BC A2 12 4A 30 A2 8F 54 40 2C 34 AE CA 33 1A B6 7E 1E 79 B2 85 DD 57 71 B5 D9 FF 79 EA 63 0B 75 00 9A 9F
0
5

SEND
14
Exchange APDU SAM3 (GetCaPublicKey) VISA - 75
56 69 56 4F 74 65 63 68 32 00 2C 13 00 10 23 80 40 00 00 09 75 00 06 A0 00 00 00 03 01 00 BA 01
0
5

SEND
15
Exchange APDU SAM3 (GetRidSpecificCaPublicKey) VISA - 7B
56 69 56 4F 74 65 63 68 32 00 2C 13 00 0F 23 80 40 00 00 08 7B 00 05 A0 00 00 00 03 00 3F 7B
0
5

SEND
16
Exchange APDU SAM3 (SelectCaPublicKey) VISA - 61
56 69 56 4F 74 65 63 68 32 00 2C 13 00 10 23 80 40 00 00 09 61 00 06 A0 00 00 00 03 01 00 19 38
0
5

SEND
17
Exchange APDU SAM3 (DeleteCaPublicKey) VISA - 65
56 69 56 4F 74 65 63 68 32 00 2C 13 00 10 23 80 40 00 00 09 65 00 06 A0 00 00 00 03 01 00 2C 95
0
5

SEND
18
Exchange APDU SAM3 (SetCountryCode) 08 40 - 69
56 69 56 4F 74 65 63 68 32 00 2C 13 00 0C 23 80 40 00 00 05 69 00 02 08 40 00 35 30
0
5

SEND
19
Exchange APDU SAM3 (GetCountryCode) 08 40 - 6A
56 69 56 4F 74 65 63 68 32 00 2C 13 00 0A 23 80 40 00 00 03 6A 00 00 00 7D 31
0
5

SEND
20
Exchange APDU SAM3 (Echoback) - 6C
56 69 56 4F 74 65 63 68 32 00 2C 13 00 0A 23 80 40 00 00 03 6C 00 FF 00 1B 15
0
5

SEND
21
---------------------------------secure  Exchange APDU (2C-19) ----------------------------------
00 00
0
5

SEND
22
2c-19 61, Exchange APDU SAM3 (Select SAM)
56 69 56 4F 74 65 63 68 32 00 2C 19 00 0F 23 61 00 A4 04 00 07 A0 00 00 02 99 50 10 00 00 00
0
5

SEND
23
2c-19 61, Exchange APDU SAM3 (SetCaPublicKey) VISA - 64
56 69 56 4F 74 65 63 68 32 00 2C 19 00 AD 23 61 80 40 00 00 A5 64 00 A2 A0 00 00 00 03 01 01 01 D3 4A 6A 77 60 11 C7 E7 CE 3A EC 5F 03 AD 2F 8C FC 55 03 CC 00 00 00 03 00 80 C6 96 03 42 13 D7 D8 54 69 84 57 9D 1D 0F 0E A5 19 CF F8 DE FF C4 29 35 4C F3 A8 71 A6 F7 18 3F 12 28 DA 5C 74 70 C0 55 38 71 00 CB 93 5A 71 2C 4E 28 64 DF 5D 64 BA 93 FE 7E 63 E7 1F 25 B1 E5 F5 29 85 75 EB E1 C6 3A A6 17 70 69 17 91 1D C2 A7 5A C2 8B 25 1C 7E F4 0F 23 65 91 24 90 B9 39 BC A2 12 4A 30 A2 8F 54 40 2C 34 AE CA 33 1A B6 7E 1E 79 B2 85 DD 57 71 B5 D9 FF 79 EA 63 0B 75 00 00 00
0
5

SEND
24
2c-19 61, Exchange APDU SAM3 (GetCaPublicKey) VISA - 75
56 69 56 4F 74 65 63 68 32 00 2C 19 00 11 23 61 80 40 00 00 09 75 00 06 A0 00 00 00 03 01 00 00 00
0
5

SEND
25
2c-19 61, Exchange APDU SAM3 (GetRidSpecificCaPublicKey) VISA - 7B
56 69 56 4F 74 65 63 68 32 00 2C 19 00 10 23 61 80 40 00 00 08 7B 00 05 A0 00 00 00 03 00 00 00
0
5

SEND
26
2c-19 61, Exchange APDU SAM3 (SelectCaPublicKey) VISA - 61
56 69 56 4F 74 65 63 68 32 00 2C 19 00 11 23 61 80 40 00 00 09 61 00 06 A0 00 00 00 03 01 00 00 00
0
5

SEND
27
2c-19 61, Exchange APDU SAM3 (DeleteCaPublicKey) VISA - 65
56 69 56 4F 74 65 63 68 32 00 2C 19 00 11 23 61 80 40 00 00 09 65 00 06 A0 00 00 00 03 01 00 00 00
0
5

SEND
28
2c-19 61, Exchange APDU SAM3 (SetCountryCode) 08 40 - 69
56 69 56 4F 74 65 63 68 32 00 2C 19 00 0D 23 61 80 40 00 00 05 69 00 02 08 40 00 00 00
0
5

SEND
29
2c-19 61, Exchange APDU SAM3 (GetCountryCode) 08 40 - 6A
56 69 56 4F 74 65 63 68 32 00 2C 19 00 0B 23 61 80 40 00 00 03 6A 00 00 00 00 00
0
5

SEND
30
2c-19 61, Exchange APDU SAM3 (Echoback) - 6C
56 69 56 4F 74 65 63 68 32 00 2C 19 00 0B 23 61 80 40 00 00 03 6C 00 FF 00 00 00
0
5

SEND
31
2c-19 63, Exchange APDU SAM3 (Select SAM)
56 69 56 4F 74 65 63 68 32 00 2C 19 00 1D 23 63 0A FF FF 98 76 54 32 10 E0 00 03 4B 8D B1 BA 4D 62 AA 02 9B FA 02 96 BE 59 4A DD 00 00
0
5

SEND
32
2c-19 63, Exchange APDU SAM3 (SetCaPublicKey) VISA - 64
56 69 56 4F 74 65 63 68 32 00 2C 19 00 B3 23 63 00 42 CB 6E 26 6B 89 8A A3 9F 8B A8 93 DE 79 87 A6 EE EA 3E 72 4B 42 6D D6 37 CF 2D B4 DE DA 60 43 3A DD 1C D3 8C F6 79 B2 05 74 CA EE 4E AC C9 B0 98 57 B8 39 B6 F2 D0 0D E4 49 CC 03 A6 89 F8 25 F6 0A F6 E3 0D 3B 49 A5 C2 94 52 5E AB 73 A5 C5 4D 4E 1C 20 98 58 EB 41 46 2A BD F0 C4 D9 DD 38 D0 76 19 6C BD 7D 7D 49 46 38 87 EB 69 74 E7 2A F5 09 CC 7D 7C D6 E5 8F DE EC 59 4D 3C 19 93 67 8B 4E FF 8F 39 24 4B 88 C2 21 8A 03 94 62 EE 08 68 EA 90 04 1B 67 E8 82 EA 4F 09 BA 5C D5 C4 88 C8 84 6C 67 BB C0 DA 28 C6 8A 83 DA FA 69 80 44 00 00
0
5

SEND
33
2c-19 63, Exchange APDU SAM3 (GetCaPublicKey) VISA - 75
56 69 56 4F 74 65 63 68 32 00 2C 19 00 1B 23 63 00 8A B9 4B 91 8D AA 19 27 13 88 1E 61 A6 AC 20 3A A9 A1 76 57 8B 07 75 A1 00 00
0
5

SEND
34
2c-19 63, Exchange APDU SAM3 (GetRidSpecificCaPublicKey) VISA - 7B
56 69 56 4F 74 65 63 68 32 00 2C 19 00 13 23 63 00 67 DF D2 C9 C0 F5 7D 27 06 5E A9 BC 98 63 A4 56 00 00
0
5

SEND
35
2c-19 63, Exchange APDU SAM3 (SelectCaPublicKey) VISA - 61
56 69 56 4F 74 65 63 68 32 00 2C 19 00 1B 23 63 00 0A 19 A4 8F 7A 94 B2 C7 E8 E8 E4 20 19 EC 02 F4 97 D5 4F 19 37 E0 8A C2 00 00
0
5

SEND
36
2c-19 63, Exchange APDU SAM3 (DeleteCaPublicKey) VISA - 65
56 69 56 4F 74 65 63 68 32 00 2C 19 00 1B 23 63 00 41 71 C9 AA 55 62 E5 4C 39 39 FD E3 4D 5D F9 2F 60 5C 94 56 38 BD 85 71 00 00
0
5

SEND
37
2c-19 63, Exchange APDU SAM3 (SetCountryCode) 08 40 - 69
56 69 56 4F 74 65 63 68 32 00 2C 19 00 13 23 63 00 DB 3C 6A F4 82 CD 57 05 7B EF 0B 53 3B 60 E1 1B 00 00
0
5

SEND
38
2c-19 63, Exchange APDU SAM3 (GetCountryCode) 08 40 - 6A
56 69 56 4F 74 65 63 68 32 00 2C 19 00 13 23 63 00 84 6B 24 E4 33 96 35 EB 11 40 B2 2A 31 49 5A A2 00 00
0
5

SEND
39
2c-19 63, Exchange APDU SAM3 (Echoback) - 6C
56 69 56 4F 74 65 63 68 32 00 2C 19 00 13 23 63 00 B6 23 E1 AE 96 6A 55 06 FF 06 FB E2 72 62 5A 38 00 00
0
5

RECEIVE
0
erase key ok
56 69 56 4F 74 65 63 68 32 00 83 00 00 00 22 03
-1
1
COMMENT 
0
1
0
0

RECEIVE
1
load kpk ok
56 69 56 4F 74 65 63 68 32 00 80 00 00 00 B9 DF
-1
1
COMMENT 
0
1
0
0

RECEIVE
2
dukpt ok
56 69 56 4F 74 65 63 68 32 00 81 00 00 00 CF 6B
-1
1
COMMENT 
0
1
0
0

RECEIVE
3
Version 2 Protocol: Response (Status=OK)
56 69 56 4F 74 65 63 68 32 00 ?? 00 ?? ?? ?? ??
-1
1
COMMENT 
0
1
0
0

RECEIVE
4
Poll For Token SAM3
56 69 56 4F 74 65 63 68 32 00 2C 00 00 01 23 6F 8D
-1
1
COMMENT 
0
1
0
0

RECEIVE
5
Exchange APDU with SAMn to Select SAM Response (Status=OK)
56 69 56 4F 74 65 63 68 32 00 2C 00 00 27 6F 23 84 07 A0 00 00 02 99 50 10 A5 0E 50 0F 47 42 37 57 32 58 58 58 58 35 30 38 2D 56 48 2D 76 31 2E 30 2E 30 90 00 6E 6C
-1
1
COMMENT 
0
1
0
0

RECEIVE
6
Exchange APDU with SAMn Where No SAM Data Expected in Response (Status=OK)
56 69 56 4F 74 65 63 68 32 00 2C 00 00 06 00 6E 00 00 90 00 ?? ??
-1
1
COMMENT 
0
1
0
0

RECEIVE
7
Exchange APDU with SAM1 VISA - 75
56 69 56 4F 74 65 63 68 32 00 2C 00 00 A3 00 6E 01 9C 00 01 01 D3 4A 6A 77 60 11 C7 E7 CE 3A EC 5F 03 AD 2F 8C FC 55 03 CC 00 00 00 03 00 80 C6 96 03 42 13 D7 D8 54 69 84 57 9D 1D 0F 0E A5 19 CF F8 DE FF C4 29 35 4C F3 A8 71 A6 F7 18 3F 12 28 DA 5C 74 70 C0 55 38 71 00 CB 93 5A 71 2C 4E 28 64 DF 5D 64 BA 93 FE 7E 63 E7 1F 25 B1 E5 F5 29 85 75 EB E1 C6 3A A6 17 70 69 17 91 1D C2 A7 5A C2 8B 25 1C 7E F4 0F 23 65 91 24 90 B9 39 BC A2 12 4A 30 A2 8F 54 40 2C 34 AE CA 33 1A B6 7E 1E 79 B2 85 DD 57 71 B5 D9 FF 79 EA 63 0B 75 90 00 39 0F
-1
1
COMMENT 
0
1
0
0

RECEIVE
8
Exchange APDU SAM1 VISA - 7B
56 69 56 4F 74 65 63 68 32 00 2C 00 00 08 00 6E 00 02 01 01 90 00 4E 2F
-1
1
COMMENT 
0
1
0
0

RECEIVE
9
Exchange APDU SAM1 Country Code - 6A
56 69 56 4F 74 65 63 68 32 00 2C 00 00 08 00 6E 00 02 08 40 90 00 97 C5
-1
1
COMMENT 
0
1
0
0

RECEIVE
10
Exchange APDU SAM1 - 6C
56 69 56 4F 74 65 63 68 32 00 2C 00 00 FE 01 6E 00 FF 08 40 00 00 03 01 77 60 11 C7 E7 CE 3A EC 5F 03 AD 2F 8C FC 55 03 CC 00 00 00 03 00 80 C6 96 03 42 13 D7 D8 54 69 84 57 9D 1D 0F 0E A5 19 CF F8 DE FF C4 29 35 4C F3 A8 71 A6 F7 18 3F 12 28 DA 5C 74 70 C0 55 38 71 00 CB 93 5A 71 2C 4E 28 64 DF 5D 64 BA 93 FE 7E 63 E7 1F 25 B1 E5 F5 29 85 75 EB E1 C6 3A A6 17 70 69 17 91 1D C2 A7 5A C2 8B 25 1C 7E F4 0F 23 65 91 24 90 B9 39 BC A2 12 4A 30 A2 8F 54 40 2C 34 AE CA 33 1A B6 7E 1E 79 B2 85 DD 57 71 B5 D9 FF 79 EA 63 0B 75 79 EA 63 0B 75 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 90 00 FE 6B
-1
1
COMMENT 
0
1
0
0

RECEIVE
11
2c-19 61, Exchange APDU with SAMn to Select SAM Response (Status=OK)
56 69 56 4F 74 65 63 68 32 00 2C 00 ?? ?? 01 0A FF FF 98 76 54 32 10 E0 00 03 16 86 42 ED 6A 2B CC 05 7C 73 4A 83 6F DA 8F 7A BF 62 1D FE 9A 81 84 2E A1 84 38 31 1E 88 F4 8B DA F5 71 10 8C 70 F2 37 90 00 ?? ??
-1
1
COMMENT 
0
1
0
0

RECEIVE
12
2c-19 63, Exchange APDU with SAMn to Select SAM Response (Status=OK)
56 69 56 4F 74 65 63 68 32 00 2C 00 ?? ?? 01 00 16 86 42 ED 6A 2B CC 05 7C 73 4A 83 6F DA 8F 7A BF 62 1D FE 9A 81 84 2E A1 84 38 31 1E 88 F4 8B DA F5 71 10 8C 70 F2 37 90 00 ?? ??
-1
1
COMMENT 
0
1
0
0

RECEIVE
13
2c-19 61, Exchange APDU with SAMn Where No SAM Data Expected in Response (Status=OK)
56 69 56 4F 74 65 63 68 32 00 2C 00 ?? ?? 01 00 51 EE 6B 1F 56 32 AA 05 90 00 ?? ??
-1
1
COMMENT 
0
1
0
0

RECEIVE
14
2c-19 61, Exchange APDU with SAM1 VISA - 75
56 69 56 4F 74 65 63 68 32 00 2C 00 ?? ?? 01 00 E4 0A 1B F9 B9 E2 DF 96 3B 57 98 A8 52 CC F4 D7 AB ED BC BC 4F 62 1E 5F FE 82 DD 1C 2B 65 67 69 C9 FE CF B6 7F 39 18 FD 64 A8 37 23 EE 64 53 31 C3 40 76 33 06 7E 26 39 3D 10 C2 82 31 27 65 82 22 41 C0 42 C1 D1 0A 27 FA 74 9F D0 10 9E 4D 62 AA C9 0E 97 6B CD 04 00 33 1E 78 C4 D3 6B F8 4F 44 BD 15 32 24 98 35 6E 19 4A CD E7 86 FF B2 7F F5 FC 9F F4 5B 23 81 72 32 BC AE 27 F7 53 C5 AF E4 EA 70 5D CA 3A BB E9 15 29 04 62 0F 58 51 62 2D 4D 22 33 44 F8 C4 CF DD 6F 6A 03 64 6C F9 8E 33 38 8F 28 99 9F 21 E2 90 00 ?? ??
-1
1
COMMENT 
0
1
0
0

RECEIVE
15
2c-19 61, Exchange APDU SAM1 VISA - 7B
56 69 56 4F 74 65 63 68 32 00 2C 00 ?? ?? 01 00 9C 18 56 C1 B4 D3 5F 3A 90 00 ?? ??
-1
1
COMMENT 
0
1
0
0

RECEIVE
16
2c-19 61, Exchange APDU SAM1 Country Code - 6A
56 69 56 4F 74 65 63 68 32 00 2C 00 ?? ?? 01 00 E1 2E 08 0A D0 0B B2 B2 90 00 ?? ??
-1
1
COMMENT 
0
1
0
0

RECEIVE
17
2c-19 61, Exchange APDU SAM1 - 6C
56 69 56 4F 74 65 63 68 32 00 2C 00 ?? ?? 01 00 D2 95 4D A2 25 C9 EE 0A 78 B5 20 D8 57 2D 3B CB B0 EB 23 17 8B D6 B3 1E E9 DE 7B 9E 58 19 57 82 97 46 B7 CA 51 4C E5 CC DB 9C 79 7D F5 93 AC 35 43 01 60 27 E9 46 40 8C AA 59 EE 94 0E 94 33 0A FA AF 99 D7 D2 24 4C E8 EA B2 C5 F4 3E 34 3F 51 38 02 26 7A C2 17 9C 99 9F 4C 8C EB 9B FE F9 4A C1 A5 89 F8 11 83 5E 89 44 1E E4 2E 0E A4 EA 9A 44 6F 26 13 AC 83 F0 5B A9 07 42 24 46 56 83 A3 BB 07 BD BF 77 C9 EE 0E F1 8B 59 A4 11 72 8A 8B C0 C0 EA C1 87 E3 B3 FE 1E 8E DC 01 41 F1 2B D7 ED 3A 2E 79 8A FA D4 73 C3 C4 8B 3E CA AA 36 19 49 85 01 90 B9 61 C1 EC 53 99 F4 35 4A 61 E9 F9 CA B2 47 7E 78 F8 66 81 1B 86 0D AE 15 4F 9D 42 02 A0 D1 35 90 5C EC 4B 35 F5 91 64 08 FF EA 74 D7 35 CA 6B 54 2B 73 09 50 D0 FC 17 00 1D C5 D9 39 78 A1 7B 41 D3 64 BF 0A 0D 9A 65 F1 37 37 4E 90 00 ?? ??
-1
1
COMMENT 
0
1
0
0

