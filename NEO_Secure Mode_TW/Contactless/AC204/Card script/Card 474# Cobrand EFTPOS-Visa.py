#Card 474# Cobrand EFTPOS-Visa.py
#Load CAP, load CAP process
import sys
import time
import System
DL.pyresult = False

C2C03CAP = []
C2C03CAP.append(['Install CAP', '80 E6 02 00 13 0E 32 50 41 59 2E 53 59 53 2E 44 44 46 30 31 00 00 00 00 01', '90 00'])


C2C03CAP.append(['Uploadding CAP', '80 E8 00 00 FA C4 82 1D 4E 01 00 1E DE CA FF ED 02 02 04 00 01 0E 32 50 41 59 2E 53 59 53 2E 44 44 46 30 31 05 6D 63 70 6B 67 02 00 21 00 1E 00 21 00 13 00 15 00 6E 00 0E 1B B7 00 0A 00 8F 00 00 01 09 05 8B 00 00 00 00 00 00 02 01 00 04 00 15 02 03 01 07 A0 00 00 00 62 01 01 00 01 07 A0 00 00 00 62 00 01 03 00 13 01 0F 32 50 41 59 2E 53 59 53 2E 44 44 46 30 31 00 19 B2 06 00 0E 00 00 00 80 03 0D 00 0C 07 01 00 00 19 C6 07 1B B7 00 05 10 18 8C 00 0D 18 03 88 00 18 10 4F 90 0B 3D 03 10 6F 38 3D 04 10 4D 38 3D 05 10 84 38 3D 06 10 0E 38 3D 07 10 32 38 3D 08 10 50 38 3D 10 06 10 41 38 3D 10 07 10 59 38 3D 10 08 10 2E 38 3D 10 09 10 53 38 3D 10 0A 10 59 38 3D 10 0B 10 53 38 3D 10 0C 10 2E 38 3D 10 0D 10 44 38 3D 10 0E 10 44 38 3D 10 0F 10 46 38 3D 10 10 10 30 01', '90 00'])


C2C03CAP.append(['Uploadding CAP', '80 E8 00 01 FA 38 3D 10 11 10 31 38 3D 10 12 10 A5 38 3D 10 13 10 3B 38 3D 10 14 10 BF 38 3D 10 15 10 0C 38 3D 10 16 10 38 38 3D 10 17 10 61 38 3D 10 18 10 17 38 3D 10 19 10 4F 38 3D 10 1A 10 06 38 3D 10 1B 10 A0 38 3D 10 1C 03 38 3D 10 1D 03 38 3D 10 1E 06 38 3D 10 1F 10 84 38 3D 10 20 10 10 38 3D 10 21 10 50 38 3D 10 22 10 0A 38 3D 10 23 10 65 38 3D 10 24 10 66 38 3D 10 25 10 74 38 3D 10 26 10 70 38 3D 10 27 10 6F 38 3D 10 28 10 73 38 3D 10 29 10 20 38 3D 10 2A 10 53 38 3D 10 2B 10 41 38 3D 10 2C 10 56 38 3D 10 2D 10 87 38 3D 10 2E 04 38 3D 10 2F 05 38 3D 10 30 10 61 38 3D 10 31 10 18 38 3D 10 32 10 4F 38 3D 10 33 10 07 38 3D 10 34 10 A0 38 3D 10 35 03 38 3D 10 36 03 38 3D 10 37 03 38 3D 10 38 06 38 3D 10 39 10 10 38 3D 10 3A 10 10 38 3D 10 3B 10 50 38 01', '90 00'])


C2C03CAP.append(['Uploadding CAP', '80 E8 00 02 FA 3D 10 3C 10 0A 38 3D 10 3D 10 56 38 3D 10 3E 10 69 38 3D 10 3F 10 73 38 3D 10 40 10 61 38 3D 10 41 10 20 38 3D 10 42 10 44 38 3D 10 43 10 65 38 3D 10 44 10 62 38 3D 10 45 10 69 38 3D 10 46 10 74 38 3D 10 47 10 87 38 3D 10 48 04 38 3D 10 49 04 38 3D 10 4A 10 42 38 3D 10 4B 06 38 3D 10 4C 10 43 38 3D 10 4D 10 49 38 3D 10 4E 10 68 38 87 01 18 10 3C 90 0B 3D 03 10 6F 38 3D 04 10 3A 38 3D 05 10 84 38 3D 06 10 06 38 3D 07 10 A0 38 3D 08 03 38 3D 10 06 03 38 3D 10 07 06 38 3D 10 08 10 84 38 3D 10 09 10 10 38 3D 10 0A 10 A5 38 3D 10 0B 10 30 38 3D 10 0C 10 50 38 3D 10 0D 10 0A 38 3D 10 0E 10 65 38 3D 10 0F 10 66 38 3D 10 10 10 74 38 3D 10 11 10 70 38 3D 10 12 10 6F 38 3D 10 13 10 73 38 3D 10 14 10 20 38 3D 10 15 10 53 38 3D 10 16 10 41 38 3D 10 17 01', '90 00'])


C2C03CAP.append(['Uploadding CAP', '80 E8 00 03 FA 10 56 38 3D 10 18 10 5F 38 3D 10 19 10 2D 38 3D 10 1A 05 38 3D 10 1B 10 65 38 3D 10 1C 10 6E 38 3D 10 1D 10 9F 38 3D 10 1E 10 38 38 3D 10 1F 10 14 38 3D 10 20 10 9F 38 3D 10 21 05 38 3D 10 22 10 06 38 3D 10 23 10 5F 38 3D 10 24 10 2A 38 3D 10 25 05 38 3D 10 26 10 9C 38 3D 10 27 04 38 3D 10 28 10 9F 38 3D 10 29 06 38 3D 10 2A 10 06 38 3D 10 2B 10 9F 38 3D 10 2C 10 35 38 3D 10 2D 04 38 3D 10 2E 10 9F 38 3D 10 2F 10 33 38 3D 10 30 06 38 3D 10 31 10 9F 38 3D 10 32 10 15 38 3D 10 33 05 38 3D 10 34 10 BF 38 3D 10 35 10 0C 38 3D 10 36 08 38 3D 10 37 10 42 38 3D 10 38 06 38 3D 10 39 10 43 38 3D 10 3A 10 49 38 3D 10 3B 10 68 38 87 02 18 10 44 90 0B 3D 03 10 6F 38 3D 04 10 42 38 3D 05 10 84 38 3D 06 10 07 38 3D 07 10 A0 38 3D 08 03 38 3D 10 06 03 38 01', '90 00'])


C2C03CAP.append(['Uploadding CAP', '80 E8 00 04 FA 3D 10 07 03 38 3D 10 08 06 38 3D 10 09 10 10 38 3D 10 0A 10 10 38 3D 10 0B 10 A5 38 3D 10 0C 10 37 38 3D 10 0D 10 50 38 3D 10 0E 10 0A 38 3D 10 0F 10 56 38 3D 10 10 10 69 38 3D 10 11 10 73 38 3D 10 12 10 61 38 3D 10 13 10 20 38 3D 10 14 10 44 38 3D 10 15 10 65 38 3D 10 16 10 62 38 3D 10 17 10 69 38 3D 10 18 10 74 38 3D 10 19 10 5F 38 3D 10 1A 10 2D 38 3D 10 1B 05 38 3D 10 1C 10 65 38 3D 10 1D 10 6E 38 3D 10 1E 10 9F 38 3D 10 1F 10 38 38 3D 10 20 10 18 38 3D 10 21 10 9F 38 3D 10 22 10 66 38 3D 10 23 07 38 3D 10 24 10 9F 38 3D 10 25 05 38 3D 10 26 10 06 38 3D 10 27 10 9F 38 3D 10 28 06 38 3D 10 29 10 06 38 3D 10 2A 10 9F 38 3D 10 2B 10 1A 38 3D 10 2C 05 38 3D 10 2D 10 95 38 3D 10 2E 08 38 3D 10 2F 10 5F 38 3D 10 30 10 2A 38 3D 10 31 05 38 3D 01', '90 00'])


C2C03CAP.append(['Uploadding CAP', '80 E8 00 05 FA 10 32 10 9A 38 3D 10 33 06 38 3D 10 34 10 9C 38 3D 10 35 04 38 3D 10 36 10 9F 38 3D 10 37 10 37 38 3D 10 38 07 38 3D 10 39 10 BF 38 3D 10 3A 10 0C 38 3D 10 3B 10 08 38 3D 10 3C 10 9F 38 3D 10 3D 10 5A 38 3D 10 3E 08 38 3D 10 3F 10 40 38 3D 10 40 03 38 3D 10 41 10 36 38 3D 10 42 03 38 3D 10 43 10 36 38 87 03 18 10 10 90 0B 3D 03 10 77 38 3D 04 10 0E 38 3D 05 10 82 38 3D 06 05 38 3D 07 10 18 38 3D 08 03 38 3D 10 06 10 94 38 3D 10 07 10 08 38 3D 10 08 10 08 38 3D 10 09 04 38 3D 10 0A 06 38 3D 10 0B 05 38 3D 10 0C 10 08 38 3D 10 0D 07 38 3D 10 0E 08 38 3D 10 0F 03 38 87 04 18 10 4B 90 0B 3D 03 10 77 38 3D 04 10 49 38 3D 05 10 82 38 3D 06 05 38 3D 07 03 38 3D 08 10 20 38 3D 10 06 10 94 38 3D 10 07 07 38 3D 10 08 10 10 38 3D 10 09 06 38 3D 10 0A 01', '90 00'])


C2C03CAP.append(['Uploadding CAP', '80 E8 00 06 FA 06 38 3D 10 0B 03 38 3D 10 0C 10 57 38 3D 10 0D 10 11 38 3D 10 0E 10 43 38 3D 10 0F 10 49 38 3D 10 10 10 68 38 3D 10 11 10 10 38 3D 10 12 04 38 3D 10 13 10 62 38 3D 10 14 10 10 38 3D 10 15 10 27 38 3D 10 16 10 D3 38 3D 10 17 10 10 38 3D 10 18 10 52 38 3D 10 19 04 38 3D 10 1A 03 38 3D 10 1B 03 38 3D 10 1C 06 38 3D 10 1D 10 73 38 3D 10 1E 10 1F 38 3D 10 1F 10 5F 38 3D 10 20 10 20 38 3D 10 21 05 38 3D 10 22 10 20 38 3D 10 23 10 2F 38 3D 10 24 10 5F 38 3D 10 25 10 34 38 3D 10 26 04 38 3D 10 27 03 38 3D 10 28 10 9F 38 3D 10 29 10 10 38 3D 10 2A 10 07 38 3D 10 2B 10 06 38 3D 10 2C 04 38 3D 10 2D 10 12 38 3D 10 2E 06 38 3D 10 2F 10 A0 38 3D 10 30 03 38 3D 10 31 03 38 3D 10 32 10 9F 38 3D 10 33 10 26 38 3D 10 34 10 08 38 3D 10 35 10 D1 38 3D 10 36 01', '90 00'])


C2C03CAP.append(['Uploadding CAP', '80 E8 00 07 FA 10 84 38 3D 10 37 10 47 38 3D 10 38 10 88 38 3D 10 39 10 1C 38 3D 10 3A 10 C1 38 3D 10 3B 10 79 38 3D 10 3C 10 CF 38 3D 10 3D 10 9F 38 3D 10 3E 10 27 38 3D 10 3F 04 38 3D 10 40 10 80 38 3D 10 41 10 9F 38 3D 10 42 10 36 38 3D 10 43 05 38 3D 10 44 03 38 3D 10 45 10 20 38 3D 10 46 10 9F 38 3D 10 47 10 6C 38 3D 10 48 05 38 3D 10 49 10 30 38 3D 10 4A 03 38 87 05 18 10 2A 90 0B 3D 03 10 70 38 3D 04 10 28 38 3D 05 10 5A 38 3D 06 10 08 38 3D 07 10 43 38 3D 08 10 49 38 3D 10 06 10 68 38 3D 10 07 10 10 38 3D 10 08 04 38 3D 10 09 10 62 38 3D 10 0A 10 10 38 3D 10 0B 10 27 38 3D 10 0C 10 5F 38 3D 10 0D 10 34 38 3D 10 0E 04 38 3D 10 0F 03 38 3D 10 10 10 5F 38 3D 10 11 10 24 38 3D 10 12 06 38 3D 10 13 10 31 38 3D 10 14 08 38 3D 10 15 10 31 38 3D 10 16 10 01', '90 00'])


C2C03CAP.append(['Uploadding CAP', '80 E8 00 08 FA 5F 38 3D 10 17 10 25 38 3D 10 18 06 38 3D 10 19 10 21 38 3D 10 1A 08 38 3D 10 1B 04 38 3D 10 1C 10 5F 38 3D 10 1D 10 28 38 3D 10 1E 05 38 3D 10 1F 03 38 3D 10 20 10 36 38 3D 10 21 10 9F 38 3D 10 22 10 42 38 3D 10 23 05 38 3D 10 24 03 38 3D 10 25 10 36 38 3D 10 26 10 9F 38 3D 10 27 10 44 38 3D 10 28 04 38 3D 10 29 05 38 87 06 18 10 48 90 0B 3D 03 10 70 38 3D 04 10 46 38 3D 05 10 9F 38 3D 06 10 07 38 3D 07 05 38 3D 08 10 29 38 3D 10 06 03 38 3D 10 07 10 8E 38 3D 10 08 10 0C 38 3D 10 09 03 38 3D 10 0A 03 38 3D 10 0B 10 27 38 3D 10 0C 10 10 38 3D 10 0D 03 38 3D 10 0E 03 38 3D 10 0F 03 38 3D 10 10 03 38 3D 10 11 10 5F 38 3D 10 12 10 06 38 3D 10 13 05 38 3D 10 14 03 38 3D 10 15 10 9F 38 3D 10 16 10 0D 38 3D 10 17 08 38 3D 10 18 10 B0 38 3D 10 19 01', '90 00'])


C2C03CAP.append(['Uploadding CAP', '80 E8 00 09 FA 10 40 38 3D 10 1A 10 94 38 3D 10 1B 10 08 38 3D 10 1C 03 38 3D 10 1D 10 9F 38 3D 10 1E 10 0E 38 3D 10 1F 08 38 3D 10 20 10 06 38 3D 10 21 10 10 38 3D 10 22 10 08 38 3D 10 23 03 38 3D 10 24 03 38 3D 10 25 10 9F 38 3D 10 26 10 0F 38 3D 10 27 08 38 3D 10 28 10 B0 38 3D 10 29 10 60 38 3D 10 2A 10 D4 38 3D 10 2B 10 98 38 3D 10 2C 03 38 3D 10 2D 10 8C 38 3D 10 2E 10 15 38 3D 10 2F 10 9F 38 3D 10 30 05 38 3D 10 31 10 06 38 3D 10 32 10 9F 38 3D 10 33 06 38 3D 10 34 10 06 38 3D 10 35 10 9F 38 3D 10 36 10 1A 38 3D 10 37 05 38 3D 10 38 10 95 38 3D 10 39 08 38 3D 10 3A 10 5F 38 3D 10 3B 10 2A 38 3D 10 3C 05 38 3D 10 3D 10 9A 38 3D 10 3E 06 38 3D 10 3F 10 9C 38 3D 10 40 04 38 3D 10 41 10 9F 38 3D 10 42 10 37 38 3D 10 43 07 38 3D 10 44 10 9F 38 3D 10 45 01', '90 00'])


C2C03CAP.append(['Uploadding CAP', '80 E8 00 0A FA 10 4A 38 3D 10 46 04 38 3D 10 47 10 82 38 87 07 18 10 25 90 0B 3D 03 10 70 38 3D 04 10 23 38 3D 05 10 57 38 3D 06 10 11 38 3D 07 10 43 38 3D 08 10 49 38 3D 10 06 10 68 38 3D 10 07 10 10 38 3D 10 08 04 38 3D 10 09 10 62 38 3D 10 0A 10 10 38 3D 10 0B 10 27 38 3D 10 0C 10 D3 38 3D 10 0D 10 10 38 3D 10 0E 10 52 38 3D 10 0F 04 38 3D 10 10 03 38 3D 10 11 03 38 3D 10 12 06 38 3D 10 13 10 73 38 3D 10 14 10 1F 38 3D 10 15 10 9F 38 3D 10 16 10 08 38 3D 10 17 05 38 3D 10 18 04 38 3D 10 19 03 38 3D 10 1A 10 8F 38 3D 10 1B 04 38 3D 10 1C 06 38 3D 10 1D 10 9F 38 3D 10 1E 10 32 38 3D 10 1F 04 38 3D 10 20 06 38 3D 10 21 10 9F 38 3D 10 22 10 47 38 3D 10 23 04 38 3D 10 24 06 38 87 08 18 11 00 FE 90 0B 3D 03 10 70 38 3D 04 10 81 38 3D 05 10 FB 38 3D 06 10 90 01', '90 00'])


C2C03CAP.append(['Uploadding CAP', '80 E8 00 0B FA 38 3D 07 10 81 38 3D 08 10 F8 38 3D 10 06 10 49 38 3D 10 07 10 20 38 3D 10 08 10 CF 38 3D 10 09 10 B4 38 3D 10 0A 10 F2 38 3D 10 0B 07 38 3D 10 0C 10 83 38 3D 10 0D 10 E5 38 3D 10 0E 10 24 38 3D 10 0F 10 8C 38 3D 10 10 04 38 3D 10 11 10 78 38 3D 10 12 10 20 38 3D 10 13 10 0D 38 3D 10 14 10 10 38 3D 10 15 10 E1 38 3D 10 16 10 1E 38 3D 10 17 10 E9 38 3D 10 18 10 E5 38 3D 10 19 10 CA 38 3D 10 1A 10 5E 38 3D 10 1B 10 64 38 3D 10 1C 10 95 38 3D 10 1D 10 EA 38 3D 10 1E 10 BE 38 3D 10 1F 10 B3 38 3D 10 20 10 73 38 3D 10 21 10 E8 38 3D 10 22 10 40 38 3D 10 23 10 F4 38 3D 10 24 10 E0 38 3D 10 25 10 42 38 3D 10 26 10 97 38 3D 10 27 10 5C 38 3D 10 28 10 B4 38 3D 10 29 10 34 38 3D 10 2A 10 62 38 3D 10 2B 10 EC 38 3D 10 2C 10 D3 38 3D 10 2D 10 16 38 3D 01', '90 00'])


C2C03CAP.append(['Uploadding CAP', '80 E8 00 0C FA 10 2E 10 7D 38 3D 10 2F 10 C7 38 3D 10 30 10 82 38 3D 10 31 10 3E 38 3D 10 32 10 B9 38 3D 10 33 10 CB 38 3D 10 34 10 C8 38 3D 10 35 05 38 3D 10 36 10 94 38 3D 10 37 10 AA 38 3D 10 38 10 A4 38 3D 10 39 10 44 38 3D 10 3A 10 0F 38 3D 10 3B 10 45 38 3D 10 3C 10 55 38 3D 10 3D 10 A8 38 3D 10 3E 10 D3 38 3D 10 3F 10 96 38 3D 10 40 10 60 38 3D 10 41 10 2F 38 3D 10 42 10 8F 38 3D 10 43 10 14 38 3D 10 44 10 8E 38 3D 10 45 10 2E 38 3D 10 46 10 25 38 3D 10 47 10 4D 38 3D 10 48 10 EC 38 3D 10 49 10 3C 38 3D 10 4A 10 7D 38 3D 10 4B 10 DB 38 3D 10 4C 10 B6 38 3D 10 4D 10 D1 38 3D 10 4E 10 BC 38 3D 10 4F 10 39 38 3D 10 50 10 E2 38 3D 10 51 10 B3 38 3D 10 52 10 97 38 3D 10 53 10 57 38 3D 10 54 10 1D 38 3D 10 55 10 6E 38 3D 10 56 10 64 38 3D 10 57 10 06 38 01', '90 00'])


C2C03CAP.append(['Uploadding CAP', '80 E8 00 0D FA 3D 10 58 10 C1 38 3D 10 59 10 74 38 3D 10 5A 10 CF 38 3D 10 5B 10 B7 38 3D 10 5C 10 DF 38 3D 10 5D 10 F1 38 3D 10 5E 10 4D 38 3D 10 5F 10 F2 38 3D 10 60 10 E6 38 3D 10 61 10 B0 38 3D 10 62 10 6C 38 3D 10 63 10 E8 38 3D 10 64 10 D4 38 3D 10 65 10 72 38 3D 10 66 05 38 3D 10 67 10 42 38 3D 10 68 10 55 38 3D 10 69 10 D0 38 3D 10 6A 10 A8 38 3D 10 6B 10 7D 38 3D 10 6C 10 C8 38 3D 10 6D 10 BA 38 3D 10 6E 10 76 38 3D 10 6F 10 55 38 3D 10 70 10 0D 38 3D 10 71 10 5E 38 3D 10 72 10 15 38 3D 10 73 10 21 38 3D 10 74 10 44 38 3D 10 75 10 13 38 3D 10 76 10 8F 38 3D 10 77 10 BC 38 3D 10 78 10 84 38 3D 10 79 10 56 38 3D 10 7A 10 8E 38 3D 10 7B 10 6F 38 3D 10 7C 10 0C 38 3D 10 7D 10 83 38 3D 10 7E 10 4A 38 3D 10 7F 10 C5 38 3D 11 00 80 10 44 38 3D 11 00 81 01', '90 00'])


C2C03CAP.append(['Uploadding CAP', '80 E8 00 0E FA 10 DA 38 3D 11 00 82 10 62 38 3D 11 00 83 04 38 3D 11 00 84 10 74 38 3D 11 00 85 10 C1 38 3D 11 00 86 10 B4 38 3D 11 00 87 10 A1 38 3D 11 00 88 10 6A 38 3D 11 00 89 10 35 38 3D 11 00 8A 10 F0 38 3D 11 00 8B 10 35 38 3D 11 00 8C 10 8E 38 3D 11 00 8D 10 28 38 3D 11 00 8E 10 7C 38 3D 11 00 8F 10 79 38 3D 11 00 90 10 D6 38 3D 11 00 91 10 5C 38 3D 11 00 92 10 46 38 3D 11 00 93 10 DF 38 3D 11 00 94 10 06 38 3D 11 00 95 10 79 38 3D 11 00 96 10 80 38 3D 11 00 97 10 8B 38 3D 11 00 98 10 A8 38 3D 11 00 99 10 11 38 3D 11 00 9A 10 B3 38 3D 11 00 9B 10 CD 38 3D 11 00 9C 10 A5 38 3D 11 00 9D 10 2F 38 3D 11 00 9E 10 DC 38 3D 11 00 9F 10 D3 38 3D 11 00 A0 10 EF 38 3D 11 00 A1 10 B7 38 3D 11 00 A2 10 8A 38 3D 11 00 A3 10 A6 38 3D 11 00 A4 10 67 38 3D 11 00 01', '90 00'])


C2C03CAP.append(['Uploadding CAP', '80 E8 00 0F FA A5 10 E1 38 3D 11 00 A6 10 82 38 3D 11 00 A7 10 62 38 3D 11 00 A8 10 D4 38 3D 11 00 A9 10 9A 38 3D 11 00 AA 10 39 38 3D 11 00 AB 10 B4 38 3D 11 00 AC 10 FB 38 3D 11 00 AD 10 7C 38 3D 11 00 AE 10 F9 38 3D 11 00 AF 10 88 38 3D 11 00 B0 10 AC 38 3D 11 00 B1 10 1F 38 3D 11 00 B2 10 A0 38 3D 11 00 B3 10 88 38 3D 11 00 B4 10 31 38 3D 11 00 B5 10 D1 38 3D 11 00 B6 10 33 38 3D 11 00 B7 10 A5 38 3D 11 00 B8 10 34 38 3D 11 00 B9 10 72 38 3D 11 00 BA 10 3D 38 3D 11 00 BB 10 BB 38 3D 11 00 BC 10 C8 38 3D 11 00 BD 10 62 38 3D 11 00 BE 10 10 38 3D 11 00 BF 10 3C 38 3D 11 00 C0 10 9C 38 3D 11 00 C1 10 3E 38 3D 11 00 C2 10 60 38 3D 11 00 C3 10 52 38 3D 11 00 C4 02 38 3D 11 00 C5 10 D0 38 3D 11 00 C6 10 93 38 3D 11 00 C7 10 90 38 3D 11 00 C8 10 35 38 3D 11 01', '90 00'])


C2C03CAP.append(['Uploadding CAP', '80 E8 00 10 FA 00 C9 10 E0 38 3D 11 00 CA 10 ED 38 3D 11 00 CB 10 10 38 3D 11 00 CC 10 25 38 3D 11 00 CD 10 57 38 3D 11 00 CE 10 E3 38 3D 11 00 CF 10 43 38 3D 11 00 D0 10 FE 38 3D 11 00 D1 10 9A 38 3D 11 00 D2 10 A0 38 3D 11 00 D3 10 FC 38 3D 11 00 D4 10 5C 38 3D 11 00 D5 10 28 38 3D 11 00 D6 10 D2 38 3D 11 00 D7 10 22 38 3D 11 00 D8 10 B7 38 3D 11 00 D9 10 95 38 3D 11 00 DA 10 75 38 3D 11 00 DB 10 64 38 3D 11 00 DC 10 30 38 3D 11 00 DD 10 A6 38 3D 11 00 DE 10 4D 38 3D 11 00 DF 10 71 38 3D 11 00 E0 10 DF 38 3D 11 00 E1 10 CE 38 3D 11 00 E2 10 0B 38 3D 11 00 E3 10 78 38 3D 11 00 E4 10 7A 38 3D 11 00 E5 03 38 3D 11 00 E6 10 B0 38 3D 11 00 E7 10 BA 38 3D 11 00 E8 10 35 38 3D 11 00 E9 10 B6 38 3D 11 00 EA 10 99 38 3D 11 00 EB 10 CB 38 3D 11 00 EC 10 C6 38 3D 01', '90 00'])


C2C03CAP.append(['Uploadding CAP', '80 E8 00 11 FA 11 00 ED 10 88 38 3D 11 00 EE 10 DA 38 3D 11 00 EF 10 CB 38 3D 11 00 F0 10 CE 38 3D 11 00 F1 10 69 38 3D 11 00 F2 10 70 38 3D 11 00 F3 10 C2 38 3D 11 00 F4 10 72 38 3D 11 00 F5 10 A9 38 3D 11 00 F6 07 38 3D 11 00 F7 10 53 38 3D 11 00 F8 10 B1 38 3D 11 00 F9 10 3F 38 3D 11 00 FA 10 DE 38 3D 11 00 FB 10 D9 38 3D 11 00 FC 10 E1 38 3D 11 00 FD 10 C2 38 87 09 18 11 00 BC 90 0B 3D 03 10 70 38 3D 04 10 81 38 3D 05 10 B9 38 3D 06 10 9F 38 3D 07 10 46 38 3D 08 10 81 38 3D 10 06 10 B0 38 3D 10 07 10 D1 38 3D 10 08 10 E8 38 3D 10 09 10 18 38 3D 10 0A 10 D9 38 3D 10 0B 10 76 38 3D 10 0C 10 7D 38 3D 10 0D 10 F5 38 3D 10 0E 10 23 38 3D 10 0F 10 B4 38 3D 10 10 10 61 38 3D 10 11 10 B1 38 3D 10 12 10 5F 38 3D 10 13 10 37 38 3D 10 14 10 5D 38 3D 10 15 10 5C 01', '90 00'])


C2C03CAP.append(['Uploadding CAP', '80 E8 00 12 FA 38 3D 10 16 10 92 38 3D 10 17 10 16 38 3D 10 18 10 A5 38 3D 10 19 10 FB 38 3D 10 1A 10 BE 38 3D 10 1B 10 E8 38 3D 10 1C 10 5B 38 3D 10 1D 10 9B 38 3D 10 1E 10 52 38 3D 10 1F 10 2D 38 3D 10 20 10 5E 38 3D 10 21 10 BC 38 3D 10 22 10 EE 38 3D 10 23 10 B9 38 3D 10 24 10 A1 38 3D 10 25 10 C7 38 3D 10 26 10 7B 38 3D 10 27 10 4C 38 3D 10 28 10 1F 38 3D 10 29 10 9D 38 3D 10 2A 10 10 38 3D 10 2B 10 93 38 3D 10 2C 10 CA 38 3D 10 2D 10 DD 38 3D 10 2E 10 74 38 3D 10 2F 10 A0 38 3D 10 30 10 CE 38 3D 10 31 10 7E 38 3D 10 32 10 52 38 3D 10 33 10 55 38 3D 10 34 10 23 38 3D 10 35 10 5C 38 3D 10 36 08 38 3D 10 37 10 3D 38 3D 10 38 10 DB 38 3D 10 39 10 BA 38 3D 10 3A 10 77 38 3D 10 3B 10 1F 38 3D 10 3C 07 38 3D 10 3D 10 3C 38 3D 10 3E 10 B9 38 3D 10 3F 10 A8 01', '90 00'])


C2C03CAP.append(['Uploadding CAP', '80 E8 00 13 FA 38 3D 10 40 10 6E 38 3D 10 41 10 C9 38 3D 10 42 10 2E 38 3D 10 43 10 71 38 3D 10 44 10 AE 38 3D 10 45 10 77 38 3D 10 46 10 1E 38 3D 10 47 10 28 38 3D 10 48 10 5A 38 3D 10 49 10 69 38 3D 10 4A 10 34 38 3D 10 4B 10 61 38 3D 10 4C 10 B5 38 3D 10 4D 10 F8 38 3D 10 4E 10 EB 38 3D 10 4F 10 99 38 3D 10 50 10 68 38 3D 10 51 10 6A 38 3D 10 52 10 87 38 3D 10 53 10 2A 38 3D 10 54 10 11 38 3D 10 55 10 6B 38 3D 10 56 10 85 38 3D 10 57 10 43 38 3D 10 58 10 9B 38 3D 10 59 10 06 38 3D 10 5A 10 DF 38 3D 10 5B 10 9D 38 3D 10 5C 10 59 38 3D 10 5D 10 E7 38 3D 10 5E 10 15 38 3D 10 5F 10 DE 38 3D 10 60 10 47 38 3D 10 61 10 7E 38 3D 10 62 10 3D 38 3D 10 63 10 6A 38 3D 10 64 10 9D 38 3D 10 65 10 D1 38 3D 10 66 10 F3 38 3D 10 67 10 13 38 3D 10 68 10 BC 38 3D 10 69 01', '90 00'])


C2C03CAP.append(['Uploadding CAP', '80 E8 00 14 FA 10 0D 38 3D 10 6A 10 38 38 3D 10 6B 10 4D 38 3D 10 6C 10 1B 38 3D 10 6D 10 F6 38 3D 10 6E 10 12 38 3D 10 6F 10 86 38 3D 10 70 10 10 38 3D 10 71 10 6E 38 3D 10 72 10 74 38 3D 10 73 10 FC 38 3D 10 74 10 3C 38 3D 10 75 10 60 38 3D 10 76 10 D1 38 3D 10 77 10 6B 38 3D 10 78 10 87 38 3D 10 79 10 BA 38 3D 10 7A 10 5B 38 3D 10 7B 10 74 38 3D 10 7C 10 F4 38 3D 10 7D 10 DB 38 3D 10 7E 10 B6 38 3D 10 7F 10 73 38 3D 11 00 80 10 25 38 3D 11 00 81 10 3E 38 3D 11 00 82 10 8A 38 3D 11 00 83 10 73 38 3D 11 00 84 10 60 38 3D 11 00 85 10 BD 38 3D 11 00 86 10 B1 38 3D 11 00 87 10 F7 38 3D 11 00 88 10 A0 38 3D 11 00 89 10 34 38 3D 11 00 8A 10 83 38 3D 11 00 8B 10 D8 38 3D 11 00 8C 10 AE 38 3D 11 00 8D 10 A3 38 3D 11 00 8E 10 78 38 3D 11 00 8F 10 3D 38 3D 11 00 01', '90 00'])


C2C03CAP.append(['Uploadding CAP', '80 E8 00 15 FA 90 10 2F 38 3D 11 00 91 10 97 38 3D 11 00 92 10 38 38 3D 11 00 93 10 48 38 3D 11 00 94 10 47 38 3D 11 00 95 10 53 38 3D 11 00 96 10 90 38 3D 11 00 97 10 AD 38 3D 11 00 98 10 44 38 3D 11 00 99 10 D4 38 3D 11 00 9A 10 C3 38 3D 11 00 9B 10 F5 38 3D 11 00 9C 10 6F 38 3D 11 00 9D 10 47 38 3D 11 00 9E 10 DF 38 3D 11 00 9F 10 1B 38 3D 11 00 A0 10 16 38 3D 11 00 A1 10 DE 38 3D 11 00 A2 10 2A 38 3D 11 00 A3 10 AC 38 3D 11 00 A4 10 86 38 3D 11 00 A5 10 99 38 3D 11 00 A6 10 BF 38 3D 11 00 A7 10 F6 38 3D 11 00 A8 10 7F 38 3D 11 00 A9 10 E1 38 3D 11 00 AA 10 5A 38 3D 11 00 AB 10 DB 38 3D 11 00 AC 10 8F 38 3D 11 00 AD 10 7D 38 3D 11 00 AE 10 4A 38 3D 11 00 AF 10 2D 38 3D 11 00 B0 10 3A 38 3D 11 00 B1 10 90 38 3D 11 00 B2 10 CB 38 3D 11 00 B3 10 E7 38 3D 01', '90 00'])


C2C03CAP.append(['Uploadding CAP', '80 E8 00 16 FA 11 00 B4 10 B2 38 3D 11 00 B5 10 3D 38 3D 11 00 B6 10 50 38 3D 11 00 B7 10 5F 38 3D 11 00 B8 10 20 38 3D 11 00 B9 05 38 3D 11 00 BA 10 20 38 3D 11 00 BB 10 2F 38 87 0A 18 10 13 90 0B 3D 03 10 70 38 3D 04 10 11 38 3D 05 10 9F 38 3D 06 10 07 38 3D 07 05 38 3D 08 10 C0 38 3D 10 06 03 38 3D 10 07 10 5F 38 3D 10 08 10 28 38 3D 10 09 05 38 3D 10 0A 03 38 3D 10 0B 10 36 38 3D 10 0C 10 9F 38 3D 10 0D 10 6E 38 3D 10 0E 07 38 3D 10 0F 10 20 38 3D 10 10 10 70 38 3D 10 11 03 38 3D 10 12 03 38 87 0B 18 11 00 AD 90 0B 3D 03 10 77 38 3D 04 10 81 38 3D 05 10 AA 38 3D 06 10 9F 38 3D 07 10 27 38 3D 08 04 38 3D 10 06 10 80 38 3D 10 07 10 9F 38 3D 10 08 10 36 38 3D 10 09 05 38 3D 10 0A 03 38 3D 10 0B 10 1E 38 3D 10 0C 10 9F 38 3D 10 0D 10 4B 38 3D 10 0E 10 70 01', '90 00'])


C2C03CAP.append(['Uploadding CAP', '80 E8 00 17 FA 38 3D 10 0F 10 76 38 3D 10 10 10 F3 38 3D 10 11 10 96 38 3D 10 12 10 09 38 3D 10 13 10 70 38 3D 10 14 10 33 38 3D 10 15 10 A2 38 3D 10 16 10 EE 38 3D 10 17 10 F2 38 3D 10 18 10 9E 38 3D 10 19 10 ED 38 3D 10 1A 10 DA 38 3D 10 1B 10 53 38 3D 10 1C 10 F4 38 3D 10 1D 10 85 38 3D 10 1E 10 17 38 3D 10 1F 10 18 38 3D 10 20 10 15 38 3D 10 21 10 F8 38 3D 10 22 10 19 38 3D 10 23 10 6A 38 3D 10 24 10 D8 38 3D 10 25 10 38 38 3D 10 26 10 B2 38 3D 10 27 10 C2 38 3D 10 28 10 4D 38 3D 10 29 10 B7 38 3D 10 2A 10 FC 38 3D 10 2B 10 AF 38 3D 10 2C 10 D8 38 3D 10 2D 10 CE 38 3D 10 2E 10 0A 38 3D 10 2F 10 BC 38 3D 10 30 10 D4 38 3D 10 31 10 11 38 3D 10 32 10 7E 38 3D 10 33 10 45 38 3D 10 34 10 2B 38 3D 10 35 10 2F 38 3D 10 36 10 60 38 3D 10 37 10 94 38 3D 10 38 01', '90 00'])


C2C03CAP.append(['Uploadding CAP', '80 E8 00 18 FA 10 0F 38 3D 10 39 10 D7 38 3D 10 3A 10 6B 38 3D 10 3B 10 75 38 3D 10 3C 10 7E 38 3D 10 3D 10 58 38 3D 10 3E 10 14 38 3D 10 3F 10 42 38 3D 10 40 10 7B 38 3D 10 41 10 3A 38 3D 10 42 10 A2 38 3D 10 43 10 64 38 3D 10 44 10 07 38 3D 10 45 10 F1 38 3D 10 46 10 DE 38 3D 10 47 10 E5 38 3D 10 48 10 2B 38 3D 10 49 10 F9 38 3D 10 4A 10 11 38 3D 10 4B 10 BA 38 3D 10 4C 10 B9 38 3D 10 4D 10 41 38 3D 10 4E 10 88 38 3D 10 4F 10 EF 38 3D 10 50 10 C1 38 3D 10 51 10 1D 38 3D 10 52 10 E8 38 3D 10 53 10 A4 38 3D 10 54 10 9C 38 3D 10 55 10 66 38 3D 10 56 10 98 38 3D 10 57 10 1A 38 3D 10 58 10 AD 38 3D 10 59 10 0B 38 3D 10 5A 10 BD 38 3D 10 5B 10 12 38 3D 10 5C 10 2A 38 3D 10 5D 10 75 38 3D 10 5E 10 53 38 3D 10 5F 10 DC 38 3D 10 60 10 86 38 3D 10 61 10 36 38 3D 01', '90 00'])


C2C03CAP.append(['Uploadding CAP', '80 E8 00 19 FA 10 62 10 BE 38 3D 10 63 10 7D 38 3D 10 64 10 C6 38 3D 10 65 10 52 38 3D 10 66 10 63 38 3D 10 67 10 62 38 3D 10 68 10 C6 38 3D 10 69 10 48 38 3D 10 6A 10 55 38 3D 10 6B 10 18 38 3D 10 6C 10 9D 38 3D 10 6D 10 6F 38 3D 10 6E 10 76 38 3D 10 6F 10 B5 38 3D 10 70 10 89 38 3D 10 71 10 E8 38 3D 10 72 10 CF 38 3D 10 73 10 6F 38 3D 10 74 10 8C 38 3D 10 75 10 1A 38 3D 10 76 10 65 38 3D 10 77 10 5A 38 3D 10 78 10 D6 38 3D 10 79 10 C3 38 3D 10 7A 10 0E 38 3D 10 7B 10 CD 38 3D 10 7C 10 9A 38 3D 10 7D 10 FB 38 3D 10 7E 10 0A 38 3D 10 7F 10 9F 38 3D 11 00 80 10 10 38 3D 11 00 81 10 20 38 3D 11 00 82 10 0F 38 3D 11 00 83 10 A5 38 3D 11 00 84 10 08 38 3D 11 00 85 10 A8 38 3D 11 00 86 03 38 3D 11 00 87 10 F8 38 3D 11 00 88 05 38 3D 11 00 89 03 38 3D 11 00 8A 01', '90 00'])


C2C03CAP.append(['Uploadding CAP', '80 E8 00 1A FA 03 38 3D 11 00 8B 03 38 3D 11 00 8C 03 38 3D 11 00 8D 03 38 3D 11 00 8E 03 38 3D 11 00 8F 03 38 3D 11 00 90 03 38 3D 11 00 91 03 38 3D 11 00 92 10 0F 38 3D 11 00 93 10 0E 38 3D 11 00 94 03 38 3D 11 00 95 03 38 3D 11 00 96 03 38 3D 11 00 97 03 38 3D 11 00 98 03 38 3D 11 00 99 03 38 3D 11 00 9A 03 38 3D 11 00 9B 03 38 3D 11 00 9C 03 38 3D 11 00 9D 03 38 3D 11 00 9E 03 38 3D 11 00 9F 03 38 3D 11 00 A0 03 38 3D 11 00 A1 03 38 3D 11 00 A2 10 9F 38 3D 11 00 A3 10 26 38 3D 11 00 A4 10 08 38 3D 11 00 A5 04 38 3D 11 00 A6 05 38 3D 11 00 A7 05 38 3D 11 00 A8 07 38 3D 11 00 A9 08 38 3D 11 00 AA 10 06 38 3D 11 00 AB 10 07 38 3D 11 00 AC 10 08 38 87 0C 7A 05 30 8F 00 0E 3D 8C 00 0F 18 1D 04 41 18 1D 25 8B 00 10 7A 02 21 19 8B 00 11 2D 18 8B 00 12 60 08 01', '90 00'])


C2C03CAP.append(['Uploadding CAP', '80 E8 00 1B FA 18 19 8C 00 13 7A 1A 03 25 75 00 56 00 02 FF 80 00 2E 00 00 00 0D 1A 04 25 75 00 1E 00 02 FF A4 00 0D FF B2 00 14 18 19 8C 00 13 70 0C 19 8B 00 14 3B 18 19 8C 00 15 1A 04 25 75 00 23 00 02 FF A8 00 0D FF AE 00 19 19 8B 00 14 3B 18 19 8C 00 16 70 0C 19 8B 00 14 3B 18 19 8C 00 17 70 08 11 6D 00 8D 00 18 7A 05 21 19 8B 00 11 2D 1A 08 25 75 00 66 00 02 FF A0 00 23 00 32 00 0D AD 01 03 1A 03 AD 01 92 8D 00 19 3B 19 03 AD 01 92 8B 00 1A 70 45 1A 10 09 25 75 00 3F 00 02 FF 84 00 0D 00 03 00 27 18 04 88 00 AD 02 03 1A 03 AD 02 92 8D 00 19 3B 19 03 AD 02 92 8B 00 1A 70 1A 18 03 88 00 AD 03 03 1A 03 AD 03 92 8D 00 19 3B 19 03 AD 03 92 8B 00 1A 7A 05 21 19 8B 00 11 2D AE 00 04 6B 18 AD 04 03 1A 03 AD 04 92 8D 00 19 3B 19 03 AD 04 92 8B 00 1A 70 16 AD 01', '90 00'])


C2C03CAP.append(['Uploadding CAP', '80 E8 00 1C FA 05 03 1A 03 AD 05 92 8D 00 19 3B 19 03 AD 05 92 8B 00 1A 7A 05 21 19 8B 00 11 2D 1A 06 25 75 00 AF 00 02 00 0C 00 0D 00 14 00 8F 1A 05 25 73 00 7D 00 01 00 05 00 11 00 27 00 3D 00 53 00 69 AD 06 03 1A 03 AD 06 92 8D 00 19 3B 19 03 AD 06 92 8B 00 1A 70 58 AD 07 03 1A 03 AD 07 92 8D 00 19 3B 19 03 AD 07 92 8B 00 1A 70 42 AD 08 03 1A 03 AD 08 92 8D 00 19 3B 19 03 AD 08 92 8B 00 1A 70 2C AD 09 03 1A 03 AD 09 92 8D 00 19 3B 19 03 AD 09 92 8B 00 1A 70 16 AD 0A 03 1A 03 AD 0A 92 8D 00 19 3B 19 03 AD 0A 92 8B 00 1A 70 22 1A 05 25 75 00 1D 00 01 00 03 00 09 AD 0B 03 1A 03 AD 0B 92 8D 00 19 3B 19 03 AD 0B 92 8B 00 1A 7A 05 21 19 8B 00 11 2D AD 0C 03 1A 03 AD 0C 92 8D 00 19 3B 19 03 AD 0C 92 8B 00 1A 7A 08 00 0A 00 00 00 00 00 00 00 00 00 00 05 00 6E 01', '90 00'])


C2C03CAP.append(['Uploadding CAP', '80 E8 00 1D FA 00 1B 02 00 02 0C 02 00 02 00 02 00 02 01 02 00 02 02 02 00 02 03 02 00 02 04 02 00 02 05 02 00 02 06 02 00 02 07 02 00 02 08 02 00 02 09 02 00 02 0A 02 00 02 0B 06 80 03 00 01 00 02 00 06 00 00 01 03 80 03 02 03 80 0A 01 03 80 03 03 06 00 1A 39 03 80 0A 06 06 00 1A E1 06 00 1A AA 06 00 1B 9B 06 80 07 01 06 80 10 02 03 80 0A 08 09 00 8F 00 47 0A FF D0 FF 5D FF 89 59 FF AD EF FF 98 D1 FF FF FF FF FF FF 72 FF FF FF FF A7 6C FF FF FF FF 20 A1 05 09 1B 02 05 09 0A 02 05 09 0E 05 05 09 08 05 09 32 05 09 08 05 09 08 05 09 08 05 09 08 05 09 14 05 09 0E 05 09 00 44 05 FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF C9 04 0A 07 05 07 26 06 06 14 06 06 06 08 07 1C 09 22 09 11 09 07 11 09 0D 09 07 30 09 0D 09 0D 09 0D 09 0D 01', '90 00'])


C2C03CAP.append(['Uploadding CAP', '80 E8 80 1E 06 09 19 09 07 0C 09 01', '90 00'])


C2C03CAP.append(['Install CAP', '80 E6 0C 00 35 0E 32 50 41 59 2E 53 59 53 2E 44 44 46 30 31 0F 32 50 41 59 2E 53 59 53 2E 44 44 46 30 31 00 0F 32 50 41 59 2E 53 59 53 2E 44 44 46 30 31 00 01 00 02 C9 00 00 00', '90 00'])


Result = True
RetOfStep = True
bRet = DL.OpenDevice()
if(Result == True):
# Start pass through
	DL.SetWindowText("green",'Start pass through' )
	DL.SendIOCommand("IDG",'2C 01 01',10000) 
	Data = DL.Get_RXResponse(0)
	while(DL.bIsStopRun == False):
		Result = DL.Check_StringAB(Data, "2C 00")
		if(Result):
			DL.SetWindowText("green", Data)
			DL.SetWindowText("green", "Start Pass-through Pass")
			break
		else:
			DL.SetWindowText("red", Data)
			DL.SetWindowText("red", "Start Pass-through Fail")
			break
		time.sleep(0.02)

# Stop Antenna
if(Result == True):
	DL.SetWindowText("green",'Stop Antenna' )
	DL.SendIOCommand("IDG",'28 01 00',10000) 
	Data = DL.Get_RXResponse(0)
	while(DL.bIsStopRun == False):
		Result = DL.Check_StringAB(Data, "28 00")
		if(Result):
			DL.SetWindowText("green", Data)
			DL.SetWindowText("green", "Stop Antenna Pass")
			break
		else:
			DL.SetWindowText("red", Data)
			DL.SetWindowText("red","Stop Antenna Fail")
			break
		time.sleep(0.02)


# Poll 4 T
if(Result == True):
	DL.SetWindowText("green",'Poll 4 T' )
	DL.SendIOCommand("IDG",'2C 02 FF FF',10000) 
	Data = DL.Get_RXResponse(0)
	while(DL.bIsStopRun == False):
		Result = DL.Check_StringAB(Data, "2C 00")
		if(Result):
			DL.SetWindowText("green", Data)
			DL.SetWindowText("green", "Poll For Token Pass")
			break
		else:
			DL.SetWindowText("red", Data)
			DL.SetWindowText("red","Poll For Token Fail")
			break
		time.sleep(0.02)


#Select card
if(Result == True):
	DL.SetWindowText("green",'Select card' )
	DL.SendIOCommand("IDG",'2C 03 00 A4 04 00 08 A0 00 00 00 03 00 00 00 00',10000)
	Data = DL.Get_RXResponse(0)
	while(DL.bIsStopRun == False):
		Result = DL.Check_StringAB(Data, "90 00")
		if(Result):
			DL.SetWindowText("green", Data)
			DL.SetWindowText("green", "Select card Pass")
			break
		else:
			DL.SetWindowText("red", Data)
			DL.SetWindowText("red", "Select card Fail")
			break
		time.sleep(0.02)

#Init-Update 255
if(Result == True):
	DL.SetWindowText("green",'Init-Update 255' )
	DL.SendIOCommand("IDG",'2C 03 80 50 00 00 08 D0 3E 90 B6 23 AC 53 86 00',10000)
	Data = DL.Get_RXResponse(0)
	while(DL.bIsStopRun == False):
		Result = DL.Check_StringAB(Data, "90 00")
		if(Result):
			DL.SetWindowText("green", Data)
			DL.SetWindowText("green", "Init-Update Pass")
			break
		else:
			DL.SetWindowText("red", Data)
			DL.SetWindowText("red", "Init-Update Fail")
			break
		time.sleep(0.02)


#########################################CMAC#########################################
	Resp=Data.replace(" ","")
	DL.SetWindowText("green", 'Resp = ' +  Resp)
	auth_level = '00'
	DL.SetWindowText("green", 'auth_level = ' +  auth_level)
	static_key = '404142434445464748494A4B4C4D4E4F'
	DL.SetWindowText("green", 'static_key = ' +  static_key)
	host_random = 'D03E90B623AC5386'
	DL.SetWindowText("green", 'host_random  = ' +  host_random )
		
	key_diversification_data = Resp[28:48]
	DL.SetWindowText("green", 'key_diversification_data = ' +  key_diversification_data)
	Key_information = Resp[48:52]
	DL.SetWindowText("green", 'Key_information = ' +  Key_information)
	Sequence_counter = Resp[52:56]
	DL.SetWindowText("green", 'Sequence_counter = ' +  Sequence_counter)
	Card_challenge = Resp[56:68]
	DL.SetWindowText("green", 'Card_challenge = ' +  Card_challenge )
	Card_cryptogram = Resp[68:84]
	DL.SetWindowText("green", 'Card_cryptogram = ' + Card_cryptogram)
	
	SENC_P = '0182' + Sequence_counter + '000000000000000000000000'
	DL.SetWindowText("green", 'SENC_P = ' + SENC_P)
	CMAC_P = '0101' + Sequence_counter + '000000000000000000000000'
	DL.SetWindowText("green", 'CMAC_P  = ' + CMAC_P)
	CDEK_P = '0181' + Sequence_counter + '000000000000000000000000'
	DL.SetWindowText("green", 'CDEK_P  = ' + CDEK_P)

	SENC_SESSION = DL.EncryptionDecryption_TDESCBC(0,1,static_key,SENC_P,'0000000000000000')
	DL.SetWindowText("green", 'SENC_SESSION  = ' + SENC_SESSION)
	CMAC_SESSION = DL.EncryptionDecryption_TDESCBC(0,1,static_key,CMAC_P,'0000000000000000')
	DL.SetWindowText("green", 'CMAC_SESSION  = ' + CMAC_SESSION)
	SDEK_SESSION = DL.EncryptionDecryption_TDESCBC(0,1,static_key,CDEK_P,'0000000000000000')
	DL.SetWindowText("green", 'SDEK_SESSION  = ' + SDEK_SESSION)

	host_authenticate_cryptogram = Sequence_counter + Card_challenge +  host_random + '8000000000000000'
	DL.SetWindowText("green", 'host_authenticate_cryptogram  = ' + host_authenticate_cryptogram)
	host_authenticate_cryptogram_c = DL.EncryptionDecryption_TDESCBC(0,1,SENC_SESSION,host_authenticate_cryptogram,'0000000000000000')
	DL.SetWindowText("green", 'host_authenticate_cryptogram_c  = ' + host_authenticate_cryptogram_c)
	host_authenticate_cryptogram_MAC = host_authenticate_cryptogram_c[32:48]
	DL.SetWindowText("green", 'host_authenticate_cryptogram_MAC   = ' + host_authenticate_cryptogram_MAC )
	external_auth = '848200' + auth_level + '10' + host_authenticate_cryptogram_MAC
	DL.SetWindowText("green", 'external_auth   = ' + external_auth)
	pack_external_auth = external_auth + '800000'
	DL.SetWindowText("green", 'pack_external_auth   = ' + pack_external_auth)
	external_auth_mac = DL.ComputeCMacTDESValue(CMAC_SESSION, pack_external_auth)
	DL.SetWindowText("green", 'external_auth_mac   = ' + external_auth_mac)

#########################################CMACEnd#########################################

#ext-auth plain
if(Result == True):
	DL.SetWindowText("green",'ext-auth plain' )
	DL.SendIOCommand("IDG",'2C 03' + external_auth +external_auth_mac,10000)
	Data = DL.Get_RXResponse(0)
	while(DL.bIsStopRun == False):
		Result = DL.Check_StringAB(Data, "90 00")
		if(Result):
			DL.SetWindowText("green", Data)
			DL.SetWindowText("green", "Ext-auth plain Pass")
			break
		else:
			DL.SetWindowText("red", Data)
			DL.SetWindowText("red", "Ext-auth plain Fail")
			break
		time.sleep(0.02)


#######################################DeleteAID###########################################
#Get all AID
	DL.SetWindowText("green",'Get App' )
	DL.SendIOCommand("IDG",'2C 03 80 F2 20 00 02 4F 00 00',10000)
	Data = DL.Get_RXResponse(0)
	Data= Data.replace(" ","")
	while(DL.bIsStopRun == False):
		if(Data != ""):
			DL.SetWindowText("green",Data)
			break
		else:time.sleep(0.1)

	strResponse = Data[24:len(Data)]
	DL.setText("green",strResponse)
	LAID = strResponse[4:6]
	i=0
	AIDpara=[]
	DeleteAID=[]
	while (LAID!="90"):
		strResponse = strResponse[4:len(strResponse)]
		if(strResponse==""):break
		LAID = strResponse[0:2] # AID length Hex str
		LAID = int(str(LAID),16) # AID length int
		Lend = LAID*2+2  # AID length int + 
		AID = strResponse[0:Lend]
		para = hex(LAID+2)
		para = para[2:len(para)]
		if(LAID+2 < 16):AIDpara.append("0"+para)
		else: AIDpara.append(para)
		DeleteAID.append(str(AID))
		strResponse = strResponse[Lend:len(strResponse)]
		i=i+1
		LAID = strResponse[4:6]
	i=i-1

#Delete all AID
	while(i>=0):
		DL.setText("Black","Delete AID:"+ str(DeleteAID[i]))
		DL.SendIOCommand("IDG",'2C 03 80 E4 00 80'+AIDpara[i]+'4F'+DeleteAID[i]+'00',10000)
		Data = DL.Get_RXResponse(0)
		DL.SetWindowText("green",Data)
		i=i-1
#######################################WriteData###########################################
	i=0
	while (i< 33):
		DL.setText("BLACK",C2C03CAP[i][0])
		DL.SendIOCommand("IDG",'2C 03' + C2C03CAP[i][1],10000)
		Data = DL.Get_RXResponse(0)
		Result = DL.Check_StringAB(Data, "90 00")
		if(Result):
			DL.SetWindowText("green", Data)
			DL.SetWindowText("green", "Load card data Pass")
		else:
			DL.SetWindowText("red", Data)
			DL.SetWindowText("red", "Load card data Fail")
			break
		i=i+1
	time.sleep(1)


#Stop Pass Through
DL.SetWindowText("green",'Stop Pass Through' )
DL.SendIOCommand("IDG",'2C 01 00',10000)
Data = DL.Get_RXResponse(0)
while(DL.bIsStopRun == False):
	Result = DL.Check_StringAB(Data, "2C 00")
	if(Result):
		DL.SetWindowText("green", Data)
		DL.SetWindowText("green", "Stop Pass-Through Pass")
		break
	else:
		DL.SetWindowText("red", Data)
		DL.SetWindowText("red", "Stop Pass-Through Fail")
		break
time.sleep(0.01)

if(Result):
	DL.pyresult = True
else:
	DL.pyresult = False

